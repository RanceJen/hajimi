<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script type="module" crossorigin>const vg=(function(){const n=typeof document<"u"&&document.createElement("link").relList;return n&&n.supports&&n.supports("modulepreload")?"modulepreload":"preload"})(),xg=function(r,n){return new URL(r,n).href},lf={},wg=function(n,s,o){let a=Promise.resolve();if(s&&s.length>0){let g=function(y){return Promise.all(y.map(v=>Promise.resolve(v).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};const f=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),p=c?.nonce||c?.getAttribute("nonce");a=g(s.map(y=>{if(y=xg(y,o),y in lf)return;lf[y]=!0;const v=y.endsWith(".css"),w=v?'[rel="stylesheet"]':"";if(o)for(let k=f.length-1;k>=0;k--){const E=f[k];if(E.href===y&&(!v||E.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${y}"]${w}`))return;const S=document.createElement("link");if(S.rel=v?"stylesheet":vg,v||(S.as="script"),S.crossOrigin="",S.href=y,p&&S.setAttribute("nonce",p),document.head.appendChild(S),v)return new Promise((k,E)=>{S.addEventListener("load",k),S.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(f){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=f,window.dispatchEvent(c),!c.defaultPrevented)throw f}return a.then(f=>{for(const c of f||[])c.status==="rejected"&&u(c.reason);return n().catch(u)})},bg=globalThis.__reactReady??Promise.resolve(),kg=globalThis.__hostReady??Promise.resolve(),gp=Promise.all([bg,kg]).then(()=>{});function yp(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Ml={exports:{}},Ys={},Pl={exports:{}},Oe={};var cf;function Sg(){if(cf)return Oe;cf=1;var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),f=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),v=Symbol.iterator;function w(P){return P===null||typeof P!="object"?null:(P=v&&P[v]||P["@@iterator"],typeof P=="function"?P:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,E={};function C(P,_,B){this.props=P,this.context=_,this.refs=E,this.updater=B||S}C.prototype.isReactComponent={},C.prototype.setState=function(P,_){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,_,"setState")},C.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function I(){}I.prototype=C.prototype;function b(P,_,B){this.props=P,this.context=_,this.refs=E,this.updater=B||S}var M=b.prototype=new I;M.constructor=b,k(M,C.prototype),M.isPureReactComponent=!0;var D=Array.isArray,L=Object.prototype.hasOwnProperty,F={current:null},H={key:!0,ref:!0,__self:!0,__source:!0};function q(P,_,B){var X,J={},ne=null,se=null;if(_!=null)for(X in _.ref!==void 0&&(se=_.ref),_.key!==void 0&&(ne=""+_.key),_)L.call(_,X)&&!H.hasOwnProperty(X)&&(J[X]=_[X]);var pe=arguments.length-2;if(pe===1)J.children=B;else if(1<pe){for(var ge=Array(pe),_e=0;_e<pe;_e++)ge[_e]=arguments[_e+2];J.children=ge}if(P&&P.defaultProps)for(X in pe=P.defaultProps,pe)J[X]===void 0&&(J[X]=pe[X]);return{$$typeof:r,type:P,key:ne,ref:se,props:J,_owner:F.current}}function te(P,_){return{$$typeof:r,type:P.type,key:_,ref:P.ref,props:P.props,_owner:P._owner}}function K(P){return typeof P=="object"&&P!==null&&P.$$typeof===r}function z(P){var _={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(B){return _[B]})}var W=/\/+/g;function ae(P,_){return typeof P=="object"&&P!==null&&P.key!=null?z(""+P.key):_.toString(36)}function ee(P,_,B,X,J){var ne=typeof P;(ne==="undefined"||ne==="boolean")&&(P=null);var se=!1;if(P===null)se=!0;else switch(ne){case"string":case"number":se=!0;break;case"object":switch(P.$$typeof){case r:case n:se=!0}}if(se)return se=P,J=J(se),P=X===""?"."+ae(se,0):X,D(J)?(B="",P!=null&&(B=P.replace(W,"$&/")+"/"),ee(J,_,B,"",function(_e){return _e})):J!=null&&(K(J)&&(J=te(J,B+(!J.key||se&&se.key===J.key?"":(""+J.key).replace(W,"$&/")+"/")+P)),_.push(J)),1;if(se=0,X=X===""?".":X+":",D(P))for(var pe=0;pe<P.length;pe++){ne=P[pe];var ge=X+ae(ne,pe);se+=ee(ne,_,B,ge,J)}else if(ge=w(P),typeof ge=="function")for(P=ge.call(P),pe=0;!(ne=P.next()).done;)ne=ne.value,ge=X+ae(ne,pe++),se+=ee(ne,_,B,ge,J);else if(ne==="object")throw _=String(P),Error("Objects are not valid as a React child (found: "+(_==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":_)+"). If you meant to render a collection of children, use an array instead.");return se}function he(P,_,B){if(P==null)return P;var X=[],J=0;return ee(P,X,"","",function(ne){return _.call(B,ne,J++)}),X}function Z(P){if(P._status===-1){var _=P._result;_=_(),_.then(function(B){(P._status===0||P._status===-1)&&(P._status=1,P._result=B)},function(B){(P._status===0||P._status===-1)&&(P._status=2,P._result=B)}),P._status===-1&&(P._status=0,P._result=_)}if(P._status===1)return P._result.default;throw P._result}var ce={current:null},O={transition:null},V={ReactCurrentDispatcher:ce,ReactCurrentBatchConfig:O,ReactCurrentOwner:F};function Y(){throw Error("act(...) is not supported in production builds of React.")}return Oe.Children={map:he,forEach:function(P,_,B){he(P,function(){_.apply(this,arguments)},B)},count:function(P){var _=0;return he(P,function(){_++}),_},toArray:function(P){return he(P,function(_){return _})||[]},only:function(P){if(!K(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},Oe.Component=C,Oe.Fragment=s,Oe.Profiler=a,Oe.PureComponent=b,Oe.StrictMode=o,Oe.Suspense=p,Oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=V,Oe.act=Y,Oe.cloneElement=function(P,_,B){if(P==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+P+".");var X=k({},P.props),J=P.key,ne=P.ref,se=P._owner;if(_!=null){if(_.ref!==void 0&&(ne=_.ref,se=F.current),_.key!==void 0&&(J=""+_.key),P.type&&P.type.defaultProps)var pe=P.type.defaultProps;for(ge in _)L.call(_,ge)&&!H.hasOwnProperty(ge)&&(X[ge]=_[ge]===void 0&&pe!==void 0?pe[ge]:_[ge])}var ge=arguments.length-2;if(ge===1)X.children=B;else if(1<ge){pe=Array(ge);for(var _e=0;_e<ge;_e++)pe[_e]=arguments[_e+2];X.children=pe}return{$$typeof:r,type:P.type,key:J,ref:ne,props:X,_owner:se}},Oe.createContext=function(P){return P={$$typeof:f,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},P.Provider={$$typeof:u,_context:P},P.Consumer=P},Oe.createElement=q,Oe.createFactory=function(P){var _=q.bind(null,P);return _.type=P,_},Oe.createRef=function(){return{current:null}},Oe.forwardRef=function(P){return{$$typeof:c,render:P}},Oe.isValidElement=K,Oe.lazy=function(P){return{$$typeof:y,_payload:{_status:-1,_result:P},_init:Z}},Oe.memo=function(P,_){return{$$typeof:g,type:P,compare:_===void 0?null:_}},Oe.startTransition=function(P){var _=O.transition;O.transition={};try{P()}finally{O.transition=_}},Oe.unstable_act=Y,Oe.useCallback=function(P,_){return ce.current.useCallback(P,_)},Oe.useContext=function(P){return ce.current.useContext(P)},Oe.useDebugValue=function(){},Oe.useDeferredValue=function(P){return ce.current.useDeferredValue(P)},Oe.useEffect=function(P,_){return ce.current.useEffect(P,_)},Oe.useId=function(){return ce.current.useId()},Oe.useImperativeHandle=function(P,_,B){return ce.current.useImperativeHandle(P,_,B)},Oe.useInsertionEffect=function(P,_){return ce.current.useInsertionEffect(P,_)},Oe.useLayoutEffect=function(P,_){return ce.current.useLayoutEffect(P,_)},Oe.useMemo=function(P,_){return ce.current.useMemo(P,_)},Oe.useReducer=function(P,_,B){return ce.current.useReducer(P,_,B)},Oe.useRef=function(P){return ce.current.useRef(P)},Oe.useState=function(P){return ce.current.useState(P)},Oe.useSyncExternalStore=function(P,_,B){return ce.current.useSyncExternalStore(P,_,B)},Oe.useTransition=function(){return ce.current.useTransition()},Oe.version="18.3.1",Oe}var uf;function ac(){return uf||(uf=1,Pl.exports=Sg()),Pl.exports}var df;function Ng(){if(df)return Ys;df=1;var r=ac(),n=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function f(c,p,g){var y,v={},w=null,S=null;g!==void 0&&(w=""+g),p.key!==void 0&&(w=""+p.key),p.ref!==void 0&&(S=p.ref);for(y in p)o.call(p,y)&&!u.hasOwnProperty(y)&&(v[y]=p[y]);if(c&&c.defaultProps)for(y in p=c.defaultProps,p)v[y]===void 0&&(v[y]=p[y]);return{$$typeof:n,type:c,key:w,ref:S,props:v,_owner:a.current}}return Ys.Fragment=s,Ys.jsx=f,Ys.jsxs=f,Ys}var ff;function _g(){return ff||(ff=1,Ml.exports=Ng()),Ml.exports}var h=_g(),go={},Tl={exports:{}},Dt={},Al={exports:{}},Ll={};var pf;function Eg(){return pf||(pf=1,(function(r){function n(O,V){var Y=O.length;O.push(V);e:for(;0<Y;){var P=Y-1>>>1,_=O[P];if(0<a(_,V))O[P]=V,O[Y]=_,Y=P;else break e}}function s(O){return O.length===0?null:O[0]}function o(O){if(O.length===0)return null;var V=O[0],Y=O.pop();if(Y!==V){O[0]=Y;e:for(var P=0,_=O.length,B=_>>>1;P<B;){var X=2*(P+1)-1,J=O[X],ne=X+1,se=O[ne];if(0>a(J,Y))ne<_&&0>a(se,J)?(O[P]=se,O[ne]=Y,P=ne):(O[P]=J,O[X]=Y,P=X);else if(ne<_&&0>a(se,Y))O[P]=se,O[ne]=Y,P=ne;else break e}}return V}function a(O,V){var Y=O.sortIndex-V.sortIndex;return Y!==0?Y:O.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var u=performance;r.unstable_now=function(){return u.now()}}else{var f=Date,c=f.now();r.unstable_now=function(){return f.now()-c}}var p=[],g=[],y=1,v=null,w=3,S=!1,k=!1,E=!1,C=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(O){for(var V=s(g);V!==null;){if(V.callback===null)o(g);else if(V.startTime<=O)o(g),V.sortIndex=V.expirationTime,n(p,V);else break;V=s(g)}}function D(O){if(E=!1,M(O),!k)if(s(p)!==null)k=!0,Z(L);else{var V=s(g);V!==null&&ce(D,V.startTime-O)}}function L(O,V){k=!1,E&&(E=!1,I(q),q=-1),S=!0;var Y=w;try{for(M(V),v=s(p);v!==null&&(!(v.expirationTime>V)||O&&!z());){var P=v.callback;if(typeof P=="function"){v.callback=null,w=v.priorityLevel;var _=P(v.expirationTime<=V);V=r.unstable_now(),typeof _=="function"?v.callback=_:v===s(p)&&o(p),M(V)}else o(p);v=s(p)}if(v!==null)var B=!0;else{var X=s(g);X!==null&&ce(D,X.startTime-V),B=!1}return B}finally{v=null,w=Y,S=!1}}var F=!1,H=null,q=-1,te=5,K=-1;function z(){return!(r.unstable_now()-K<te)}function W(){if(H!==null){var O=r.unstable_now();K=O;var V=!0;try{V=H(!0,O)}finally{V?ae():(F=!1,H=null)}}else F=!1}var ae;if(typeof b=="function")ae=function(){b(W)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,he=ee.port2;ee.port1.onmessage=W,ae=function(){he.postMessage(null)}}else ae=function(){C(W,0)};function Z(O){H=O,F||(F=!0,ae())}function ce(O,V){q=C(function(){O(r.unstable_now())},V)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(O){O.callback=null},r.unstable_continueExecution=function(){k||S||(k=!0,Z(L))},r.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):te=0<O?Math.floor(1e3/O):5},r.unstable_getCurrentPriorityLevel=function(){return w},r.unstable_getFirstCallbackNode=function(){return s(p)},r.unstable_next=function(O){switch(w){case 1:case 2:case 3:var V=3;break;default:V=w}var Y=w;w=V;try{return O()}finally{w=Y}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(O,V){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var Y=w;w=O;try{return V()}finally{w=Y}},r.unstable_scheduleCallback=function(O,V,Y){var P=r.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?P+Y:P):Y=P,O){case 1:var _=-1;break;case 2:_=250;break;case 5:_=1073741823;break;case 4:_=1e4;break;default:_=5e3}return _=Y+_,O={id:y++,callback:V,priorityLevel:O,startTime:Y,expirationTime:_,sortIndex:-1},Y>P?(O.sortIndex=Y,n(g,O),s(p)===null&&O===s(g)&&(E?(I(q),q=-1):E=!0,ce(D,Y-P))):(O.sortIndex=_,n(p,O),k||S||(k=!0,Z(L))),O},r.unstable_shouldYield=z,r.unstable_wrapCallback=function(O){var V=w;return function(){var Y=w;w=V;try{return O.apply(this,arguments)}finally{w=Y}}}})(Ll)),Ll}var hf;function Cg(){return hf||(hf=1,Al.exports=Eg()),Al.exports}var mf;function Ig(){if(mf)return Dt;mf=1;var r=ac(),n=Cg();function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function u(e,t){f(e,t),f(e+"Capture",t)}function f(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y={},v={};function w(e){return p.call(v,e)?!0:p.call(y,e)?!1:g.test(e)?v[e]=!0:(y[e]=!0,!1)}function S(e,t,i,l){if(i!==null&&i.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return l?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function k(e,t,i,l){if(t===null||typeof t>"u"||S(e,t,i,l))return!0;if(l)return!1;if(i!==null)switch(i.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function E(e,t,i,l,d,m,x){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=l,this.attributeNamespace=d,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=m,this.removeEmptyString=x}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){C[e]=new E(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];C[t]=new E(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){C[e]=new E(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){C[e]=new E(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){C[e]=new E(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){C[e]=new E(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){C[e]=new E(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){C[e]=new E(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){C[e]=new E(e,5,!1,e.toLowerCase(),null,!1,!1)});var I=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(I,b);C[t]=new E(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(I,b);C[t]=new E(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(I,b);C[t]=new E(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){C[e]=new E(e,1,!1,e.toLowerCase(),null,!1,!1)}),C.xlinkHref=new E("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){C[e]=new E(e,1,!1,e.toLowerCase(),null,!0,!0)});function M(e,t,i,l){var d=C.hasOwnProperty(t)?C[t]:null;(d!==null?d.type!==0:l||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(k(t,i,d,l)&&(i=null),l||d===null?w(t)&&(i===null?e.removeAttribute(t):e.setAttribute(t,""+i)):d.mustUseProperty?e[d.propertyName]=i===null?d.type===3?!1:"":i:(t=d.attributeName,l=d.attributeNamespace,i===null?e.removeAttribute(t):(d=d.type,i=d===3||d===4&&i===!0?"":""+i,l?e.setAttributeNS(l,t,i):e.setAttribute(t,i))))}var D=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,L=Symbol.for("react.element"),F=Symbol.for("react.portal"),H=Symbol.for("react.fragment"),q=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),K=Symbol.for("react.provider"),z=Symbol.for("react.context"),W=Symbol.for("react.forward_ref"),ae=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),he=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),ce=Symbol.for("react.offscreen"),O=Symbol.iterator;function V(e){return e===null||typeof e!="object"?null:(e=O&&e[O]||e["@@iterator"],typeof e=="function"?e:null)}var Y=Object.assign,P;function _(e){if(P===void 0)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);P=t&&t[1]||""}return`
`+P+e}var B=!1;function X(e,t){if(!e||B)return"";B=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(G){var l=G}Reflect.construct(e,[],t)}else{try{t.call()}catch(G){l=G}e.call(t.prototype)}else{try{throw Error()}catch(G){l=G}e()}}catch(G){if(G&&l&&typeof G.stack=="string"){for(var d=G.stack.split(`
`),m=l.stack.split(`
`),x=d.length-1,j=m.length-1;1<=x&&0<=j&&d[x]!==m[j];)j--;for(;1<=x&&0<=j;x--,j--)if(d[x]!==m[j]){if(x!==1||j!==1)do if(x--,j--,0>j||d[x]!==m[j]){var T=`
`+d[x].replace(" at new "," at ");return e.displayName&&T.includes("<anonymous>")&&(T=T.replace("<anonymous>",e.displayName)),T}while(1<=x&&0<=j);break}}}finally{B=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?_(e):""}function J(e){switch(e.tag){case 5:return _(e.type);case 16:return _("Lazy");case 13:return _("Suspense");case 19:return _("SuspenseList");case 0:case 2:case 15:return e=X(e.type,!1),e;case 11:return e=X(e.type.render,!1),e;case 1:return e=X(e.type,!0),e;default:return""}}function ne(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case H:return"Fragment";case F:return"Portal";case te:return"Profiler";case q:return"StrictMode";case ae:return"Suspense";case ee:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case z:return(e.displayName||"Context")+".Consumer";case K:return(e._context.displayName||"Context")+".Provider";case W:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case he:return t=e.displayName||null,t!==null?t:ne(e.type)||"Memo";case Z:t=e._payload,e=e._init;try{return ne(e(t))}catch{}}return null}function se(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ne(t);case 8:return t===q?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function pe(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ge(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function _e(e){var t=ge(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),l=""+e[t];if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var d=i.get,m=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return d.call(this)},set:function(x){l=""+x,m.call(this,x)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return l},setValue:function(x){l=""+x},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function A(e){e._valueTracker||(e._valueTracker=_e(e))}function ue(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),l="";return e&&(l=ge(e)?e.checked?"true":"false":e.value),e=l,e!==i?(t.setValue(e),!0):!1}function oe(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function me(e,t){var i=t.checked;return Y({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function Q(e,t){var i=t.defaultValue==null?"":t.defaultValue,l=t.checked!=null?t.checked:t.defaultChecked;i=pe(t.value!=null?t.value:i),e._wrapperState={initialChecked:l,initialValue:i,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function fe(e,t){t=t.checked,t!=null&&M(e,"checked",t,!1)}function we(e,t){fe(e,t);var i=pe(t.value),l=t.type;if(i!=null)l==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(l==="submit"||l==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Re(e,t.type,i):t.hasOwnProperty("defaultValue")&&Re(e,t.type,pe(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ce(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var l=t.type;if(!(l!=="submit"&&l!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function Re(e,t,i){(t!=="number"||oe(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var Fe=Array.isArray;function it(e,t,i,l){if(e=e.options,t){t={};for(var d=0;d<i.length;d++)t["$"+i[d]]=!0;for(i=0;i<e.length;i++)d=t.hasOwnProperty("$"+e[i].value),e[i].selected!==d&&(e[i].selected=d),d&&l&&(e[i].defaultSelected=!0)}else{for(i=""+pe(i),t=null,d=0;d<e.length;d++){if(e[d].value===i){e[d].selected=!0,l&&(e[d].defaultSelected=!0);return}t!==null||e[d].disabled||(t=e[d])}t!==null&&(t.selected=!0)}}function Ze(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(s(91));return Y({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ze(e,t){var i=t.value;if(i==null){if(i=t.children,t=t.defaultValue,i!=null){if(t!=null)throw Error(s(92));if(Fe(i)){if(1<i.length)throw Error(s(93));i=i[0]}t=i}t==null&&(t=""),i=t}e._wrapperState={initialValue:pe(i)}}function Je(e,t){var i=pe(t.value),l=pe(t.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),t.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),l!=null&&(e.defaultValue=""+l)}function Ye(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Mt(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gt(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Mt(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ut,nt=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,i,l,d){MSApp.execUnsafeLocalFunction(function(){return e(t,i,l,d)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ut=ut||document.createElement("div"),ut.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ut.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ke(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=t;return}}e.textContent=t}var et={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sn=["Webkit","ms","Moz","O"];Object.keys(et).forEach(function(e){Sn.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),et[t]=et[e]})});function yt(e,t,i){return t==null||typeof t=="boolean"||t===""?"":i||typeof t!="number"||t===0||et.hasOwnProperty(e)&&et[e]?(""+t).trim():t+"px"}function pr(e,t){e=e.style;for(var i in t)if(t.hasOwnProperty(i)){var l=i.indexOf("--")===0,d=yt(i,t[i],l);i==="float"&&(i="cssFloat"),l?e.setProperty(i,d):e[i]=d}}var pn=Y({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ht(e,t){if(t){if(pn[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(s(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(s(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(t.style!=null&&typeof t.style!="object")throw Error(s(62))}}function Ee(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Te=null;function Me(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var We=null,Be=null,ot=null;function bt(e){if(e=Ts(e)){if(typeof We!="function")throw Error(s(280));var t=e.stateNode;t&&(t=Mi(t),We(e.stateNode,e.type,t))}}function hn(e){Be?ot?ot.push(e):ot=[e]:Be=e}function At(){if(Be){var e=Be,t=ot;if(ot=Be=null,bt(e),t)for(e=0;e<t.length;e++)bt(t[e])}}function _t(e,t){return e(t)}function ai(){}var Lr=!1;function Dn(e,t,i){if(Lr)return e(t,i);Lr=!0;try{return _t(e,t,i)}finally{Lr=!1,(Be!==null||ot!==null)&&(ai(),At())}}function $n(e,t){var i=e.stateNode;if(i===null)return null;var l=Mi(i);if(l===null)return null;i=l[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(s(231,t,typeof i));return i}var Rr=!1;if(c)try{var hr={};Object.defineProperty(hr,"passive",{get:function(){Rr=!0}}),window.addEventListener("test",hr,hr),window.removeEventListener("test",hr,hr)}catch{Rr=!1}function Ko(e,t,i,l,d,m,x,j,T){var G=Array.prototype.slice.call(arguments,3);try{t.apply(i,G)}catch(ie){this.onError(ie)}}var mr=!1,li=null,ci=!1,Xo=null,_h={onError:function(e){mr=!0,li=e}};function Eh(e,t,i,l,d,m,x,j,T){mr=!1,li=null,Ko.apply(_h,arguments)}function Ch(e,t,i,l,d,m,x,j,T){if(Eh.apply(this,arguments),mr){if(mr){var G=li;mr=!1,li=null}else throw Error(s(198));ci||(ci=!0,Xo=G)}}function gr(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(i=t.return),e=t.return;while(e)}return t.tag===3?i:null}function Mc(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Pc(e){if(gr(e)!==e)throw Error(s(188))}function Ih(e){var t=e.alternate;if(!t){if(t=gr(e),t===null)throw Error(s(188));return t!==e?null:e}for(var i=e,l=t;;){var d=i.return;if(d===null)break;var m=d.alternate;if(m===null){if(l=d.return,l!==null){i=l;continue}break}if(d.child===m.child){for(m=d.child;m;){if(m===i)return Pc(d),e;if(m===l)return Pc(d),t;m=m.sibling}throw Error(s(188))}if(i.return!==l.return)i=d,l=m;else{for(var x=!1,j=d.child;j;){if(j===i){x=!0,i=d,l=m;break}if(j===l){x=!0,l=d,i=m;break}j=j.sibling}if(!x){for(j=m.child;j;){if(j===i){x=!0,i=m,l=d;break}if(j===l){x=!0,l=m,i=d;break}j=j.sibling}if(!x)throw Error(s(189))}}if(i.alternate!==l)throw Error(s(190))}if(i.tag!==3)throw Error(s(188));return i.stateNode.current===i?e:t}function Tc(e){return e=Ih(e),e!==null?Ac(e):null}function Ac(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Ac(e);if(t!==null)return t;e=e.sibling}return null}var Lc=n.unstable_scheduleCallback,Rc=n.unstable_cancelCallback,jh=n.unstable_shouldYield,Mh=n.unstable_requestPaint,lt=n.unstable_now,Ph=n.unstable_getCurrentPriorityLevel,Qo=n.unstable_ImmediatePriority,zc=n.unstable_UserBlockingPriority,ui=n.unstable_NormalPriority,Th=n.unstable_LowPriority,Oc=n.unstable_IdlePriority,di=null,mn=null;function Ah(e){if(mn&&typeof mn.onCommitFiberRoot=="function")try{mn.onCommitFiberRoot(di,e,void 0,(e.current.flags&128)===128)}catch{}}var rn=Math.clz32?Math.clz32:zh,Lh=Math.log,Rh=Math.LN2;function zh(e){return e>>>=0,e===0?32:31-(Lh(e)/Rh|0)|0}var fi=64,pi=4194304;function hs(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function hi(e,t){var i=e.pendingLanes;if(i===0)return 0;var l=0,d=e.suspendedLanes,m=e.pingedLanes,x=i&268435455;if(x!==0){var j=x&~d;j!==0?l=hs(j):(m&=x,m!==0&&(l=hs(m)))}else x=i&~d,x!==0?l=hs(x):m!==0&&(l=hs(m));if(l===0)return 0;if(t!==0&&t!==l&&(t&d)===0&&(d=l&-l,m=t&-t,d>=m||d===16&&(m&4194240)!==0))return t;if((l&4)!==0&&(l|=i&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=l;0<t;)i=31-rn(t),d=1<<i,l|=e[i],t&=~d;return l}function Oh(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fh(e,t){for(var i=e.suspendedLanes,l=e.pingedLanes,d=e.expirationTimes,m=e.pendingLanes;0<m;){var x=31-rn(m),j=1<<x,T=d[x];T===-1?((j&i)===0||(j&l)!==0)&&(d[x]=Oh(j,t)):T<=t&&(e.expiredLanes|=j),m&=~j}}function qo(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Fc(){var e=fi;return fi<<=1,(fi&4194240)===0&&(fi=64),e}function Zo(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function ms(e,t,i){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-rn(t),e[t]=i}function Dh(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var l=e.eventTimes;for(e=e.expirationTimes;0<i;){var d=31-rn(i),m=1<<d;t[d]=0,l[d]=-1,e[d]=-1,i&=~m}}function Jo(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var l=31-rn(i),d=1<<l;d&t|e[l]&t&&(e[l]|=t),i&=~d}}var Ue=0;function Dc(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var $c,ea,Bc,Uc,Hc,ta=!1,mi=[],Bn=null,Un=null,Hn=null,gs=new Map,ys=new Map,Wn=[],$h="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Wc(e,t){switch(e){case"focusin":case"focusout":Bn=null;break;case"dragenter":case"dragleave":Un=null;break;case"mouseover":case"mouseout":Hn=null;break;case"pointerover":case"pointerout":gs.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ys.delete(t.pointerId)}}function vs(e,t,i,l,d,m){return e===null||e.nativeEvent!==m?(e={blockedOn:t,domEventName:i,eventSystemFlags:l,nativeEvent:m,targetContainers:[d]},t!==null&&(t=Ts(t),t!==null&&ea(t)),e):(e.eventSystemFlags|=l,t=e.targetContainers,d!==null&&t.indexOf(d)===-1&&t.push(d),e)}function Bh(e,t,i,l,d){switch(t){case"focusin":return Bn=vs(Bn,e,t,i,l,d),!0;case"dragenter":return Un=vs(Un,e,t,i,l,d),!0;case"mouseover":return Hn=vs(Hn,e,t,i,l,d),!0;case"pointerover":var m=d.pointerId;return gs.set(m,vs(gs.get(m)||null,e,t,i,l,d)),!0;case"gotpointercapture":return m=d.pointerId,ys.set(m,vs(ys.get(m)||null,e,t,i,l,d)),!0}return!1}function Vc(e){var t=yr(e.target);if(t!==null){var i=gr(t);if(i!==null){if(t=i.tag,t===13){if(t=Mc(i),t!==null){e.blockedOn=t,Hc(e.priority,function(){Bc(i)});return}}else if(t===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function gi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var i=ra(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var l=new i.constructor(i.type,i);Te=l,i.target.dispatchEvent(l),Te=null}else return t=Ts(i),t!==null&&ea(t),e.blockedOn=i,!1;t.shift()}return!0}function Gc(e,t,i){gi(e)&&i.delete(t)}function Uh(){ta=!1,Bn!==null&&gi(Bn)&&(Bn=null),Un!==null&&gi(Un)&&(Un=null),Hn!==null&&gi(Hn)&&(Hn=null),gs.forEach(Gc),ys.forEach(Gc)}function xs(e,t){e.blockedOn===t&&(e.blockedOn=null,ta||(ta=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Uh)))}function ws(e){function t(d){return xs(d,e)}if(0<mi.length){xs(mi[0],e);for(var i=1;i<mi.length;i++){var l=mi[i];l.blockedOn===e&&(l.blockedOn=null)}}for(Bn!==null&&xs(Bn,e),Un!==null&&xs(Un,e),Hn!==null&&xs(Hn,e),gs.forEach(t),ys.forEach(t),i=0;i<Wn.length;i++)l=Wn[i],l.blockedOn===e&&(l.blockedOn=null);for(;0<Wn.length&&(i=Wn[0],i.blockedOn===null);)Vc(i),i.blockedOn===null&&Wn.shift()}var zr=D.ReactCurrentBatchConfig,yi=!0;function Hh(e,t,i,l){var d=Ue,m=zr.transition;zr.transition=null;try{Ue=1,na(e,t,i,l)}finally{Ue=d,zr.transition=m}}function Wh(e,t,i,l){var d=Ue,m=zr.transition;zr.transition=null;try{Ue=4,na(e,t,i,l)}finally{Ue=d,zr.transition=m}}function na(e,t,i,l){if(yi){var d=ra(e,t,i,l);if(d===null)wa(e,t,l,vi,i),Wc(e,l);else if(Bh(d,e,t,i,l))l.stopPropagation();else if(Wc(e,l),t&4&&-1<$h.indexOf(e)){for(;d!==null;){var m=Ts(d);if(m!==null&&$c(m),m=ra(e,t,i,l),m===null&&wa(e,t,l,vi,i),m===d)break;d=m}d!==null&&l.stopPropagation()}else wa(e,t,l,null,i)}}var vi=null;function ra(e,t,i,l){if(vi=null,e=Me(l),e=yr(e),e!==null)if(t=gr(e),t===null)e=null;else if(i=t.tag,i===13){if(e=Mc(t),e!==null)return e;e=null}else if(i===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return vi=e,null}function Yc(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ph()){case Qo:return 1;case zc:return 4;case ui:case Th:return 16;case Oc:return 536870912;default:return 16}default:return 16}}var Vn=null,sa=null,xi=null;function Kc(){if(xi)return xi;var e,t=sa,i=t.length,l,d="value"in Vn?Vn.value:Vn.textContent,m=d.length;for(e=0;e<i&&t[e]===d[e];e++);var x=i-e;for(l=1;l<=x&&t[i-l]===d[m-l];l++);return xi=d.slice(e,1<l?1-l:void 0)}function wi(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function bi(){return!0}function Xc(){return!1}function Wt(e){function t(i,l,d,m,x){this._reactName=i,this._targetInst=d,this.type=l,this.nativeEvent=m,this.target=x,this.currentTarget=null;for(var j in e)e.hasOwnProperty(j)&&(i=e[j],this[j]=i?i(m):m[j]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?bi:Xc,this.isPropagationStopped=Xc,this}return Y(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=bi)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=bi)},persist:function(){},isPersistent:bi}),t}var Or={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ia=Wt(Or),bs=Y({},Or,{view:0,detail:0}),Vh=Wt(bs),oa,aa,ks,ki=Y({},bs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ca,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ks&&(ks&&e.type==="mousemove"?(oa=e.screenX-ks.screenX,aa=e.screenY-ks.screenY):aa=oa=0,ks=e),oa)},movementY:function(e){return"movementY"in e?e.movementY:aa}}),Qc=Wt(ki),Gh=Y({},ki,{dataTransfer:0}),Yh=Wt(Gh),Kh=Y({},bs,{relatedTarget:0}),la=Wt(Kh),Xh=Y({},Or,{animationName:0,elapsedTime:0,pseudoElement:0}),Qh=Wt(Xh),qh=Y({},Or,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Zh=Wt(qh),Jh=Y({},Or,{data:0}),qc=Wt(Jh),em={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rm(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=nm[e])?!!t[e]:!1}function ca(){return rm}var sm=Y({},bs,{key:function(e){if(e.key){var t=em[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=wi(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?tm[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ca,charCode:function(e){return e.type==="keypress"?wi(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?wi(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),im=Wt(sm),om=Y({},ki,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zc=Wt(om),am=Y({},bs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ca}),lm=Wt(am),cm=Y({},Or,{propertyName:0,elapsedTime:0,pseudoElement:0}),um=Wt(cm),dm=Y({},ki,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),fm=Wt(dm),pm=[9,13,27,32],ua=c&&"CompositionEvent"in window,Ss=null;c&&"documentMode"in document&&(Ss=document.documentMode);var hm=c&&"TextEvent"in window&&!Ss,Jc=c&&(!ua||Ss&&8<Ss&&11>=Ss),eu=" ",tu=!1;function nu(e,t){switch(e){case"keyup":return pm.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ru(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Fr=!1;function mm(e,t){switch(e){case"compositionend":return ru(t);case"keypress":return t.which!==32?null:(tu=!0,eu);case"textInput":return e=t.data,e===eu&&tu?null:e;default:return null}}function gm(e,t){if(Fr)return e==="compositionend"||!ua&&nu(e,t)?(e=Kc(),xi=sa=Vn=null,Fr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Jc&&t.locale!=="ko"?null:t.data;default:return null}}var ym={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function su(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!ym[e.type]:t==="textarea"}function iu(e,t,i,l){hn(l),t=Ci(t,"onChange"),0<t.length&&(i=new ia("onChange","change",null,i,l),e.push({event:i,listeners:t}))}var Ns=null,_s=null;function vm(e){Su(e,0)}function Si(e){var t=Hr(e);if(ue(t))return e}function xm(e,t){if(e==="change")return t}var ou=!1;if(c){var da;if(c){var fa="oninput"in document;if(!fa){var au=document.createElement("div");au.setAttribute("oninput","return;"),fa=typeof au.oninput=="function"}da=fa}else da=!1;ou=da&&(!document.documentMode||9<document.documentMode)}function lu(){Ns&&(Ns.detachEvent("onpropertychange",cu),_s=Ns=null)}function cu(e){if(e.propertyName==="value"&&Si(_s)){var t=[];iu(t,_s,e,Me(e)),Dn(vm,t)}}function wm(e,t,i){e==="focusin"?(lu(),Ns=t,_s=i,Ns.attachEvent("onpropertychange",cu)):e==="focusout"&&lu()}function bm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Si(_s)}function km(e,t){if(e==="click")return Si(t)}function Sm(e,t){if(e==="input"||e==="change")return Si(t)}function Nm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var sn=typeof Object.is=="function"?Object.is:Nm;function Es(e,t){if(sn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),l=Object.keys(t);if(i.length!==l.length)return!1;for(l=0;l<i.length;l++){var d=i[l];if(!p.call(t,d)||!sn(e[d],t[d]))return!1}return!0}function uu(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function du(e,t){var i=uu(e);e=0;for(var l;i;){if(i.nodeType===3){if(l=e+i.textContent.length,e<=t&&l>=t)return{node:i,offset:t-e};e=l}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=uu(i)}}function fu(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?fu(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function pu(){for(var e=window,t=oe();t instanceof e.HTMLIFrameElement;){try{var i=typeof t.contentWindow.location.href=="string"}catch{i=!1}if(i)e=t.contentWindow;else break;t=oe(e.document)}return t}function pa(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function _m(e){var t=pu(),i=e.focusedElem,l=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&fu(i.ownerDocument.documentElement,i)){if(l!==null&&pa(i)){if(t=l.start,e=l.end,e===void 0&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if(e=(t=i.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var d=i.textContent.length,m=Math.min(l.start,d);l=l.end===void 0?m:Math.min(l.end,d),!e.extend&&m>l&&(d=l,l=m,m=d),d=du(i,m);var x=du(i,l);d&&x&&(e.rangeCount!==1||e.anchorNode!==d.node||e.anchorOffset!==d.offset||e.focusNode!==x.node||e.focusOffset!==x.offset)&&(t=t.createRange(),t.setStart(d.node,d.offset),e.removeAllRanges(),m>l?(e.addRange(t),e.extend(x.node,x.offset)):(t.setEnd(x.node,x.offset),e.addRange(t)))}}for(t=[],e=i;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<t.length;i++)e=t[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Em=c&&"documentMode"in document&&11>=document.documentMode,Dr=null,ha=null,Cs=null,ma=!1;function hu(e,t,i){var l=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;ma||Dr==null||Dr!==oe(l)||(l=Dr,"selectionStart"in l&&pa(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Cs&&Es(Cs,l)||(Cs=l,l=Ci(ha,"onSelect"),0<l.length&&(t=new ia("onSelect","select",null,t,i),e.push({event:t,listeners:l}),t.target=Dr)))}function Ni(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var $r={animationend:Ni("Animation","AnimationEnd"),animationiteration:Ni("Animation","AnimationIteration"),animationstart:Ni("Animation","AnimationStart"),transitionend:Ni("Transition","TransitionEnd")},ga={},mu={};c&&(mu=document.createElement("div").style,"AnimationEvent"in window||(delete $r.animationend.animation,delete $r.animationiteration.animation,delete $r.animationstart.animation),"TransitionEvent"in window||delete $r.transitionend.transition);function _i(e){if(ga[e])return ga[e];if(!$r[e])return e;var t=$r[e],i;for(i in t)if(t.hasOwnProperty(i)&&i in mu)return ga[e]=t[i];return e}var gu=_i("animationend"),yu=_i("animationiteration"),vu=_i("animationstart"),xu=_i("transitionend"),wu=new Map,bu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gn(e,t){wu.set(e,t),u(t,[e])}for(var ya=0;ya<bu.length;ya++){var va=bu[ya],Cm=va.toLowerCase(),Im=va[0].toUpperCase()+va.slice(1);Gn(Cm,"on"+Im)}Gn(gu,"onAnimationEnd"),Gn(yu,"onAnimationIteration"),Gn(vu,"onAnimationStart"),Gn("dblclick","onDoubleClick"),Gn("focusin","onFocus"),Gn("focusout","onBlur"),Gn(xu,"onTransitionEnd"),f("onMouseEnter",["mouseout","mouseover"]),f("onMouseLeave",["mouseout","mouseover"]),f("onPointerEnter",["pointerout","pointerover"]),f("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Is="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jm=new Set("cancel close invalid load scroll toggle".split(" ").concat(Is));function ku(e,t,i){var l=e.type||"unknown-event";e.currentTarget=i,Ch(l,t,void 0,e),e.currentTarget=null}function Su(e,t){t=(t&4)!==0;for(var i=0;i<e.length;i++){var l=e[i],d=l.event;l=l.listeners;e:{var m=void 0;if(t)for(var x=l.length-1;0<=x;x--){var j=l[x],T=j.instance,G=j.currentTarget;if(j=j.listener,T!==m&&d.isPropagationStopped())break e;ku(d,j,G),m=T}else for(x=0;x<l.length;x++){if(j=l[x],T=j.instance,G=j.currentTarget,j=j.listener,T!==m&&d.isPropagationStopped())break e;ku(d,j,G),m=T}}}if(ci)throw e=Xo,ci=!1,Xo=null,e}function Xe(e,t){var i=t[Ea];i===void 0&&(i=t[Ea]=new Set);var l=e+"__bubble";i.has(l)||(Nu(t,e,2,!1),i.add(l))}function xa(e,t,i){var l=0;t&&(l|=4),Nu(i,e,l,t)}var Ei="_reactListening"+Math.random().toString(36).slice(2);function js(e){if(!e[Ei]){e[Ei]=!0,o.forEach(function(i){i!=="selectionchange"&&(jm.has(i)||xa(i,!1,e),xa(i,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ei]||(t[Ei]=!0,xa("selectionchange",!1,t))}}function Nu(e,t,i,l){switch(Yc(t)){case 1:var d=Hh;break;case 4:d=Wh;break;default:d=na}i=d.bind(null,t,i,e),d=void 0,!Rr||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(d=!0),l?d!==void 0?e.addEventListener(t,i,{capture:!0,passive:d}):e.addEventListener(t,i,!0):d!==void 0?e.addEventListener(t,i,{passive:d}):e.addEventListener(t,i,!1)}function wa(e,t,i,l,d){var m=l;if((t&1)===0&&(t&2)===0&&l!==null)e:for(;;){if(l===null)return;var x=l.tag;if(x===3||x===4){var j=l.stateNode.containerInfo;if(j===d||j.nodeType===8&&j.parentNode===d)break;if(x===4)for(x=l.return;x!==null;){var T=x.tag;if((T===3||T===4)&&(T=x.stateNode.containerInfo,T===d||T.nodeType===8&&T.parentNode===d))return;x=x.return}for(;j!==null;){if(x=yr(j),x===null)return;if(T=x.tag,T===5||T===6){l=m=x;continue e}j=j.parentNode}}l=l.return}Dn(function(){var G=m,ie=Me(i),le=[];e:{var re=wu.get(e);if(re!==void 0){var ye=ia,be=e;switch(e){case"keypress":if(wi(i)===0)break e;case"keydown":case"keyup":ye=im;break;case"focusin":be="focus",ye=la;break;case"focusout":be="blur",ye=la;break;case"beforeblur":case"afterblur":ye=la;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=Qc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=Yh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=lm;break;case gu:case yu:case vu:ye=Qh;break;case xu:ye=um;break;case"scroll":ye=Vh;break;case"wheel":ye=fm;break;case"copy":case"cut":case"paste":ye=Zh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=Zc}var Se=(t&4)!==0,ct=!Se&&e==="scroll",$=Se?re!==null?re+"Capture":null:re;Se=[];for(var R=G,U;R!==null;){U=R;var de=U.stateNode;if(U.tag===5&&de!==null&&(U=de,$!==null&&(de=$n(R,$),de!=null&&Se.push(Ms(R,de,U)))),ct)break;R=R.return}0<Se.length&&(re=new ye(re,be,null,i,ie),le.push({event:re,listeners:Se}))}}if((t&7)===0){e:{if(re=e==="mouseover"||e==="pointerover",ye=e==="mouseout"||e==="pointerout",re&&i!==Te&&(be=i.relatedTarget||i.fromElement)&&(yr(be)||be[Nn]))break e;if((ye||re)&&(re=ie.window===ie?ie:(re=ie.ownerDocument)?re.defaultView||re.parentWindow:window,ye?(be=i.relatedTarget||i.toElement,ye=G,be=be?yr(be):null,be!==null&&(ct=gr(be),be!==ct||be.tag!==5&&be.tag!==6)&&(be=null)):(ye=null,be=G),ye!==be)){if(Se=Qc,de="onMouseLeave",$="onMouseEnter",R="mouse",(e==="pointerout"||e==="pointerover")&&(Se=Zc,de="onPointerLeave",$="onPointerEnter",R="pointer"),ct=ye==null?re:Hr(ye),U=be==null?re:Hr(be),re=new Se(de,R+"leave",ye,i,ie),re.target=ct,re.relatedTarget=U,de=null,yr(ie)===G&&(Se=new Se($,R+"enter",be,i,ie),Se.target=U,Se.relatedTarget=ct,de=Se),ct=de,ye&&be)t:{for(Se=ye,$=be,R=0,U=Se;U;U=Br(U))R++;for(U=0,de=$;de;de=Br(de))U++;for(;0<R-U;)Se=Br(Se),R--;for(;0<U-R;)$=Br($),U--;for(;R--;){if(Se===$||$!==null&&Se===$.alternate)break t;Se=Br(Se),$=Br($)}Se=null}else Se=null;ye!==null&&_u(le,re,ye,Se,!1),be!==null&&ct!==null&&_u(le,ct,be,Se,!0)}}e:{if(re=G?Hr(G):window,ye=re.nodeName&&re.nodeName.toLowerCase(),ye==="select"||ye==="input"&&re.type==="file")var Ne=xm;else if(su(re))if(ou)Ne=Sm;else{Ne=bm;var Ie=wm}else(ye=re.nodeName)&&ye.toLowerCase()==="input"&&(re.type==="checkbox"||re.type==="radio")&&(Ne=km);if(Ne&&(Ne=Ne(e,G))){iu(le,Ne,i,ie);break e}Ie&&Ie(e,re,G),e==="focusout"&&(Ie=re._wrapperState)&&Ie.controlled&&re.type==="number"&&Re(re,"number",re.value)}switch(Ie=G?Hr(G):window,e){case"focusin":(su(Ie)||Ie.contentEditable==="true")&&(Dr=Ie,ha=G,Cs=null);break;case"focusout":Cs=ha=Dr=null;break;case"mousedown":ma=!0;break;case"contextmenu":case"mouseup":case"dragend":ma=!1,hu(le,i,ie);break;case"selectionchange":if(Em)break;case"keydown":case"keyup":hu(le,i,ie)}var je;if(ua)e:{switch(e){case"compositionstart":var Ae="onCompositionStart";break e;case"compositionend":Ae="onCompositionEnd";break e;case"compositionupdate":Ae="onCompositionUpdate";break e}Ae=void 0}else Fr?nu(e,i)&&(Ae="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(Ae="onCompositionStart");Ae&&(Jc&&i.locale!=="ko"&&(Fr||Ae!=="onCompositionStart"?Ae==="onCompositionEnd"&&Fr&&(je=Kc()):(Vn=ie,sa="value"in Vn?Vn.value:Vn.textContent,Fr=!0)),Ie=Ci(G,Ae),0<Ie.length&&(Ae=new qc(Ae,e,null,i,ie),le.push({event:Ae,listeners:Ie}),je?Ae.data=je:(je=ru(i),je!==null&&(Ae.data=je)))),(je=hm?mm(e,i):gm(e,i))&&(G=Ci(G,"onBeforeInput"),0<G.length&&(ie=new qc("onBeforeInput","beforeinput",null,i,ie),le.push({event:ie,listeners:G}),ie.data=je))}Su(le,t)})}function Ms(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Ci(e,t){for(var i=t+"Capture",l=[];e!==null;){var d=e,m=d.stateNode;d.tag===5&&m!==null&&(d=m,m=$n(e,i),m!=null&&l.unshift(Ms(e,m,d)),m=$n(e,t),m!=null&&l.push(Ms(e,m,d))),e=e.return}return l}function Br(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function _u(e,t,i,l,d){for(var m=t._reactName,x=[];i!==null&&i!==l;){var j=i,T=j.alternate,G=j.stateNode;if(T!==null&&T===l)break;j.tag===5&&G!==null&&(j=G,d?(T=$n(i,m),T!=null&&x.unshift(Ms(i,T,j))):d||(T=$n(i,m),T!=null&&x.push(Ms(i,T,j)))),i=i.return}x.length!==0&&e.push({event:t,listeners:x})}var Mm=/\r\n?/g,Pm=/\u0000|\uFFFD/g;function Eu(e){return(typeof e=="string"?e:""+e).replace(Mm,`
`).replace(Pm,"")}function Ii(e,t,i){if(t=Eu(t),Eu(e)!==t&&i)throw Error(s(425))}function ji(){}var ba=null,ka=null;function Sa(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Na=typeof setTimeout=="function"?setTimeout:void 0,Tm=typeof clearTimeout=="function"?clearTimeout:void 0,Cu=typeof Promise=="function"?Promise:void 0,Am=typeof queueMicrotask=="function"?queueMicrotask:typeof Cu<"u"?function(e){return Cu.resolve(null).then(e).catch(Lm)}:Na;function Lm(e){setTimeout(function(){throw e})}function _a(e,t){var i=t,l=0;do{var d=i.nextSibling;if(e.removeChild(i),d&&d.nodeType===8)if(i=d.data,i==="/$"){if(l===0){e.removeChild(d),ws(t);return}l--}else i!=="$"&&i!=="$?"&&i!=="$!"||l++;i=d}while(i);ws(t)}function Yn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Iu(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(t===0)return e;t--}else i==="/$"&&t++}e=e.previousSibling}return null}var Ur=Math.random().toString(36).slice(2),gn="__reactFiber$"+Ur,Ps="__reactProps$"+Ur,Nn="__reactContainer$"+Ur,Ea="__reactEvents$"+Ur,Rm="__reactListeners$"+Ur,zm="__reactHandles$"+Ur;function yr(e){var t=e[gn];if(t)return t;for(var i=e.parentNode;i;){if(t=i[Nn]||i[gn]){if(i=t.alternate,t.child!==null||i!==null&&i.child!==null)for(e=Iu(e);e!==null;){if(i=e[gn])return i;e=Iu(e)}return t}e=i,i=e.parentNode}return null}function Ts(e){return e=e[gn]||e[Nn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Hr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(s(33))}function Mi(e){return e[Ps]||null}var Ca=[],Wr=-1;function Kn(e){return{current:e}}function Qe(e){0>Wr||(e.current=Ca[Wr],Ca[Wr]=null,Wr--)}function Ve(e,t){Wr++,Ca[Wr]=e.current,e.current=t}var Xn={},Et=Kn(Xn),Lt=Kn(!1),vr=Xn;function Vr(e,t){var i=e.type.contextTypes;if(!i)return Xn;var l=e.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===t)return l.__reactInternalMemoizedMaskedChildContext;var d={},m;for(m in i)d[m]=t[m];return l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=d),d}function Rt(e){return e=e.childContextTypes,e!=null}function Pi(){Qe(Lt),Qe(Et)}function ju(e,t,i){if(Et.current!==Xn)throw Error(s(168));Ve(Et,t),Ve(Lt,i)}function Mu(e,t,i){var l=e.stateNode;if(t=t.childContextTypes,typeof l.getChildContext!="function")return i;l=l.getChildContext();for(var d in l)if(!(d in t))throw Error(s(108,se(e)||"Unknown",d));return Y({},i,l)}function Ti(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Xn,vr=Et.current,Ve(Et,e),Ve(Lt,Lt.current),!0}function Pu(e,t,i){var l=e.stateNode;if(!l)throw Error(s(169));i?(e=Mu(e,t,vr),l.__reactInternalMemoizedMergedChildContext=e,Qe(Lt),Qe(Et),Ve(Et,e)):Qe(Lt),Ve(Lt,i)}var _n=null,Ai=!1,Ia=!1;function Tu(e){_n===null?_n=[e]:_n.push(e)}function Om(e){Ai=!0,Tu(e)}function Qn(){if(!Ia&&_n!==null){Ia=!0;var e=0,t=Ue;try{var i=_n;for(Ue=1;e<i.length;e++){var l=i[e];do l=l(!0);while(l!==null)}_n=null,Ai=!1}catch(d){throw _n!==null&&(_n=_n.slice(e+1)),Lc(Qo,Qn),d}finally{Ue=t,Ia=!1}}return null}var Gr=[],Yr=0,Li=null,Ri=0,Qt=[],qt=0,xr=null,En=1,Cn="";function wr(e,t){Gr[Yr++]=Ri,Gr[Yr++]=Li,Li=e,Ri=t}function Au(e,t,i){Qt[qt++]=En,Qt[qt++]=Cn,Qt[qt++]=xr,xr=e;var l=En;e=Cn;var d=32-rn(l)-1;l&=~(1<<d),i+=1;var m=32-rn(t)+d;if(30<m){var x=d-d%5;m=(l&(1<<x)-1).toString(32),l>>=x,d-=x,En=1<<32-rn(t)+d|i<<d|l,Cn=m+e}else En=1<<m|i<<d|l,Cn=e}function ja(e){e.return!==null&&(wr(e,1),Au(e,1,0))}function Ma(e){for(;e===Li;)Li=Gr[--Yr],Gr[Yr]=null,Ri=Gr[--Yr],Gr[Yr]=null;for(;e===xr;)xr=Qt[--qt],Qt[qt]=null,Cn=Qt[--qt],Qt[qt]=null,En=Qt[--qt],Qt[qt]=null}var Vt=null,Gt=null,tt=!1,on=null;function Lu(e,t){var i=tn(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)}function Ru(e,t){switch(e.tag){case 5:var i=e.type;return t=t.nodeType!==1||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Vt=e,Gt=Yn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Vt=e,Gt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(i=xr!==null?{id:En,overflow:Cn}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},i=tn(18,null,null,0),i.stateNode=t,i.return=e,e.child=i,Vt=e,Gt=null,!0):!1;default:return!1}}function Pa(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ta(e){if(tt){var t=Gt;if(t){var i=t;if(!Ru(e,t)){if(Pa(e))throw Error(s(418));t=Yn(i.nextSibling);var l=Vt;t&&Ru(e,t)?Lu(l,i):(e.flags=e.flags&-4097|2,tt=!1,Vt=e)}}else{if(Pa(e))throw Error(s(418));e.flags=e.flags&-4097|2,tt=!1,Vt=e}}}function zu(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Vt=e}function zi(e){if(e!==Vt)return!1;if(!tt)return zu(e),tt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Sa(e.type,e.memoizedProps)),t&&(t=Gt)){if(Pa(e))throw Ou(),Error(s(418));for(;t;)Lu(e,t),t=Yn(t.nextSibling)}if(zu(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(t===0){Gt=Yn(e.nextSibling);break e}t--}else i!=="$"&&i!=="$!"&&i!=="$?"||t++}e=e.nextSibling}Gt=null}}else Gt=Vt?Yn(e.stateNode.nextSibling):null;return!0}function Ou(){for(var e=Gt;e;)e=Yn(e.nextSibling)}function Kr(){Gt=Vt=null,tt=!1}function Aa(e){on===null?on=[e]:on.push(e)}var Fm=D.ReactCurrentBatchConfig;function As(e,t,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(s(309));var l=i.stateNode}if(!l)throw Error(s(147,e));var d=l,m=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===m?t.ref:(t=function(x){var j=d.refs;x===null?delete j[m]:j[m]=x},t._stringRef=m,t)}if(typeof e!="string")throw Error(s(284));if(!i._owner)throw Error(s(290,e))}return e}function Oi(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Fu(e){var t=e._init;return t(e._payload)}function Du(e){function t($,R){if(e){var U=$.deletions;U===null?($.deletions=[R],$.flags|=16):U.push(R)}}function i($,R){if(!e)return null;for(;R!==null;)t($,R),R=R.sibling;return null}function l($,R){for($=new Map;R!==null;)R.key!==null?$.set(R.key,R):$.set(R.index,R),R=R.sibling;return $}function d($,R){return $=sr($,R),$.index=0,$.sibling=null,$}function m($,R,U){return $.index=U,e?(U=$.alternate,U!==null?(U=U.index,U<R?($.flags|=2,R):U):($.flags|=2,R)):($.flags|=1048576,R)}function x($){return e&&$.alternate===null&&($.flags|=2),$}function j($,R,U,de){return R===null||R.tag!==6?(R=Nl(U,$.mode,de),R.return=$,R):(R=d(R,U),R.return=$,R)}function T($,R,U,de){var Ne=U.type;return Ne===H?ie($,R,U.props.children,de,U.key):R!==null&&(R.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===Z&&Fu(Ne)===R.type)?(de=d(R,U.props),de.ref=As($,R,U),de.return=$,de):(de=ao(U.type,U.key,U.props,null,$.mode,de),de.ref=As($,R,U),de.return=$,de)}function G($,R,U,de){return R===null||R.tag!==4||R.stateNode.containerInfo!==U.containerInfo||R.stateNode.implementation!==U.implementation?(R=_l(U,$.mode,de),R.return=$,R):(R=d(R,U.children||[]),R.return=$,R)}function ie($,R,U,de,Ne){return R===null||R.tag!==7?(R=Ir(U,$.mode,de,Ne),R.return=$,R):(R=d(R,U),R.return=$,R)}function le($,R,U){if(typeof R=="string"&&R!==""||typeof R=="number")return R=Nl(""+R,$.mode,U),R.return=$,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case L:return U=ao(R.type,R.key,R.props,null,$.mode,U),U.ref=As($,null,R),U.return=$,U;case F:return R=_l(R,$.mode,U),R.return=$,R;case Z:var de=R._init;return le($,de(R._payload),U)}if(Fe(R)||V(R))return R=Ir(R,$.mode,U,null),R.return=$,R;Oi($,R)}return null}function re($,R,U,de){var Ne=R!==null?R.key:null;if(typeof U=="string"&&U!==""||typeof U=="number")return Ne!==null?null:j($,R,""+U,de);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case L:return U.key===Ne?T($,R,U,de):null;case F:return U.key===Ne?G($,R,U,de):null;case Z:return Ne=U._init,re($,R,Ne(U._payload),de)}if(Fe(U)||V(U))return Ne!==null?null:ie($,R,U,de,null);Oi($,U)}return null}function ye($,R,U,de,Ne){if(typeof de=="string"&&de!==""||typeof de=="number")return $=$.get(U)||null,j(R,$,""+de,Ne);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case L:return $=$.get(de.key===null?U:de.key)||null,T(R,$,de,Ne);case F:return $=$.get(de.key===null?U:de.key)||null,G(R,$,de,Ne);case Z:var Ie=de._init;return ye($,R,U,Ie(de._payload),Ne)}if(Fe(de)||V(de))return $=$.get(U)||null,ie(R,$,de,Ne,null);Oi(R,de)}return null}function be($,R,U,de){for(var Ne=null,Ie=null,je=R,Ae=R=0,wt=null;je!==null&&Ae<U.length;Ae++){je.index>Ae?(wt=je,je=null):wt=je.sibling;var $e=re($,je,U[Ae],de);if($e===null){je===null&&(je=wt);break}e&&je&&$e.alternate===null&&t($,je),R=m($e,R,Ae),Ie===null?Ne=$e:Ie.sibling=$e,Ie=$e,je=wt}if(Ae===U.length)return i($,je),tt&&wr($,Ae),Ne;if(je===null){for(;Ae<U.length;Ae++)je=le($,U[Ae],de),je!==null&&(R=m(je,R,Ae),Ie===null?Ne=je:Ie.sibling=je,Ie=je);return tt&&wr($,Ae),Ne}for(je=l($,je);Ae<U.length;Ae++)wt=ye(je,$,Ae,U[Ae],de),wt!==null&&(e&&wt.alternate!==null&&je.delete(wt.key===null?Ae:wt.key),R=m(wt,R,Ae),Ie===null?Ne=wt:Ie.sibling=wt,Ie=wt);return e&&je.forEach(function(ir){return t($,ir)}),tt&&wr($,Ae),Ne}function Se($,R,U,de){var Ne=V(U);if(typeof Ne!="function")throw Error(s(150));if(U=Ne.call(U),U==null)throw Error(s(151));for(var Ie=Ne=null,je=R,Ae=R=0,wt=null,$e=U.next();je!==null&&!$e.done;Ae++,$e=U.next()){je.index>Ae?(wt=je,je=null):wt=je.sibling;var ir=re($,je,$e.value,de);if(ir===null){je===null&&(je=wt);break}e&&je&&ir.alternate===null&&t($,je),R=m(ir,R,Ae),Ie===null?Ne=ir:Ie.sibling=ir,Ie=ir,je=wt}if($e.done)return i($,je),tt&&wr($,Ae),Ne;if(je===null){for(;!$e.done;Ae++,$e=U.next())$e=le($,$e.value,de),$e!==null&&(R=m($e,R,Ae),Ie===null?Ne=$e:Ie.sibling=$e,Ie=$e);return tt&&wr($,Ae),Ne}for(je=l($,je);!$e.done;Ae++,$e=U.next())$e=ye(je,$,Ae,$e.value,de),$e!==null&&(e&&$e.alternate!==null&&je.delete($e.key===null?Ae:$e.key),R=m($e,R,Ae),Ie===null?Ne=$e:Ie.sibling=$e,Ie=$e);return e&&je.forEach(function(yg){return t($,yg)}),tt&&wr($,Ae),Ne}function ct($,R,U,de){if(typeof U=="object"&&U!==null&&U.type===H&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case L:e:{for(var Ne=U.key,Ie=R;Ie!==null;){if(Ie.key===Ne){if(Ne=U.type,Ne===H){if(Ie.tag===7){i($,Ie.sibling),R=d(Ie,U.props.children),R.return=$,$=R;break e}}else if(Ie.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===Z&&Fu(Ne)===Ie.type){i($,Ie.sibling),R=d(Ie,U.props),R.ref=As($,Ie,U),R.return=$,$=R;break e}i($,Ie);break}else t($,Ie);Ie=Ie.sibling}U.type===H?(R=Ir(U.props.children,$.mode,de,U.key),R.return=$,$=R):(de=ao(U.type,U.key,U.props,null,$.mode,de),de.ref=As($,R,U),de.return=$,$=de)}return x($);case F:e:{for(Ie=U.key;R!==null;){if(R.key===Ie)if(R.tag===4&&R.stateNode.containerInfo===U.containerInfo&&R.stateNode.implementation===U.implementation){i($,R.sibling),R=d(R,U.children||[]),R.return=$,$=R;break e}else{i($,R);break}else t($,R);R=R.sibling}R=_l(U,$.mode,de),R.return=$,$=R}return x($);case Z:return Ie=U._init,ct($,R,Ie(U._payload),de)}if(Fe(U))return be($,R,U,de);if(V(U))return Se($,R,U,de);Oi($,U)}return typeof U=="string"&&U!==""||typeof U=="number"?(U=""+U,R!==null&&R.tag===6?(i($,R.sibling),R=d(R,U),R.return=$,$=R):(i($,R),R=Nl(U,$.mode,de),R.return=$,$=R),x($)):i($,R)}return ct}var Xr=Du(!0),$u=Du(!1),Fi=Kn(null),Di=null,Qr=null,La=null;function Ra(){La=Qr=Di=null}function za(e){var t=Fi.current;Qe(Fi),e._currentValue=t}function Oa(e,t,i){for(;e!==null;){var l=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,l!==null&&(l.childLanes|=t)):l!==null&&(l.childLanes&t)!==t&&(l.childLanes|=t),e===i)break;e=e.return}}function qr(e,t){Di=e,La=Qr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(zt=!0),e.firstContext=null)}function Zt(e){var t=e._currentValue;if(La!==e)if(e={context:e,memoizedValue:t,next:null},Qr===null){if(Di===null)throw Error(s(308));Qr=e,Di.dependencies={lanes:0,firstContext:e}}else Qr=Qr.next=e;return t}var br=null;function Fa(e){br===null?br=[e]:br.push(e)}function Bu(e,t,i,l){var d=t.interleaved;return d===null?(i.next=i,Fa(t)):(i.next=d.next,d.next=i),t.interleaved=i,In(e,l)}function In(e,t){e.lanes|=t;var i=e.alternate;for(i!==null&&(i.lanes|=t),i=e,e=e.return;e!==null;)e.childLanes|=t,i=e.alternate,i!==null&&(i.childLanes|=t),i=e,e=e.return;return i.tag===3?i.stateNode:null}var qn=!1;function Da(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Uu(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function jn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Zn(e,t,i){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,(De&2)!==0){var d=l.pending;return d===null?t.next=t:(t.next=d.next,d.next=t),l.pending=t,In(e,i)}return d=l.interleaved,d===null?(t.next=t,Fa(l)):(t.next=d.next,d.next=t),l.interleaved=t,In(e,i)}function $i(e,t,i){if(t=t.updateQueue,t!==null&&(t=t.shared,(i&4194240)!==0)){var l=t.lanes;l&=e.pendingLanes,i|=l,t.lanes=i,Jo(e,i)}}function Hu(e,t){var i=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,i===l)){var d=null,m=null;if(i=i.firstBaseUpdate,i!==null){do{var x={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};m===null?d=m=x:m=m.next=x,i=i.next}while(i!==null);m===null?d=m=t:m=m.next=t}else d=m=t;i={baseState:l.baseState,firstBaseUpdate:d,lastBaseUpdate:m,shared:l.shared,effects:l.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function Bi(e,t,i,l){var d=e.updateQueue;qn=!1;var m=d.firstBaseUpdate,x=d.lastBaseUpdate,j=d.shared.pending;if(j!==null){d.shared.pending=null;var T=j,G=T.next;T.next=null,x===null?m=G:x.next=G,x=T;var ie=e.alternate;ie!==null&&(ie=ie.updateQueue,j=ie.lastBaseUpdate,j!==x&&(j===null?ie.firstBaseUpdate=G:j.next=G,ie.lastBaseUpdate=T))}if(m!==null){var le=d.baseState;x=0,ie=G=T=null,j=m;do{var re=j.lane,ye=j.eventTime;if((l&re)===re){ie!==null&&(ie=ie.next={eventTime:ye,lane:0,tag:j.tag,payload:j.payload,callback:j.callback,next:null});e:{var be=e,Se=j;switch(re=t,ye=i,Se.tag){case 1:if(be=Se.payload,typeof be=="function"){le=be.call(ye,le,re);break e}le=be;break e;case 3:be.flags=be.flags&-65537|128;case 0:if(be=Se.payload,re=typeof be=="function"?be.call(ye,le,re):be,re==null)break e;le=Y({},le,re);break e;case 2:qn=!0}}j.callback!==null&&j.lane!==0&&(e.flags|=64,re=d.effects,re===null?d.effects=[j]:re.push(j))}else ye={eventTime:ye,lane:re,tag:j.tag,payload:j.payload,callback:j.callback,next:null},ie===null?(G=ie=ye,T=le):ie=ie.next=ye,x|=re;if(j=j.next,j===null){if(j=d.shared.pending,j===null)break;re=j,j=re.next,re.next=null,d.lastBaseUpdate=re,d.shared.pending=null}}while(!0);if(ie===null&&(T=le),d.baseState=T,d.firstBaseUpdate=G,d.lastBaseUpdate=ie,t=d.shared.interleaved,t!==null){d=t;do x|=d.lane,d=d.next;while(d!==t)}else m===null&&(d.shared.lanes=0);Nr|=x,e.lanes=x,e.memoizedState=le}}function Wu(e,t,i){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var l=e[t],d=l.callback;if(d!==null){if(l.callback=null,l=i,typeof d!="function")throw Error(s(191,d));d.call(l)}}}var Ls={},yn=Kn(Ls),Rs=Kn(Ls),zs=Kn(Ls);function kr(e){if(e===Ls)throw Error(s(174));return e}function $a(e,t){switch(Ve(zs,t),Ve(Rs,e),Ve(yn,Ls),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:gt(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=gt(t,e)}Qe(yn),Ve(yn,t)}function Zr(){Qe(yn),Qe(Rs),Qe(zs)}function Vu(e){kr(zs.current);var t=kr(yn.current),i=gt(t,e.type);t!==i&&(Ve(Rs,e),Ve(yn,i))}function Ba(e){Rs.current===e&&(Qe(yn),Qe(Rs))}var rt=Kn(0);function Ui(e){for(var t=e;t!==null;){if(t.tag===13){var i=t.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ua=[];function Ha(){for(var e=0;e<Ua.length;e++)Ua[e]._workInProgressVersionPrimary=null;Ua.length=0}var Hi=D.ReactCurrentDispatcher,Wa=D.ReactCurrentBatchConfig,Sr=0,st=null,ht=null,vt=null,Wi=!1,Os=!1,Fs=0,Dm=0;function Ct(){throw Error(s(321))}function Va(e,t){if(t===null)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!sn(e[i],t[i]))return!1;return!0}function Ga(e,t,i,l,d,m){if(Sr=m,st=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Hi.current=e===null||e.memoizedState===null?Hm:Wm,e=i(l,d),Os){m=0;do{if(Os=!1,Fs=0,25<=m)throw Error(s(301));m+=1,vt=ht=null,t.updateQueue=null,Hi.current=Vm,e=i(l,d)}while(Os)}if(Hi.current=Yi,t=ht!==null&&ht.next!==null,Sr=0,vt=ht=st=null,Wi=!1,t)throw Error(s(300));return e}function Ya(){var e=Fs!==0;return Fs=0,e}function vn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vt===null?st.memoizedState=vt=e:vt=vt.next=e,vt}function Jt(){if(ht===null){var e=st.alternate;e=e!==null?e.memoizedState:null}else e=ht.next;var t=vt===null?st.memoizedState:vt.next;if(t!==null)vt=t,ht=e;else{if(e===null)throw Error(s(310));ht=e,e={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},vt===null?st.memoizedState=vt=e:vt=vt.next=e}return vt}function Ds(e,t){return typeof t=="function"?t(e):t}function Ka(e){var t=Jt(),i=t.queue;if(i===null)throw Error(s(311));i.lastRenderedReducer=e;var l=ht,d=l.baseQueue,m=i.pending;if(m!==null){if(d!==null){var x=d.next;d.next=m.next,m.next=x}l.baseQueue=d=m,i.pending=null}if(d!==null){m=d.next,l=l.baseState;var j=x=null,T=null,G=m;do{var ie=G.lane;if((Sr&ie)===ie)T!==null&&(T=T.next={lane:0,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null}),l=G.hasEagerState?G.eagerState:e(l,G.action);else{var le={lane:ie,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null};T===null?(j=T=le,x=l):T=T.next=le,st.lanes|=ie,Nr|=ie}G=G.next}while(G!==null&&G!==m);T===null?x=l:T.next=j,sn(l,t.memoizedState)||(zt=!0),t.memoizedState=l,t.baseState=x,t.baseQueue=T,i.lastRenderedState=l}if(e=i.interleaved,e!==null){d=e;do m=d.lane,st.lanes|=m,Nr|=m,d=d.next;while(d!==e)}else d===null&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function Xa(e){var t=Jt(),i=t.queue;if(i===null)throw Error(s(311));i.lastRenderedReducer=e;var l=i.dispatch,d=i.pending,m=t.memoizedState;if(d!==null){i.pending=null;var x=d=d.next;do m=e(m,x.action),x=x.next;while(x!==d);sn(m,t.memoizedState)||(zt=!0),t.memoizedState=m,t.baseQueue===null&&(t.baseState=m),i.lastRenderedState=m}return[m,l]}function Gu(){}function Yu(e,t){var i=st,l=Jt(),d=t(),m=!sn(l.memoizedState,d);if(m&&(l.memoizedState=d,zt=!0),l=l.queue,Qa(Qu.bind(null,i,l,e),[e]),l.getSnapshot!==t||m||vt!==null&&vt.memoizedState.tag&1){if(i.flags|=2048,$s(9,Xu.bind(null,i,l,d,t),void 0,null),xt===null)throw Error(s(349));(Sr&30)!==0||Ku(i,t,d)}return d}function Ku(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},t=st.updateQueue,t===null?(t={lastEffect:null,stores:null},st.updateQueue=t,t.stores=[e]):(i=t.stores,i===null?t.stores=[e]:i.push(e))}function Xu(e,t,i,l){t.value=i,t.getSnapshot=l,qu(t)&&Zu(e)}function Qu(e,t,i){return i(function(){qu(t)&&Zu(e)})}function qu(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!sn(e,i)}catch{return!0}}function Zu(e){var t=In(e,1);t!==null&&un(t,e,1,-1)}function Ju(e){var t=vn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ds,lastRenderedState:e},t.queue=e,e=e.dispatch=Um.bind(null,st,e),[t.memoizedState,e]}function $s(e,t,i,l){return e={tag:e,create:t,destroy:i,deps:l,next:null},t=st.updateQueue,t===null?(t={lastEffect:null,stores:null},st.updateQueue=t,t.lastEffect=e.next=e):(i=t.lastEffect,i===null?t.lastEffect=e.next=e:(l=i.next,i.next=e,e.next=l,t.lastEffect=e)),e}function ed(){return Jt().memoizedState}function Vi(e,t,i,l){var d=vn();st.flags|=e,d.memoizedState=$s(1|t,i,void 0,l===void 0?null:l)}function Gi(e,t,i,l){var d=Jt();l=l===void 0?null:l;var m=void 0;if(ht!==null){var x=ht.memoizedState;if(m=x.destroy,l!==null&&Va(l,x.deps)){d.memoizedState=$s(t,i,m,l);return}}st.flags|=e,d.memoizedState=$s(1|t,i,m,l)}function td(e,t){return Vi(8390656,8,e,t)}function Qa(e,t){return Gi(2048,8,e,t)}function nd(e,t){return Gi(4,2,e,t)}function rd(e,t){return Gi(4,4,e,t)}function sd(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function id(e,t,i){return i=i!=null?i.concat([e]):null,Gi(4,4,sd.bind(null,t,e),i)}function qa(){}function od(e,t){var i=Jt();t=t===void 0?null:t;var l=i.memoizedState;return l!==null&&t!==null&&Va(t,l[1])?l[0]:(i.memoizedState=[e,t],e)}function ad(e,t){var i=Jt();t=t===void 0?null:t;var l=i.memoizedState;return l!==null&&t!==null&&Va(t,l[1])?l[0]:(e=e(),i.memoizedState=[e,t],e)}function ld(e,t,i){return(Sr&21)===0?(e.baseState&&(e.baseState=!1,zt=!0),e.memoizedState=i):(sn(i,t)||(i=Fc(),st.lanes|=i,Nr|=i,e.baseState=!0),t)}function $m(e,t){var i=Ue;Ue=i!==0&&4>i?i:4,e(!0);var l=Wa.transition;Wa.transition={};try{e(!1),t()}finally{Ue=i,Wa.transition=l}}function cd(){return Jt().memoizedState}function Bm(e,t,i){var l=nr(e);if(i={lane:l,action:i,hasEagerState:!1,eagerState:null,next:null},ud(e))dd(t,i);else if(i=Bu(e,t,i,l),i!==null){var d=Tt();un(i,e,l,d),fd(i,t,l)}}function Um(e,t,i){var l=nr(e),d={lane:l,action:i,hasEagerState:!1,eagerState:null,next:null};if(ud(e))dd(t,d);else{var m=e.alternate;if(e.lanes===0&&(m===null||m.lanes===0)&&(m=t.lastRenderedReducer,m!==null))try{var x=t.lastRenderedState,j=m(x,i);if(d.hasEagerState=!0,d.eagerState=j,sn(j,x)){var T=t.interleaved;T===null?(d.next=d,Fa(t)):(d.next=T.next,T.next=d),t.interleaved=d;return}}catch{}finally{}i=Bu(e,t,d,l),i!==null&&(d=Tt(),un(i,e,l,d),fd(i,t,l))}}function ud(e){var t=e.alternate;return e===st||t!==null&&t===st}function dd(e,t){Os=Wi=!0;var i=e.pending;i===null?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function fd(e,t,i){if((i&4194240)!==0){var l=t.lanes;l&=e.pendingLanes,i|=l,t.lanes=i,Jo(e,i)}}var Yi={readContext:Zt,useCallback:Ct,useContext:Ct,useEffect:Ct,useImperativeHandle:Ct,useInsertionEffect:Ct,useLayoutEffect:Ct,useMemo:Ct,useReducer:Ct,useRef:Ct,useState:Ct,useDebugValue:Ct,useDeferredValue:Ct,useTransition:Ct,useMutableSource:Ct,useSyncExternalStore:Ct,useId:Ct,unstable_isNewReconciler:!1},Hm={readContext:Zt,useCallback:function(e,t){return vn().memoizedState=[e,t===void 0?null:t],e},useContext:Zt,useEffect:td,useImperativeHandle:function(e,t,i){return i=i!=null?i.concat([e]):null,Vi(4194308,4,sd.bind(null,t,e),i)},useLayoutEffect:function(e,t){return Vi(4194308,4,e,t)},useInsertionEffect:function(e,t){return Vi(4,2,e,t)},useMemo:function(e,t){var i=vn();return t=t===void 0?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var l=vn();return t=i!==void 0?i(t):t,l.memoizedState=l.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},l.queue=e,e=e.dispatch=Bm.bind(null,st,e),[l.memoizedState,e]},useRef:function(e){var t=vn();return e={current:e},t.memoizedState=e},useState:Ju,useDebugValue:qa,useDeferredValue:function(e){return vn().memoizedState=e},useTransition:function(){var e=Ju(!1),t=e[0];return e=$m.bind(null,e[1]),vn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var l=st,d=vn();if(tt){if(i===void 0)throw Error(s(407));i=i()}else{if(i=t(),xt===null)throw Error(s(349));(Sr&30)!==0||Ku(l,t,i)}d.memoizedState=i;var m={value:i,getSnapshot:t};return d.queue=m,td(Qu.bind(null,l,m,e),[e]),l.flags|=2048,$s(9,Xu.bind(null,l,m,i,t),void 0,null),i},useId:function(){var e=vn(),t=xt.identifierPrefix;if(tt){var i=Cn,l=En;i=(l&~(1<<32-rn(l)-1)).toString(32)+i,t=":"+t+"R"+i,i=Fs++,0<i&&(t+="H"+i.toString(32)),t+=":"}else i=Dm++,t=":"+t+"r"+i.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Wm={readContext:Zt,useCallback:od,useContext:Zt,useEffect:Qa,useImperativeHandle:id,useInsertionEffect:nd,useLayoutEffect:rd,useMemo:ad,useReducer:Ka,useRef:ed,useState:function(){return Ka(Ds)},useDebugValue:qa,useDeferredValue:function(e){var t=Jt();return ld(t,ht.memoizedState,e)},useTransition:function(){var e=Ka(Ds)[0],t=Jt().memoizedState;return[e,t]},useMutableSource:Gu,useSyncExternalStore:Yu,useId:cd,unstable_isNewReconciler:!1},Vm={readContext:Zt,useCallback:od,useContext:Zt,useEffect:Qa,useImperativeHandle:id,useInsertionEffect:nd,useLayoutEffect:rd,useMemo:ad,useReducer:Xa,useRef:ed,useState:function(){return Xa(Ds)},useDebugValue:qa,useDeferredValue:function(e){var t=Jt();return ht===null?t.memoizedState=e:ld(t,ht.memoizedState,e)},useTransition:function(){var e=Xa(Ds)[0],t=Jt().memoizedState;return[e,t]},useMutableSource:Gu,useSyncExternalStore:Yu,useId:cd,unstable_isNewReconciler:!1};function an(e,t){if(e&&e.defaultProps){t=Y({},t),e=e.defaultProps;for(var i in e)t[i]===void 0&&(t[i]=e[i]);return t}return t}function Za(e,t,i,l){t=e.memoizedState,i=i(l,t),i=i==null?t:Y({},t,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var Ki={isMounted:function(e){return(e=e._reactInternals)?gr(e)===e:!1},enqueueSetState:function(e,t,i){e=e._reactInternals;var l=Tt(),d=nr(e),m=jn(l,d);m.payload=t,i!=null&&(m.callback=i),t=Zn(e,m,d),t!==null&&(un(t,e,d,l),$i(t,e,d))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var l=Tt(),d=nr(e),m=jn(l,d);m.tag=1,m.payload=t,i!=null&&(m.callback=i),t=Zn(e,m,d),t!==null&&(un(t,e,d,l),$i(t,e,d))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=Tt(),l=nr(e),d=jn(i,l);d.tag=2,t!=null&&(d.callback=t),t=Zn(e,d,l),t!==null&&(un(t,e,l,i),$i(t,e,l))}};function pd(e,t,i,l,d,m,x){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,m,x):t.prototype&&t.prototype.isPureReactComponent?!Es(i,l)||!Es(d,m):!0}function hd(e,t,i){var l=!1,d=Xn,m=t.contextType;return typeof m=="object"&&m!==null?m=Zt(m):(d=Rt(t)?vr:Et.current,l=t.contextTypes,m=(l=l!=null)?Vr(e,d):Xn),t=new t(i,m),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ki,e.stateNode=t,t._reactInternals=e,l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=d,e.__reactInternalMemoizedMaskedChildContext=m),t}function md(e,t,i,l){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(i,l),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(i,l),t.state!==e&&Ki.enqueueReplaceState(t,t.state,null)}function Ja(e,t,i,l){var d=e.stateNode;d.props=i,d.state=e.memoizedState,d.refs={},Da(e);var m=t.contextType;typeof m=="object"&&m!==null?d.context=Zt(m):(m=Rt(t)?vr:Et.current,d.context=Vr(e,m)),d.state=e.memoizedState,m=t.getDerivedStateFromProps,typeof m=="function"&&(Za(e,t,m,i),d.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(t=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),t!==d.state&&Ki.enqueueReplaceState(d,d.state,null),Bi(e,i,d,l),d.state=e.memoizedState),typeof d.componentDidMount=="function"&&(e.flags|=4194308)}function Jr(e,t){try{var i="",l=t;do i+=J(l),l=l.return;while(l);var d=i}catch(m){d=`
Error generating stack: `+m.message+`
`+m.stack}return{value:e,source:t,stack:d,digest:null}}function el(e,t,i){return{value:e,source:null,stack:i??null,digest:t??null}}function tl(e,t){try{console.error(t.value)}catch(i){setTimeout(function(){throw i})}}var Gm=typeof WeakMap=="function"?WeakMap:Map;function gd(e,t,i){i=jn(-1,i),i.tag=3,i.payload={element:null};var l=t.value;return i.callback=function(){to||(to=!0,gl=l),tl(e,t)},i}function yd(e,t,i){i=jn(-1,i),i.tag=3;var l=e.type.getDerivedStateFromError;if(typeof l=="function"){var d=t.value;i.payload=function(){return l(d)},i.callback=function(){tl(e,t)}}var m=e.stateNode;return m!==null&&typeof m.componentDidCatch=="function"&&(i.callback=function(){tl(e,t),typeof l!="function"&&(er===null?er=new Set([this]):er.add(this));var x=t.stack;this.componentDidCatch(t.value,{componentStack:x!==null?x:""})}),i}function vd(e,t,i){var l=e.pingCache;if(l===null){l=e.pingCache=new Gm;var d=new Set;l.set(t,d)}else d=l.get(t),d===void 0&&(d=new Set,l.set(t,d));d.has(i)||(d.add(i),e=og.bind(null,e,t,i),t.then(e,e))}function xd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function wd(e,t,i,l,d){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(t=jn(-1,1),t.tag=2,Zn(i,t,1))),i.lanes|=1),e):(e.flags|=65536,e.lanes=d,e)}var Ym=D.ReactCurrentOwner,zt=!1;function Pt(e,t,i,l){t.child=e===null?$u(t,null,i,l):Xr(t,e.child,i,l)}function bd(e,t,i,l,d){i=i.render;var m=t.ref;return qr(t,d),l=Ga(e,t,i,l,m,d),i=Ya(),e!==null&&!zt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~d,Mn(e,t,d)):(tt&&i&&ja(t),t.flags|=1,Pt(e,t,l,d),t.child)}function kd(e,t,i,l,d){if(e===null){var m=i.type;return typeof m=="function"&&!Sl(m)&&m.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(t.tag=15,t.type=m,Sd(e,t,m,l,d)):(e=ao(i.type,null,l,t,t.mode,d),e.ref=t.ref,e.return=t,t.child=e)}if(m=e.child,(e.lanes&d)===0){var x=m.memoizedProps;if(i=i.compare,i=i!==null?i:Es,i(x,l)&&e.ref===t.ref)return Mn(e,t,d)}return t.flags|=1,e=sr(m,l),e.ref=t.ref,e.return=t,t.child=e}function Sd(e,t,i,l,d){if(e!==null){var m=e.memoizedProps;if(Es(m,l)&&e.ref===t.ref)if(zt=!1,t.pendingProps=l=m,(e.lanes&d)!==0)(e.flags&131072)!==0&&(zt=!0);else return t.lanes=e.lanes,Mn(e,t,d)}return nl(e,t,i,l,d)}function Nd(e,t,i){var l=t.pendingProps,d=l.children,m=e!==null?e.memoizedState:null;if(l.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ve(ts,Yt),Yt|=i;else{if((i&1073741824)===0)return e=m!==null?m.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ve(ts,Yt),Yt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=m!==null?m.baseLanes:i,Ve(ts,Yt),Yt|=l}else m!==null?(l=m.baseLanes|i,t.memoizedState=null):l=i,Ve(ts,Yt),Yt|=l;return Pt(e,t,d,i),t.child}function _d(e,t){var i=t.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function nl(e,t,i,l,d){var m=Rt(i)?vr:Et.current;return m=Vr(t,m),qr(t,d),i=Ga(e,t,i,l,m,d),l=Ya(),e!==null&&!zt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~d,Mn(e,t,d)):(tt&&l&&ja(t),t.flags|=1,Pt(e,t,i,d),t.child)}function Ed(e,t,i,l,d){if(Rt(i)){var m=!0;Ti(t)}else m=!1;if(qr(t,d),t.stateNode===null)Qi(e,t),hd(t,i,l),Ja(t,i,l,d),l=!0;else if(e===null){var x=t.stateNode,j=t.memoizedProps;x.props=j;var T=x.context,G=i.contextType;typeof G=="object"&&G!==null?G=Zt(G):(G=Rt(i)?vr:Et.current,G=Vr(t,G));var ie=i.getDerivedStateFromProps,le=typeof ie=="function"||typeof x.getSnapshotBeforeUpdate=="function";le||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(j!==l||T!==G)&&md(t,x,l,G),qn=!1;var re=t.memoizedState;x.state=re,Bi(t,l,x,d),T=t.memoizedState,j!==l||re!==T||Lt.current||qn?(typeof ie=="function"&&(Za(t,i,ie,l),T=t.memoizedState),(j=qn||pd(t,i,j,l,re,T,G))?(le||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(t.flags|=4194308)):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=l,t.memoizedState=T),x.props=l,x.state=T,x.context=G,l=j):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),l=!1)}else{x=t.stateNode,Uu(e,t),j=t.memoizedProps,G=t.type===t.elementType?j:an(t.type,j),x.props=G,le=t.pendingProps,re=x.context,T=i.contextType,typeof T=="object"&&T!==null?T=Zt(T):(T=Rt(i)?vr:Et.current,T=Vr(t,T));var ye=i.getDerivedStateFromProps;(ie=typeof ye=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(j!==le||re!==T)&&md(t,x,l,T),qn=!1,re=t.memoizedState,x.state=re,Bi(t,l,x,d);var be=t.memoizedState;j!==le||re!==be||Lt.current||qn?(typeof ye=="function"&&(Za(t,i,ye,l),be=t.memoizedState),(G=qn||pd(t,i,G,l,re,be,T)||!1)?(ie||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(l,be,T),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(l,be,T)),typeof x.componentDidUpdate=="function"&&(t.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof x.componentDidUpdate!="function"||j===e.memoizedProps&&re===e.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||j===e.memoizedProps&&re===e.memoizedState||(t.flags|=1024),t.memoizedProps=l,t.memoizedState=be),x.props=l,x.state=be,x.context=T,l=G):(typeof x.componentDidUpdate!="function"||j===e.memoizedProps&&re===e.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||j===e.memoizedProps&&re===e.memoizedState||(t.flags|=1024),l=!1)}return rl(e,t,i,l,m,d)}function rl(e,t,i,l,d,m){_d(e,t);var x=(t.flags&128)!==0;if(!l&&!x)return d&&Pu(t,i,!1),Mn(e,t,m);l=t.stateNode,Ym.current=t;var j=x&&typeof i.getDerivedStateFromError!="function"?null:l.render();return t.flags|=1,e!==null&&x?(t.child=Xr(t,e.child,null,m),t.child=Xr(t,null,j,m)):Pt(e,t,j,m),t.memoizedState=l.state,d&&Pu(t,i,!0),t.child}function Cd(e){var t=e.stateNode;t.pendingContext?ju(e,t.pendingContext,t.pendingContext!==t.context):t.context&&ju(e,t.context,!1),$a(e,t.containerInfo)}function Id(e,t,i,l,d){return Kr(),Aa(d),t.flags|=256,Pt(e,t,i,l),t.child}var sl={dehydrated:null,treeContext:null,retryLane:0};function il(e){return{baseLanes:e,cachePool:null,transitions:null}}function jd(e,t,i){var l=t.pendingProps,d=rt.current,m=!1,x=(t.flags&128)!==0,j;if((j=x)||(j=e!==null&&e.memoizedState===null?!1:(d&2)!==0),j?(m=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(d|=1),Ve(rt,d&1),e===null)return Ta(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(x=l.children,e=l.fallback,m?(l=t.mode,m=t.child,x={mode:"hidden",children:x},(l&1)===0&&m!==null?(m.childLanes=0,m.pendingProps=x):m=lo(x,l,0,null),e=Ir(e,l,i,null),m.return=t,e.return=t,m.sibling=e,t.child=m,t.child.memoizedState=il(i),t.memoizedState=sl,e):ol(t,x));if(d=e.memoizedState,d!==null&&(j=d.dehydrated,j!==null))return Km(e,t,x,l,j,d,i);if(m){m=l.fallback,x=t.mode,d=e.child,j=d.sibling;var T={mode:"hidden",children:l.children};return(x&1)===0&&t.child!==d?(l=t.child,l.childLanes=0,l.pendingProps=T,t.deletions=null):(l=sr(d,T),l.subtreeFlags=d.subtreeFlags&14680064),j!==null?m=sr(j,m):(m=Ir(m,x,i,null),m.flags|=2),m.return=t,l.return=t,l.sibling=m,t.child=l,l=m,m=t.child,x=e.child.memoizedState,x=x===null?il(i):{baseLanes:x.baseLanes|i,cachePool:null,transitions:x.transitions},m.memoizedState=x,m.childLanes=e.childLanes&~i,t.memoizedState=sl,l}return m=e.child,e=m.sibling,l=sr(m,{mode:"visible",children:l.children}),(t.mode&1)===0&&(l.lanes=i),l.return=t,l.sibling=null,e!==null&&(i=t.deletions,i===null?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=l,t.memoizedState=null,l}function ol(e,t){return t=lo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Xi(e,t,i,l){return l!==null&&Aa(l),Xr(t,e.child,null,i),e=ol(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Km(e,t,i,l,d,m,x){if(i)return t.flags&256?(t.flags&=-257,l=el(Error(s(422))),Xi(e,t,x,l)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(m=l.fallback,d=t.mode,l=lo({mode:"visible",children:l.children},d,0,null),m=Ir(m,d,x,null),m.flags|=2,l.return=t,m.return=t,l.sibling=m,t.child=l,(t.mode&1)!==0&&Xr(t,e.child,null,x),t.child.memoizedState=il(x),t.memoizedState=sl,m);if((t.mode&1)===0)return Xi(e,t,x,null);if(d.data==="$!"){if(l=d.nextSibling&&d.nextSibling.dataset,l)var j=l.dgst;return l=j,m=Error(s(419)),l=el(m,l,void 0),Xi(e,t,x,l)}if(j=(x&e.childLanes)!==0,zt||j){if(l=xt,l!==null){switch(x&-x){case 4:d=2;break;case 16:d=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:d=32;break;case 536870912:d=268435456;break;default:d=0}d=(d&(l.suspendedLanes|x))!==0?0:d,d!==0&&d!==m.retryLane&&(m.retryLane=d,In(e,d),un(l,e,d,-1))}return kl(),l=el(Error(s(421))),Xi(e,t,x,l)}return d.data==="$?"?(t.flags|=128,t.child=e.child,t=ag.bind(null,e),d._reactRetry=t,null):(e=m.treeContext,Gt=Yn(d.nextSibling),Vt=t,tt=!0,on=null,e!==null&&(Qt[qt++]=En,Qt[qt++]=Cn,Qt[qt++]=xr,En=e.id,Cn=e.overflow,xr=t),t=ol(t,l.children),t.flags|=4096,t)}function Md(e,t,i){e.lanes|=t;var l=e.alternate;l!==null&&(l.lanes|=t),Oa(e.return,t,i)}function al(e,t,i,l,d){var m=e.memoizedState;m===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:l,tail:i,tailMode:d}:(m.isBackwards=t,m.rendering=null,m.renderingStartTime=0,m.last=l,m.tail=i,m.tailMode=d)}function Pd(e,t,i){var l=t.pendingProps,d=l.revealOrder,m=l.tail;if(Pt(e,t,l.children,i),l=rt.current,(l&2)!==0)l=l&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Md(e,i,t);else if(e.tag===19)Md(e,i,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}if(Ve(rt,l),(t.mode&1)===0)t.memoizedState=null;else switch(d){case"forwards":for(i=t.child,d=null;i!==null;)e=i.alternate,e!==null&&Ui(e)===null&&(d=i),i=i.sibling;i=d,i===null?(d=t.child,t.child=null):(d=i.sibling,i.sibling=null),al(t,!1,d,i,m);break;case"backwards":for(i=null,d=t.child,t.child=null;d!==null;){if(e=d.alternate,e!==null&&Ui(e)===null){t.child=d;break}e=d.sibling,d.sibling=i,i=d,d=e}al(t,!0,i,null,m);break;case"together":al(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Qi(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Mn(e,t,i){if(e!==null&&(t.dependencies=e.dependencies),Nr|=t.lanes,(i&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(s(153));if(t.child!==null){for(e=t.child,i=sr(e,e.pendingProps),t.child=i,i.return=t;e.sibling!==null;)e=e.sibling,i=i.sibling=sr(e,e.pendingProps),i.return=t;i.sibling=null}return t.child}function Xm(e,t,i){switch(t.tag){case 3:Cd(t),Kr();break;case 5:Vu(t);break;case 1:Rt(t.type)&&Ti(t);break;case 4:$a(t,t.stateNode.containerInfo);break;case 10:var l=t.type._context,d=t.memoizedProps.value;Ve(Fi,l._currentValue),l._currentValue=d;break;case 13:if(l=t.memoizedState,l!==null)return l.dehydrated!==null?(Ve(rt,rt.current&1),t.flags|=128,null):(i&t.child.childLanes)!==0?jd(e,t,i):(Ve(rt,rt.current&1),e=Mn(e,t,i),e!==null?e.sibling:null);Ve(rt,rt.current&1);break;case 19:if(l=(i&t.childLanes)!==0,(e.flags&128)!==0){if(l)return Pd(e,t,i);t.flags|=128}if(d=t.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),Ve(rt,rt.current),l)break;return null;case 22:case 23:return t.lanes=0,Nd(e,t,i)}return Mn(e,t,i)}var Td,ll,Ad,Ld;Td=function(e,t){for(var i=t.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},ll=function(){},Ad=function(e,t,i,l){var d=e.memoizedProps;if(d!==l){e=t.stateNode,kr(yn.current);var m=null;switch(i){case"input":d=me(e,d),l=me(e,l),m=[];break;case"select":d=Y({},d,{value:void 0}),l=Y({},l,{value:void 0}),m=[];break;case"textarea":d=Ze(e,d),l=Ze(e,l),m=[];break;default:typeof d.onClick!="function"&&typeof l.onClick=="function"&&(e.onclick=ji)}Ht(i,l);var x;i=null;for(G in d)if(!l.hasOwnProperty(G)&&d.hasOwnProperty(G)&&d[G]!=null)if(G==="style"){var j=d[G];for(x in j)j.hasOwnProperty(x)&&(i||(i={}),i[x]="")}else G!=="dangerouslySetInnerHTML"&&G!=="children"&&G!=="suppressContentEditableWarning"&&G!=="suppressHydrationWarning"&&G!=="autoFocus"&&(a.hasOwnProperty(G)?m||(m=[]):(m=m||[]).push(G,null));for(G in l){var T=l[G];if(j=d?.[G],l.hasOwnProperty(G)&&T!==j&&(T!=null||j!=null))if(G==="style")if(j){for(x in j)!j.hasOwnProperty(x)||T&&T.hasOwnProperty(x)||(i||(i={}),i[x]="");for(x in T)T.hasOwnProperty(x)&&j[x]!==T[x]&&(i||(i={}),i[x]=T[x])}else i||(m||(m=[]),m.push(G,i)),i=T;else G==="dangerouslySetInnerHTML"?(T=T?T.__html:void 0,j=j?j.__html:void 0,T!=null&&j!==T&&(m=m||[]).push(G,T)):G==="children"?typeof T!="string"&&typeof T!="number"||(m=m||[]).push(G,""+T):G!=="suppressContentEditableWarning"&&G!=="suppressHydrationWarning"&&(a.hasOwnProperty(G)?(T!=null&&G==="onScroll"&&Xe("scroll",e),m||j===T||(m=[])):(m=m||[]).push(G,T))}i&&(m=m||[]).push("style",i);var G=m;(t.updateQueue=G)&&(t.flags|=4)}},Ld=function(e,t,i,l){i!==l&&(t.flags|=4)};function Bs(e,t){if(!tt)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function It(e){var t=e.alternate!==null&&e.alternate.child===e.child,i=0,l=0;if(t)for(var d=e.child;d!==null;)i|=d.lanes|d.childLanes,l|=d.subtreeFlags&14680064,l|=d.flags&14680064,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)i|=d.lanes|d.childLanes,l|=d.subtreeFlags,l|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=l,e.childLanes=i,t}function Qm(e,t,i){var l=t.pendingProps;switch(Ma(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return It(t),null;case 1:return Rt(t.type)&&Pi(),It(t),null;case 3:return l=t.stateNode,Zr(),Qe(Lt),Qe(Et),Ha(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(zi(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,on!==null&&(xl(on),on=null))),ll(e,t),It(t),null;case 5:Ba(t);var d=kr(zs.current);if(i=t.type,e!==null&&t.stateNode!=null)Ad(e,t,i,l,d),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!l){if(t.stateNode===null)throw Error(s(166));return It(t),null}if(e=kr(yn.current),zi(t)){l=t.stateNode,i=t.type;var m=t.memoizedProps;switch(l[gn]=t,l[Ps]=m,e=(t.mode&1)!==0,i){case"dialog":Xe("cancel",l),Xe("close",l);break;case"iframe":case"object":case"embed":Xe("load",l);break;case"video":case"audio":for(d=0;d<Is.length;d++)Xe(Is[d],l);break;case"source":Xe("error",l);break;case"img":case"image":case"link":Xe("error",l),Xe("load",l);break;case"details":Xe("toggle",l);break;case"input":Q(l,m),Xe("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!m.multiple},Xe("invalid",l);break;case"textarea":ze(l,m),Xe("invalid",l)}Ht(i,m),d=null;for(var x in m)if(m.hasOwnProperty(x)){var j=m[x];x==="children"?typeof j=="string"?l.textContent!==j&&(m.suppressHydrationWarning!==!0&&Ii(l.textContent,j,e),d=["children",j]):typeof j=="number"&&l.textContent!==""+j&&(m.suppressHydrationWarning!==!0&&Ii(l.textContent,j,e),d=["children",""+j]):a.hasOwnProperty(x)&&j!=null&&x==="onScroll"&&Xe("scroll",l)}switch(i){case"input":A(l),Ce(l,m,!0);break;case"textarea":A(l),Ye(l);break;case"select":case"option":break;default:typeof m.onClick=="function"&&(l.onclick=ji)}l=d,t.updateQueue=l,l!==null&&(t.flags|=4)}else{x=d.nodeType===9?d:d.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Mt(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=x.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof l.is=="string"?e=x.createElement(i,{is:l.is}):(e=x.createElement(i),i==="select"&&(x=e,l.multiple?x.multiple=!0:l.size&&(x.size=l.size))):e=x.createElementNS(e,i),e[gn]=t,e[Ps]=l,Td(e,t,!1,!1),t.stateNode=e;e:{switch(x=Ee(i,l),i){case"dialog":Xe("cancel",e),Xe("close",e),d=l;break;case"iframe":case"object":case"embed":Xe("load",e),d=l;break;case"video":case"audio":for(d=0;d<Is.length;d++)Xe(Is[d],e);d=l;break;case"source":Xe("error",e),d=l;break;case"img":case"image":case"link":Xe("error",e),Xe("load",e),d=l;break;case"details":Xe("toggle",e),d=l;break;case"input":Q(e,l),d=me(e,l),Xe("invalid",e);break;case"option":d=l;break;case"select":e._wrapperState={wasMultiple:!!l.multiple},d=Y({},l,{value:void 0}),Xe("invalid",e);break;case"textarea":ze(e,l),d=Ze(e,l),Xe("invalid",e);break;default:d=l}Ht(i,d),j=d;for(m in j)if(j.hasOwnProperty(m)){var T=j[m];m==="style"?pr(e,T):m==="dangerouslySetInnerHTML"?(T=T?T.__html:void 0,T!=null&&nt(e,T)):m==="children"?typeof T=="string"?(i!=="textarea"||T!=="")&&Ke(e,T):typeof T=="number"&&Ke(e,""+T):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(a.hasOwnProperty(m)?T!=null&&m==="onScroll"&&Xe("scroll",e):T!=null&&M(e,m,T,x))}switch(i){case"input":A(e),Ce(e,l,!1);break;case"textarea":A(e),Ye(e);break;case"option":l.value!=null&&e.setAttribute("value",""+pe(l.value));break;case"select":e.multiple=!!l.multiple,m=l.value,m!=null?it(e,!!l.multiple,m,!1):l.defaultValue!=null&&it(e,!!l.multiple,l.defaultValue,!0);break;default:typeof d.onClick=="function"&&(e.onclick=ji)}switch(i){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return It(t),null;case 6:if(e&&t.stateNode!=null)Ld(e,t,e.memoizedProps,l);else{if(typeof l!="string"&&t.stateNode===null)throw Error(s(166));if(i=kr(zs.current),kr(yn.current),zi(t)){if(l=t.stateNode,i=t.memoizedProps,l[gn]=t,(m=l.nodeValue!==i)&&(e=Vt,e!==null))switch(e.tag){case 3:Ii(l.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ii(l.nodeValue,i,(e.mode&1)!==0)}m&&(t.flags|=4)}else l=(i.nodeType===9?i:i.ownerDocument).createTextNode(l),l[gn]=t,t.stateNode=l}return It(t),null;case 13:if(Qe(rt),l=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(tt&&Gt!==null&&(t.mode&1)!==0&&(t.flags&128)===0)Ou(),Kr(),t.flags|=98560,m=!1;else if(m=zi(t),l!==null&&l.dehydrated!==null){if(e===null){if(!m)throw Error(s(318));if(m=t.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(317));m[gn]=t}else Kr(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;It(t),m=!1}else on!==null&&(xl(on),on=null),m=!0;if(!m)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=i,t):(l=l!==null,l!==(e!==null&&e.memoizedState!==null)&&l&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(rt.current&1)!==0?mt===0&&(mt=3):kl())),t.updateQueue!==null&&(t.flags|=4),It(t),null);case 4:return Zr(),ll(e,t),e===null&&js(t.stateNode.containerInfo),It(t),null;case 10:return za(t.type._context),It(t),null;case 17:return Rt(t.type)&&Pi(),It(t),null;case 19:if(Qe(rt),m=t.memoizedState,m===null)return It(t),null;if(l=(t.flags&128)!==0,x=m.rendering,x===null)if(l)Bs(m,!1);else{if(mt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(x=Ui(e),x!==null){for(t.flags|=128,Bs(m,!1),l=x.updateQueue,l!==null&&(t.updateQueue=l,t.flags|=4),t.subtreeFlags=0,l=i,i=t.child;i!==null;)m=i,e=l,m.flags&=14680066,x=m.alternate,x===null?(m.childLanes=0,m.lanes=e,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=x.childLanes,m.lanes=x.lanes,m.child=x.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=x.memoizedProps,m.memoizedState=x.memoizedState,m.updateQueue=x.updateQueue,m.type=x.type,e=x.dependencies,m.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Ve(rt,rt.current&1|2),t.child}e=e.sibling}m.tail!==null&&lt()>ns&&(t.flags|=128,l=!0,Bs(m,!1),t.lanes=4194304)}else{if(!l)if(e=Ui(x),e!==null){if(t.flags|=128,l=!0,i=e.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),Bs(m,!0),m.tail===null&&m.tailMode==="hidden"&&!x.alternate&&!tt)return It(t),null}else 2*lt()-m.renderingStartTime>ns&&i!==1073741824&&(t.flags|=128,l=!0,Bs(m,!1),t.lanes=4194304);m.isBackwards?(x.sibling=t.child,t.child=x):(i=m.last,i!==null?i.sibling=x:t.child=x,m.last=x)}return m.tail!==null?(t=m.tail,m.rendering=t,m.tail=t.sibling,m.renderingStartTime=lt(),t.sibling=null,i=rt.current,Ve(rt,l?i&1|2:i&1),t):(It(t),null);case 22:case 23:return bl(),l=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==l&&(t.flags|=8192),l&&(t.mode&1)!==0?(Yt&1073741824)!==0&&(It(t),t.subtreeFlags&6&&(t.flags|=8192)):It(t),null;case 24:return null;case 25:return null}throw Error(s(156,t.tag))}function qm(e,t){switch(Ma(t),t.tag){case 1:return Rt(t.type)&&Pi(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Zr(),Qe(Lt),Qe(Et),Ha(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return Ba(t),null;case 13:if(Qe(rt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(s(340));Kr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Qe(rt),null;case 4:return Zr(),null;case 10:return za(t.type._context),null;case 22:case 23:return bl(),null;case 24:return null;default:return null}}var qi=!1,jt=!1,Zm=typeof WeakSet=="function"?WeakSet:Set,ve=null;function es(e,t){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(l){at(e,t,l)}else i.current=null}function cl(e,t,i){try{i()}catch(l){at(e,t,l)}}var Rd=!1;function Jm(e,t){if(ba=yi,e=pu(),pa(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var l=i.getSelection&&i.getSelection();if(l&&l.rangeCount!==0){i=l.anchorNode;var d=l.anchorOffset,m=l.focusNode;l=l.focusOffset;try{i.nodeType,m.nodeType}catch{i=null;break e}var x=0,j=-1,T=-1,G=0,ie=0,le=e,re=null;t:for(;;){for(var ye;le!==i||d!==0&&le.nodeType!==3||(j=x+d),le!==m||l!==0&&le.nodeType!==3||(T=x+l),le.nodeType===3&&(x+=le.nodeValue.length),(ye=le.firstChild)!==null;)re=le,le=ye;for(;;){if(le===e)break t;if(re===i&&++G===d&&(j=x),re===m&&++ie===l&&(T=x),(ye=le.nextSibling)!==null)break;le=re,re=le.parentNode}le=ye}i=j===-1||T===-1?null:{start:j,end:T}}else i=null}i=i||{start:0,end:0}}else i=null;for(ka={focusedElem:e,selectionRange:i},yi=!1,ve=t;ve!==null;)if(t=ve,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ve=e;else for(;ve!==null;){t=ve;try{var be=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(be!==null){var Se=be.memoizedProps,ct=be.memoizedState,$=t.stateNode,R=$.getSnapshotBeforeUpdate(t.elementType===t.type?Se:an(t.type,Se),ct);$.__reactInternalSnapshotBeforeUpdate=R}break;case 3:var U=t.stateNode.containerInfo;U.nodeType===1?U.textContent="":U.nodeType===9&&U.documentElement&&U.removeChild(U.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(de){at(t,t.return,de)}if(e=t.sibling,e!==null){e.return=t.return,ve=e;break}ve=t.return}return be=Rd,Rd=!1,be}function Us(e,t,i){var l=t.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var d=l=l.next;do{if((d.tag&e)===e){var m=d.destroy;d.destroy=void 0,m!==void 0&&cl(t,i,m)}d=d.next}while(d!==l)}}function Zi(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var i=t=t.next;do{if((i.tag&e)===e){var l=i.create;i.destroy=l()}i=i.next}while(i!==t)}}function ul(e){var t=e.ref;if(t!==null){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}typeof t=="function"?t(e):t.current=e}}function zd(e){var t=e.alternate;t!==null&&(e.alternate=null,zd(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[gn],delete t[Ps],delete t[Ea],delete t[Rm],delete t[zm])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Od(e){return e.tag===5||e.tag===3||e.tag===4}function Fd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Od(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function dl(e,t,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?i.nodeType===8?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(i.nodeType===8?(t=i.parentNode,t.insertBefore(e,i)):(t=i,t.appendChild(e)),i=i._reactRootContainer,i!=null||t.onclick!==null||(t.onclick=ji));else if(l!==4&&(e=e.child,e!==null))for(dl(e,t,i),e=e.sibling;e!==null;)dl(e,t,i),e=e.sibling}function fl(e,t,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(l!==4&&(e=e.child,e!==null))for(fl(e,t,i),e=e.sibling;e!==null;)fl(e,t,i),e=e.sibling}var kt=null,ln=!1;function Jn(e,t,i){for(i=i.child;i!==null;)Dd(e,t,i),i=i.sibling}function Dd(e,t,i){if(mn&&typeof mn.onCommitFiberUnmount=="function")try{mn.onCommitFiberUnmount(di,i)}catch{}switch(i.tag){case 5:jt||es(i,t);case 6:var l=kt,d=ln;kt=null,Jn(e,t,i),kt=l,ln=d,kt!==null&&(ln?(e=kt,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):kt.removeChild(i.stateNode));break;case 18:kt!==null&&(ln?(e=kt,i=i.stateNode,e.nodeType===8?_a(e.parentNode,i):e.nodeType===1&&_a(e,i),ws(e)):_a(kt,i.stateNode));break;case 4:l=kt,d=ln,kt=i.stateNode.containerInfo,ln=!0,Jn(e,t,i),kt=l,ln=d;break;case 0:case 11:case 14:case 15:if(!jt&&(l=i.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){d=l=l.next;do{var m=d,x=m.destroy;m=m.tag,x!==void 0&&((m&2)!==0||(m&4)!==0)&&cl(i,t,x),d=d.next}while(d!==l)}Jn(e,t,i);break;case 1:if(!jt&&(es(i,t),l=i.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=i.memoizedProps,l.state=i.memoizedState,l.componentWillUnmount()}catch(j){at(i,t,j)}Jn(e,t,i);break;case 21:Jn(e,t,i);break;case 22:i.mode&1?(jt=(l=jt)||i.memoizedState!==null,Jn(e,t,i),jt=l):Jn(e,t,i);break;default:Jn(e,t,i)}}function $d(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new Zm),t.forEach(function(l){var d=lg.bind(null,e,l);i.has(l)||(i.add(l),l.then(d,d))})}}function cn(e,t){var i=t.deletions;if(i!==null)for(var l=0;l<i.length;l++){var d=i[l];try{var m=e,x=t,j=x;e:for(;j!==null;){switch(j.tag){case 5:kt=j.stateNode,ln=!1;break e;case 3:kt=j.stateNode.containerInfo,ln=!0;break e;case 4:kt=j.stateNode.containerInfo,ln=!0;break e}j=j.return}if(kt===null)throw Error(s(160));Dd(m,x,d),kt=null,ln=!1;var T=d.alternate;T!==null&&(T.return=null),d.return=null}catch(G){at(d,t,G)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Bd(t,e),t=t.sibling}function Bd(e,t){var i=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(cn(t,e),xn(e),l&4){try{Us(3,e,e.return),Zi(3,e)}catch(Se){at(e,e.return,Se)}try{Us(5,e,e.return)}catch(Se){at(e,e.return,Se)}}break;case 1:cn(t,e),xn(e),l&512&&i!==null&&es(i,i.return);break;case 5:if(cn(t,e),xn(e),l&512&&i!==null&&es(i,i.return),e.flags&32){var d=e.stateNode;try{Ke(d,"")}catch(Se){at(e,e.return,Se)}}if(l&4&&(d=e.stateNode,d!=null)){var m=e.memoizedProps,x=i!==null?i.memoizedProps:m,j=e.type,T=e.updateQueue;if(e.updateQueue=null,T!==null)try{j==="input"&&m.type==="radio"&&m.name!=null&&fe(d,m),Ee(j,x);var G=Ee(j,m);for(x=0;x<T.length;x+=2){var ie=T[x],le=T[x+1];ie==="style"?pr(d,le):ie==="dangerouslySetInnerHTML"?nt(d,le):ie==="children"?Ke(d,le):M(d,ie,le,G)}switch(j){case"input":we(d,m);break;case"textarea":Je(d,m);break;case"select":var re=d._wrapperState.wasMultiple;d._wrapperState.wasMultiple=!!m.multiple;var ye=m.value;ye!=null?it(d,!!m.multiple,ye,!1):re!==!!m.multiple&&(m.defaultValue!=null?it(d,!!m.multiple,m.defaultValue,!0):it(d,!!m.multiple,m.multiple?[]:"",!1))}d[Ps]=m}catch(Se){at(e,e.return,Se)}}break;case 6:if(cn(t,e),xn(e),l&4){if(e.stateNode===null)throw Error(s(162));d=e.stateNode,m=e.memoizedProps;try{d.nodeValue=m}catch(Se){at(e,e.return,Se)}}break;case 3:if(cn(t,e),xn(e),l&4&&i!==null&&i.memoizedState.isDehydrated)try{ws(t.containerInfo)}catch(Se){at(e,e.return,Se)}break;case 4:cn(t,e),xn(e);break;case 13:cn(t,e),xn(e),d=e.child,d.flags&8192&&(m=d.memoizedState!==null,d.stateNode.isHidden=m,!m||d.alternate!==null&&d.alternate.memoizedState!==null||(ml=lt())),l&4&&$d(e);break;case 22:if(ie=i!==null&&i.memoizedState!==null,e.mode&1?(jt=(G=jt)||ie,cn(t,e),jt=G):cn(t,e),xn(e),l&8192){if(G=e.memoizedState!==null,(e.stateNode.isHidden=G)&&!ie&&(e.mode&1)!==0)for(ve=e,ie=e.child;ie!==null;){for(le=ve=ie;ve!==null;){switch(re=ve,ye=re.child,re.tag){case 0:case 11:case 14:case 15:Us(4,re,re.return);break;case 1:es(re,re.return);var be=re.stateNode;if(typeof be.componentWillUnmount=="function"){l=re,i=re.return;try{t=l,be.props=t.memoizedProps,be.state=t.memoizedState,be.componentWillUnmount()}catch(Se){at(l,i,Se)}}break;case 5:es(re,re.return);break;case 22:if(re.memoizedState!==null){Wd(le);continue}}ye!==null?(ye.return=re,ve=ye):Wd(le)}ie=ie.sibling}e:for(ie=null,le=e;;){if(le.tag===5){if(ie===null){ie=le;try{d=le.stateNode,G?(m=d.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none"):(j=le.stateNode,T=le.memoizedProps.style,x=T!=null&&T.hasOwnProperty("display")?T.display:null,j.style.display=yt("display",x))}catch(Se){at(e,e.return,Se)}}}else if(le.tag===6){if(ie===null)try{le.stateNode.nodeValue=G?"":le.memoizedProps}catch(Se){at(e,e.return,Se)}}else if((le.tag!==22&&le.tag!==23||le.memoizedState===null||le===e)&&le.child!==null){le.child.return=le,le=le.child;continue}if(le===e)break e;for(;le.sibling===null;){if(le.return===null||le.return===e)break e;ie===le&&(ie=null),le=le.return}ie===le&&(ie=null),le.sibling.return=le.return,le=le.sibling}}break;case 19:cn(t,e),xn(e),l&4&&$d(e);break;case 21:break;default:cn(t,e),xn(e)}}function xn(e){var t=e.flags;if(t&2){try{e:{for(var i=e.return;i!==null;){if(Od(i)){var l=i;break e}i=i.return}throw Error(s(160))}switch(l.tag){case 5:var d=l.stateNode;l.flags&32&&(Ke(d,""),l.flags&=-33);var m=Fd(e);fl(e,m,d);break;case 3:case 4:var x=l.stateNode.containerInfo,j=Fd(e);dl(e,j,x);break;default:throw Error(s(161))}}catch(T){at(e,e.return,T)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function eg(e,t,i){ve=e,Ud(e)}function Ud(e,t,i){for(var l=(e.mode&1)!==0;ve!==null;){var d=ve,m=d.child;if(d.tag===22&&l){var x=d.memoizedState!==null||qi;if(!x){var j=d.alternate,T=j!==null&&j.memoizedState!==null||jt;j=qi;var G=jt;if(qi=x,(jt=T)&&!G)for(ve=d;ve!==null;)x=ve,T=x.child,x.tag===22&&x.memoizedState!==null?Vd(d):T!==null?(T.return=x,ve=T):Vd(d);for(;m!==null;)ve=m,Ud(m),m=m.sibling;ve=d,qi=j,jt=G}Hd(e)}else(d.subtreeFlags&8772)!==0&&m!==null?(m.return=d,ve=m):Hd(e)}}function Hd(e){for(;ve!==null;){var t=ve;if((t.flags&8772)!==0){var i=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:jt||Zi(5,t);break;case 1:var l=t.stateNode;if(t.flags&4&&!jt)if(i===null)l.componentDidMount();else{var d=t.elementType===t.type?i.memoizedProps:an(t.type,i.memoizedProps);l.componentDidUpdate(d,i.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var m=t.updateQueue;m!==null&&Wu(t,m,l);break;case 3:var x=t.updateQueue;if(x!==null){if(i=null,t.child!==null)switch(t.child.tag){case 5:i=t.child.stateNode;break;case 1:i=t.child.stateNode}Wu(t,x,i)}break;case 5:var j=t.stateNode;if(i===null&&t.flags&4){i=j;var T=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":T.autoFocus&&i.focus();break;case"img":T.src&&(i.src=T.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var G=t.alternate;if(G!==null){var ie=G.memoizedState;if(ie!==null){var le=ie.dehydrated;le!==null&&ws(le)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}jt||t.flags&512&&ul(t)}catch(re){at(t,t.return,re)}}if(t===e){ve=null;break}if(i=t.sibling,i!==null){i.return=t.return,ve=i;break}ve=t.return}}function Wd(e){for(;ve!==null;){var t=ve;if(t===e){ve=null;break}var i=t.sibling;if(i!==null){i.return=t.return,ve=i;break}ve=t.return}}function Vd(e){for(;ve!==null;){var t=ve;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{Zi(4,t)}catch(T){at(t,i,T)}break;case 1:var l=t.stateNode;if(typeof l.componentDidMount=="function"){var d=t.return;try{l.componentDidMount()}catch(T){at(t,d,T)}}var m=t.return;try{ul(t)}catch(T){at(t,m,T)}break;case 5:var x=t.return;try{ul(t)}catch(T){at(t,x,T)}}}catch(T){at(t,t.return,T)}if(t===e){ve=null;break}var j=t.sibling;if(j!==null){j.return=t.return,ve=j;break}ve=t.return}}var tg=Math.ceil,Ji=D.ReactCurrentDispatcher,pl=D.ReactCurrentOwner,en=D.ReactCurrentBatchConfig,De=0,xt=null,dt=null,St=0,Yt=0,ts=Kn(0),mt=0,Hs=null,Nr=0,eo=0,hl=0,Ws=null,Ot=null,ml=0,ns=1/0,Pn=null,to=!1,gl=null,er=null,no=!1,tr=null,ro=0,Vs=0,yl=null,so=-1,io=0;function Tt(){return(De&6)!==0?lt():so!==-1?so:so=lt()}function nr(e){return(e.mode&1)===0?1:(De&2)!==0&&St!==0?St&-St:Fm.transition!==null?(io===0&&(io=Fc()),io):(e=Ue,e!==0||(e=window.event,e=e===void 0?16:Yc(e.type)),e)}function un(e,t,i,l){if(50<Vs)throw Vs=0,yl=null,Error(s(185));ms(e,i,l),((De&2)===0||e!==xt)&&(e===xt&&((De&2)===0&&(eo|=i),mt===4&&rr(e,St)),Ft(e,l),i===1&&De===0&&(t.mode&1)===0&&(ns=lt()+500,Ai&&Qn()))}function Ft(e,t){var i=e.callbackNode;Fh(e,t);var l=hi(e,e===xt?St:0);if(l===0)i!==null&&Rc(i),e.callbackNode=null,e.callbackPriority=0;else if(t=l&-l,e.callbackPriority!==t){if(i!=null&&Rc(i),t===1)e.tag===0?Om(Yd.bind(null,e)):Tu(Yd.bind(null,e)),Am(function(){(De&6)===0&&Qn()}),i=null;else{switch(Dc(l)){case 1:i=Qo;break;case 4:i=zc;break;case 16:i=ui;break;case 536870912:i=Oc;break;default:i=ui}i=tf(i,Gd.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function Gd(e,t){if(so=-1,io=0,(De&6)!==0)throw Error(s(327));var i=e.callbackNode;if(rs()&&e.callbackNode!==i)return null;var l=hi(e,e===xt?St:0);if(l===0)return null;if((l&30)!==0||(l&e.expiredLanes)!==0||t)t=oo(e,l);else{t=l;var d=De;De|=2;var m=Xd();(xt!==e||St!==t)&&(Pn=null,ns=lt()+500,Er(e,t));do try{sg();break}catch(j){Kd(e,j)}while(!0);Ra(),Ji.current=m,De=d,dt!==null?t=0:(xt=null,St=0,t=mt)}if(t!==0){if(t===2&&(d=qo(e),d!==0&&(l=d,t=vl(e,d))),t===1)throw i=Hs,Er(e,0),rr(e,l),Ft(e,lt()),i;if(t===6)rr(e,l);else{if(d=e.current.alternate,(l&30)===0&&!ng(d)&&(t=oo(e,l),t===2&&(m=qo(e),m!==0&&(l=m,t=vl(e,m))),t===1))throw i=Hs,Er(e,0),rr(e,l),Ft(e,lt()),i;switch(e.finishedWork=d,e.finishedLanes=l,t){case 0:case 1:throw Error(s(345));case 2:Cr(e,Ot,Pn);break;case 3:if(rr(e,l),(l&130023424)===l&&(t=ml+500-lt(),10<t)){if(hi(e,0)!==0)break;if(d=e.suspendedLanes,(d&l)!==l){Tt(),e.pingedLanes|=e.suspendedLanes&d;break}e.timeoutHandle=Na(Cr.bind(null,e,Ot,Pn),t);break}Cr(e,Ot,Pn);break;case 4:if(rr(e,l),(l&4194240)===l)break;for(t=e.eventTimes,d=-1;0<l;){var x=31-rn(l);m=1<<x,x=t[x],x>d&&(d=x),l&=~m}if(l=d,l=lt()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*tg(l/1960))-l,10<l){e.timeoutHandle=Na(Cr.bind(null,e,Ot,Pn),l);break}Cr(e,Ot,Pn);break;case 5:Cr(e,Ot,Pn);break;default:throw Error(s(329))}}}return Ft(e,lt()),e.callbackNode===i?Gd.bind(null,e):null}function vl(e,t){var i=Ws;return e.current.memoizedState.isDehydrated&&(Er(e,t).flags|=256),e=oo(e,t),e!==2&&(t=Ot,Ot=i,t!==null&&xl(t)),e}function xl(e){Ot===null?Ot=e:Ot.push.apply(Ot,e)}function ng(e){for(var t=e;;){if(t.flags&16384){var i=t.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var l=0;l<i.length;l++){var d=i[l],m=d.getSnapshot;d=d.value;try{if(!sn(m(),d))return!1}catch{return!1}}}if(i=t.child,t.subtreeFlags&16384&&i!==null)i.return=t,t=i;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function rr(e,t){for(t&=~hl,t&=~eo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-rn(t),l=1<<i;e[i]=-1,t&=~l}}function Yd(e){if((De&6)!==0)throw Error(s(327));rs();var t=hi(e,0);if((t&1)===0)return Ft(e,lt()),null;var i=oo(e,t);if(e.tag!==0&&i===2){var l=qo(e);l!==0&&(t=l,i=vl(e,l))}if(i===1)throw i=Hs,Er(e,0),rr(e,t),Ft(e,lt()),i;if(i===6)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Cr(e,Ot,Pn),Ft(e,lt()),null}function wl(e,t){var i=De;De|=1;try{return e(t)}finally{De=i,De===0&&(ns=lt()+500,Ai&&Qn())}}function _r(e){tr!==null&&tr.tag===0&&(De&6)===0&&rs();var t=De;De|=1;var i=en.transition,l=Ue;try{if(en.transition=null,Ue=1,e)return e()}finally{Ue=l,en.transition=i,De=t,(De&6)===0&&Qn()}}function bl(){Yt=ts.current,Qe(ts)}function Er(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,Tm(i)),dt!==null)for(i=dt.return;i!==null;){var l=i;switch(Ma(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&Pi();break;case 3:Zr(),Qe(Lt),Qe(Et),Ha();break;case 5:Ba(l);break;case 4:Zr();break;case 13:Qe(rt);break;case 19:Qe(rt);break;case 10:za(l.type._context);break;case 22:case 23:bl()}i=i.return}if(xt=e,dt=e=sr(e.current,null),St=Yt=t,mt=0,Hs=null,hl=eo=Nr=0,Ot=Ws=null,br!==null){for(t=0;t<br.length;t++)if(i=br[t],l=i.interleaved,l!==null){i.interleaved=null;var d=l.next,m=i.pending;if(m!==null){var x=m.next;m.next=d,l.next=x}i.pending=l}br=null}return e}function Kd(e,t){do{var i=dt;try{if(Ra(),Hi.current=Yi,Wi){for(var l=st.memoizedState;l!==null;){var d=l.queue;d!==null&&(d.pending=null),l=l.next}Wi=!1}if(Sr=0,vt=ht=st=null,Os=!1,Fs=0,pl.current=null,i===null||i.return===null){mt=1,Hs=t,dt=null;break}e:{var m=e,x=i.return,j=i,T=t;if(t=St,j.flags|=32768,T!==null&&typeof T=="object"&&typeof T.then=="function"){var G=T,ie=j,le=ie.tag;if((ie.mode&1)===0&&(le===0||le===11||le===15)){var re=ie.alternate;re?(ie.updateQueue=re.updateQueue,ie.memoizedState=re.memoizedState,ie.lanes=re.lanes):(ie.updateQueue=null,ie.memoizedState=null)}var ye=xd(x);if(ye!==null){ye.flags&=-257,wd(ye,x,j,m,t),ye.mode&1&&vd(m,G,t),t=ye,T=G;var be=t.updateQueue;if(be===null){var Se=new Set;Se.add(T),t.updateQueue=Se}else be.add(T);break e}else{if((t&1)===0){vd(m,G,t),kl();break e}T=Error(s(426))}}else if(tt&&j.mode&1){var ct=xd(x);if(ct!==null){(ct.flags&65536)===0&&(ct.flags|=256),wd(ct,x,j,m,t),Aa(Jr(T,j));break e}}m=T=Jr(T,j),mt!==4&&(mt=2),Ws===null?Ws=[m]:Ws.push(m),m=x;do{switch(m.tag){case 3:m.flags|=65536,t&=-t,m.lanes|=t;var $=gd(m,T,t);Hu(m,$);break e;case 1:j=T;var R=m.type,U=m.stateNode;if((m.flags&128)===0&&(typeof R.getDerivedStateFromError=="function"||U!==null&&typeof U.componentDidCatch=="function"&&(er===null||!er.has(U)))){m.flags|=65536,t&=-t,m.lanes|=t;var de=yd(m,j,t);Hu(m,de);break e}}m=m.return}while(m!==null)}qd(i)}catch(Ne){t=Ne,dt===i&&i!==null&&(dt=i=i.return);continue}break}while(!0)}function Xd(){var e=Ji.current;return Ji.current=Yi,e===null?Yi:e}function kl(){(mt===0||mt===3||mt===2)&&(mt=4),xt===null||(Nr&268435455)===0&&(eo&268435455)===0||rr(xt,St)}function oo(e,t){var i=De;De|=2;var l=Xd();(xt!==e||St!==t)&&(Pn=null,Er(e,t));do try{rg();break}catch(d){Kd(e,d)}while(!0);if(Ra(),De=i,Ji.current=l,dt!==null)throw Error(s(261));return xt=null,St=0,mt}function rg(){for(;dt!==null;)Qd(dt)}function sg(){for(;dt!==null&&!jh();)Qd(dt)}function Qd(e){var t=ef(e.alternate,e,Yt);e.memoizedProps=e.pendingProps,t===null?qd(e):dt=t,pl.current=null}function qd(e){var t=e;do{var i=t.alternate;if(e=t.return,(t.flags&32768)===0){if(i=Qm(i,t,Yt),i!==null){dt=i;return}}else{if(i=qm(i,t),i!==null){i.flags&=32767,dt=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{mt=6,dt=null;return}}if(t=t.sibling,t!==null){dt=t;return}dt=t=e}while(t!==null);mt===0&&(mt=5)}function Cr(e,t,i){var l=Ue,d=en.transition;try{en.transition=null,Ue=1,ig(e,t,i,l)}finally{en.transition=d,Ue=l}return null}function ig(e,t,i,l){do rs();while(tr!==null);if((De&6)!==0)throw Error(s(327));i=e.finishedWork;var d=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var m=i.lanes|i.childLanes;if(Dh(e,m),e===xt&&(dt=xt=null,St=0),(i.subtreeFlags&2064)===0&&(i.flags&2064)===0||no||(no=!0,tf(ui,function(){return rs(),null})),m=(i.flags&15990)!==0,(i.subtreeFlags&15990)!==0||m){m=en.transition,en.transition=null;var x=Ue;Ue=1;var j=De;De|=4,pl.current=null,Jm(e,i),Bd(i,e),_m(ka),yi=!!ba,ka=ba=null,e.current=i,eg(i),Mh(),De=j,Ue=x,en.transition=m}else e.current=i;if(no&&(no=!1,tr=e,ro=d),m=e.pendingLanes,m===0&&(er=null),Ah(i.stateNode),Ft(e,lt()),t!==null)for(l=e.onRecoverableError,i=0;i<t.length;i++)d=t[i],l(d.value,{componentStack:d.stack,digest:d.digest});if(to)throw to=!1,e=gl,gl=null,e;return(ro&1)!==0&&e.tag!==0&&rs(),m=e.pendingLanes,(m&1)!==0?e===yl?Vs++:(Vs=0,yl=e):Vs=0,Qn(),null}function rs(){if(tr!==null){var e=Dc(ro),t=en.transition,i=Ue;try{if(en.transition=null,Ue=16>e?16:e,tr===null)var l=!1;else{if(e=tr,tr=null,ro=0,(De&6)!==0)throw Error(s(331));var d=De;for(De|=4,ve=e.current;ve!==null;){var m=ve,x=m.child;if((ve.flags&16)!==0){var j=m.deletions;if(j!==null){for(var T=0;T<j.length;T++){var G=j[T];for(ve=G;ve!==null;){var ie=ve;switch(ie.tag){case 0:case 11:case 15:Us(8,ie,m)}var le=ie.child;if(le!==null)le.return=ie,ve=le;else for(;ve!==null;){ie=ve;var re=ie.sibling,ye=ie.return;if(zd(ie),ie===G){ve=null;break}if(re!==null){re.return=ye,ve=re;break}ve=ye}}}var be=m.alternate;if(be!==null){var Se=be.child;if(Se!==null){be.child=null;do{var ct=Se.sibling;Se.sibling=null,Se=ct}while(Se!==null)}}ve=m}}if((m.subtreeFlags&2064)!==0&&x!==null)x.return=m,ve=x;else e:for(;ve!==null;){if(m=ve,(m.flags&2048)!==0)switch(m.tag){case 0:case 11:case 15:Us(9,m,m.return)}var $=m.sibling;if($!==null){$.return=m.return,ve=$;break e}ve=m.return}}var R=e.current;for(ve=R;ve!==null;){x=ve;var U=x.child;if((x.subtreeFlags&2064)!==0&&U!==null)U.return=x,ve=U;else e:for(x=R;ve!==null;){if(j=ve,(j.flags&2048)!==0)try{switch(j.tag){case 0:case 11:case 15:Zi(9,j)}}catch(Ne){at(j,j.return,Ne)}if(j===x){ve=null;break e}var de=j.sibling;if(de!==null){de.return=j.return,ve=de;break e}ve=j.return}}if(De=d,Qn(),mn&&typeof mn.onPostCommitFiberRoot=="function")try{mn.onPostCommitFiberRoot(di,e)}catch{}l=!0}return l}finally{Ue=i,en.transition=t}}return!1}function Zd(e,t,i){t=Jr(i,t),t=gd(e,t,1),e=Zn(e,t,1),t=Tt(),e!==null&&(ms(e,1,t),Ft(e,t))}function at(e,t,i){if(e.tag===3)Zd(e,e,i);else for(;t!==null;){if(t.tag===3){Zd(t,e,i);break}else if(t.tag===1){var l=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(er===null||!er.has(l))){e=Jr(i,e),e=yd(t,e,1),t=Zn(t,e,1),e=Tt(),t!==null&&(ms(t,1,e),Ft(t,e));break}}t=t.return}}function og(e,t,i){var l=e.pingCache;l!==null&&l.delete(t),t=Tt(),e.pingedLanes|=e.suspendedLanes&i,xt===e&&(St&i)===i&&(mt===4||mt===3&&(St&130023424)===St&&500>lt()-ml?Er(e,0):hl|=i),Ft(e,t)}function Jd(e,t){t===0&&((e.mode&1)===0?t=1:(t=pi,pi<<=1,(pi&130023424)===0&&(pi=4194304)));var i=Tt();e=In(e,t),e!==null&&(ms(e,t,i),Ft(e,i))}function ag(e){var t=e.memoizedState,i=0;t!==null&&(i=t.retryLane),Jd(e,i)}function lg(e,t){var i=0;switch(e.tag){case 13:var l=e.stateNode,d=e.memoizedState;d!==null&&(i=d.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(s(314))}l!==null&&l.delete(t),Jd(e,i)}var ef;ef=function(e,t,i){if(e!==null)if(e.memoizedProps!==t.pendingProps||Lt.current)zt=!0;else{if((e.lanes&i)===0&&(t.flags&128)===0)return zt=!1,Xm(e,t,i);zt=(e.flags&131072)!==0}else zt=!1,tt&&(t.flags&1048576)!==0&&Au(t,Ri,t.index);switch(t.lanes=0,t.tag){case 2:var l=t.type;Qi(e,t),e=t.pendingProps;var d=Vr(t,Et.current);qr(t,i),d=Ga(null,t,l,e,d,i);var m=Ya();return t.flags|=1,typeof d=="object"&&d!==null&&typeof d.render=="function"&&d.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Rt(l)?(m=!0,Ti(t)):m=!1,t.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,Da(t),d.updater=Ki,t.stateNode=d,d._reactInternals=t,Ja(t,l,e,i),t=rl(null,t,l,!0,m,i)):(t.tag=0,tt&&m&&ja(t),Pt(null,t,d,i),t=t.child),t;case 16:l=t.elementType;e:{switch(Qi(e,t),e=t.pendingProps,d=l._init,l=d(l._payload),t.type=l,d=t.tag=ug(l),e=an(l,e),d){case 0:t=nl(null,t,l,e,i);break e;case 1:t=Ed(null,t,l,e,i);break e;case 11:t=bd(null,t,l,e,i);break e;case 14:t=kd(null,t,l,an(l.type,e),i);break e}throw Error(s(306,l,""))}return t;case 0:return l=t.type,d=t.pendingProps,d=t.elementType===l?d:an(l,d),nl(e,t,l,d,i);case 1:return l=t.type,d=t.pendingProps,d=t.elementType===l?d:an(l,d),Ed(e,t,l,d,i);case 3:e:{if(Cd(t),e===null)throw Error(s(387));l=t.pendingProps,m=t.memoizedState,d=m.element,Uu(e,t),Bi(t,l,null,i);var x=t.memoizedState;if(l=x.element,m.isDehydrated)if(m={element:l,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},t.updateQueue.baseState=m,t.memoizedState=m,t.flags&256){d=Jr(Error(s(423)),t),t=Id(e,t,l,i,d);break e}else if(l!==d){d=Jr(Error(s(424)),t),t=Id(e,t,l,i,d);break e}else for(Gt=Yn(t.stateNode.containerInfo.firstChild),Vt=t,tt=!0,on=null,i=$u(t,null,l,i),t.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Kr(),l===d){t=Mn(e,t,i);break e}Pt(e,t,l,i)}t=t.child}return t;case 5:return Vu(t),e===null&&Ta(t),l=t.type,d=t.pendingProps,m=e!==null?e.memoizedProps:null,x=d.children,Sa(l,d)?x=null:m!==null&&Sa(l,m)&&(t.flags|=32),_d(e,t),Pt(e,t,x,i),t.child;case 6:return e===null&&Ta(t),null;case 13:return jd(e,t,i);case 4:return $a(t,t.stateNode.containerInfo),l=t.pendingProps,e===null?t.child=Xr(t,null,l,i):Pt(e,t,l,i),t.child;case 11:return l=t.type,d=t.pendingProps,d=t.elementType===l?d:an(l,d),bd(e,t,l,d,i);case 7:return Pt(e,t,t.pendingProps,i),t.child;case 8:return Pt(e,t,t.pendingProps.children,i),t.child;case 12:return Pt(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(l=t.type._context,d=t.pendingProps,m=t.memoizedProps,x=d.value,Ve(Fi,l._currentValue),l._currentValue=x,m!==null)if(sn(m.value,x)){if(m.children===d.children&&!Lt.current){t=Mn(e,t,i);break e}}else for(m=t.child,m!==null&&(m.return=t);m!==null;){var j=m.dependencies;if(j!==null){x=m.child;for(var T=j.firstContext;T!==null;){if(T.context===l){if(m.tag===1){T=jn(-1,i&-i),T.tag=2;var G=m.updateQueue;if(G!==null){G=G.shared;var ie=G.pending;ie===null?T.next=T:(T.next=ie.next,ie.next=T),G.pending=T}}m.lanes|=i,T=m.alternate,T!==null&&(T.lanes|=i),Oa(m.return,i,t),j.lanes|=i;break}T=T.next}}else if(m.tag===10)x=m.type===t.type?null:m.child;else if(m.tag===18){if(x=m.return,x===null)throw Error(s(341));x.lanes|=i,j=x.alternate,j!==null&&(j.lanes|=i),Oa(x,i,t),x=m.sibling}else x=m.child;if(x!==null)x.return=m;else for(x=m;x!==null;){if(x===t){x=null;break}if(m=x.sibling,m!==null){m.return=x.return,x=m;break}x=x.return}m=x}Pt(e,t,d.children,i),t=t.child}return t;case 9:return d=t.type,l=t.pendingProps.children,qr(t,i),d=Zt(d),l=l(d),t.flags|=1,Pt(e,t,l,i),t.child;case 14:return l=t.type,d=an(l,t.pendingProps),d=an(l.type,d),kd(e,t,l,d,i);case 15:return Sd(e,t,t.type,t.pendingProps,i);case 17:return l=t.type,d=t.pendingProps,d=t.elementType===l?d:an(l,d),Qi(e,t),t.tag=1,Rt(l)?(e=!0,Ti(t)):e=!1,qr(t,i),hd(t,l,d),Ja(t,l,d,i),rl(null,t,l,!0,e,i);case 19:return Pd(e,t,i);case 22:return Nd(e,t,i)}throw Error(s(156,t.tag))};function tf(e,t){return Lc(e,t)}function cg(e,t,i,l){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tn(e,t,i,l){return new cg(e,t,i,l)}function Sl(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ug(e){if(typeof e=="function")return Sl(e)?1:0;if(e!=null){if(e=e.$$typeof,e===W)return 11;if(e===he)return 14}return 2}function sr(e,t){var i=e.alternate;return i===null?(i=tn(e.tag,t,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function ao(e,t,i,l,d,m){var x=2;if(l=e,typeof e=="function")Sl(e)&&(x=1);else if(typeof e=="string")x=5;else e:switch(e){case H:return Ir(i.children,d,m,t);case q:x=8,d|=8;break;case te:return e=tn(12,i,t,d|2),e.elementType=te,e.lanes=m,e;case ae:return e=tn(13,i,t,d),e.elementType=ae,e.lanes=m,e;case ee:return e=tn(19,i,t,d),e.elementType=ee,e.lanes=m,e;case ce:return lo(i,d,m,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case K:x=10;break e;case z:x=9;break e;case W:x=11;break e;case he:x=14;break e;case Z:x=16,l=null;break e}throw Error(s(130,e==null?e:typeof e,""))}return t=tn(x,i,t,d),t.elementType=e,t.type=l,t.lanes=m,t}function Ir(e,t,i,l){return e=tn(7,e,l,t),e.lanes=i,e}function lo(e,t,i,l){return e=tn(22,e,l,t),e.elementType=ce,e.lanes=i,e.stateNode={isHidden:!1},e}function Nl(e,t,i){return e=tn(6,e,null,t),e.lanes=i,e}function _l(e,t,i){return t=tn(4,e.children!==null?e.children:[],e.key,t),t.lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function dg(e,t,i,l,d){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zo(0),this.expirationTimes=Zo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zo(0),this.identifierPrefix=l,this.onRecoverableError=d,this.mutableSourceEagerHydrationData=null}function El(e,t,i,l,d,m,x,j,T){return e=new dg(e,t,i,j,T),t===1?(t=1,m===!0&&(t|=8)):t=0,m=tn(3,null,null,t),e.current=m,m.stateNode=e,m.memoizedState={element:l,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Da(m),e}function fg(e,t,i){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:F,key:l==null?null:""+l,children:e,containerInfo:t,implementation:i}}function nf(e){if(!e)return Xn;e=e._reactInternals;e:{if(gr(e)!==e||e.tag!==1)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Rt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(s(171))}if(e.tag===1){var i=e.type;if(Rt(i))return Mu(e,i,t)}return t}function rf(e,t,i,l,d,m,x,j,T){return e=El(i,l,!0,e,d,m,x,j,T),e.context=nf(null),i=e.current,l=Tt(),d=nr(i),m=jn(l,d),m.callback=t??null,Zn(i,m,d),e.current.lanes=d,ms(e,d,l),Ft(e,l),e}function co(e,t,i,l){var d=t.current,m=Tt(),x=nr(d);return i=nf(i),t.context===null?t.context=i:t.pendingContext=i,t=jn(m,x),t.payload={element:e},l=l===void 0?null:l,l!==null&&(t.callback=l),e=Zn(d,t,x),e!==null&&(un(e,d,x,m),$i(e,d,x)),x}function uo(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function sf(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<t?i:t}}function Cl(e,t){sf(e,t),(e=e.alternate)&&sf(e,t)}function pg(){return null}var of=typeof reportError=="function"?reportError:function(e){console.error(e)};function Il(e){this._internalRoot=e}fo.prototype.render=Il.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(s(409));co(e,t,null,null)},fo.prototype.unmount=Il.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;_r(function(){co(null,e,null,null)}),t[Nn]=null}};function fo(e){this._internalRoot=e}fo.prototype.unstable_scheduleHydration=function(e){if(e){var t=Uc();e={blockedOn:null,target:e,priority:t};for(var i=0;i<Wn.length&&t!==0&&t<Wn[i].priority;i++);Wn.splice(i,0,e),i===0&&Vc(e)}};function jl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function po(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function af(){}function hg(e,t,i,l,d){if(d){if(typeof l=="function"){var m=l;l=function(){var G=uo(x);m.call(G)}}var x=rf(t,l,e,0,null,!1,!1,"",af);return e._reactRootContainer=x,e[Nn]=x.current,js(e.nodeType===8?e.parentNode:e),_r(),x}for(;d=e.lastChild;)e.removeChild(d);if(typeof l=="function"){var j=l;l=function(){var G=uo(T);j.call(G)}}var T=El(e,0,!1,null,null,!1,!1,"",af);return e._reactRootContainer=T,e[Nn]=T.current,js(e.nodeType===8?e.parentNode:e),_r(function(){co(t,T,i,l)}),T}function ho(e,t,i,l,d){var m=i._reactRootContainer;if(m){var x=m;if(typeof d=="function"){var j=d;d=function(){var T=uo(x);j.call(T)}}co(t,x,e,d)}else x=hg(i,t,e,d,l);return uo(x)}$c=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=hs(t.pendingLanes);i!==0&&(Jo(t,i|1),Ft(t,lt()),(De&6)===0&&(ns=lt()+500,Qn()))}break;case 13:_r(function(){var l=In(e,1);if(l!==null){var d=Tt();un(l,e,1,d)}}),Cl(e,1)}},ea=function(e){if(e.tag===13){var t=In(e,134217728);if(t!==null){var i=Tt();un(t,e,134217728,i)}Cl(e,134217728)}},Bc=function(e){if(e.tag===13){var t=nr(e),i=In(e,t);if(i!==null){var l=Tt();un(i,e,t,l)}Cl(e,t)}},Uc=function(){return Ue},Hc=function(e,t){var i=Ue;try{return Ue=e,t()}finally{Ue=i}},We=function(e,t,i){switch(t){case"input":if(we(e,i),t=i.name,i.type==="radio"&&t!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var l=i[t];if(l!==e&&l.form===e.form){var d=Mi(l);if(!d)throw Error(s(90));ue(l),we(l,d)}}}break;case"textarea":Je(e,i);break;case"select":t=i.value,t!=null&&it(e,!!i.multiple,t,!1)}},_t=wl,ai=_r;var mg={usingClientEntryPoint:!1,Events:[Ts,Hr,Mi,hn,At,wl]},Gs={findFiberByHostInstance:yr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},gg={bundleType:Gs.bundleType,version:Gs.version,rendererPackageName:Gs.rendererPackageName,rendererConfig:Gs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:D.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Tc(e),e===null?null:e.stateNode},findFiberByHostInstance:Gs.findFiberByHostInstance||pg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mo.isDisabled&&mo.supportsFiber)try{di=mo.inject(gg),mn=mo}catch{}}return Dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mg,Dt.createPortal=function(e,t){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jl(t))throw Error(s(200));return fg(e,t,null,i)},Dt.createRoot=function(e,t){if(!jl(e))throw Error(s(299));var i=!1,l="",d=of;return t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(l=t.identifierPrefix),t.onRecoverableError!==void 0&&(d=t.onRecoverableError)),t=El(e,1,!1,null,null,i,!1,l,d),e[Nn]=t.current,js(e.nodeType===8?e.parentNode:e),new Il(t)},Dt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=Tc(t),e=e===null?null:e.stateNode,e},Dt.flushSync=function(e){return _r(e)},Dt.hydrate=function(e,t,i){if(!po(t))throw Error(s(200));return ho(null,e,t,!0,i)},Dt.hydrateRoot=function(e,t,i){if(!jl(e))throw Error(s(405));var l=i!=null&&i.hydratedSources||null,d=!1,m="",x=of;if(i!=null&&(i.unstable_strictMode===!0&&(d=!0),i.identifierPrefix!==void 0&&(m=i.identifierPrefix),i.onRecoverableError!==void 0&&(x=i.onRecoverableError)),t=rf(t,null,e,1,i??null,d,!1,m,x),e[Nn]=t.current,js(e),l)for(e=0;e<l.length;e++)i=l[e],d=i._getVersion,d=d(i._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[i,d]:t.mutableSourceEagerHydrationData.push(i,d);return new fo(t)},Dt.render=function(e,t,i){if(!po(t))throw Error(s(200));return ho(null,e,t,!1,i)},Dt.unmountComponentAtNode=function(e){if(!po(e))throw Error(s(40));return e._reactRootContainer?(_r(function(){ho(null,null,e,!1,function(){e._reactRootContainer=null,e[Nn]=null})}),!0):!1},Dt.unstable_batchedUpdates=wl,Dt.unstable_renderSubtreeIntoContainer=function(e,t,i,l){if(!po(i))throw Error(s(200));if(e==null||e._reactInternals===void 0)throw Error(s(38));return ho(e,t,i,!1,l)},Dt.version="18.3.1-next-f1338f8080-20240426",Dt}var gf;function vp(){if(gf)return Tl.exports;gf=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(n){console.error(n)}}return r(),Tl.exports=Ig(),Tl.exports}var yf;function jg(){if(yf)return go;yf=1;var r=vp();return go.createRoot=r.createRoot,go.hydrateRoot=r.hydrateRoot,go}var Mg=jg();const Pg=yp(Mg);var N=ac();const Ge=yp(N);function xp(r){var n,s,o="";if(typeof r=="string"||typeof r=="number")o+=r;else if(typeof r=="object")if(Array.isArray(r)){var a=r.length;for(n=0;n<a;n++)r[n]&&(s=xp(r[n]))&&(o&&(o+=" "),o+=s)}else for(s in r)r[s]&&(o&&(o+=" "),o+=s);return o}function Tg(){for(var r,n,s=0,o="",a=arguments.length;s<a;s++)(r=arguments[s])&&(n=xp(r))&&(o&&(o+=" "),o+=n);return o}const lc="-",Ag=r=>{const n=Rg(r),{conflictingClassGroups:s,conflictingClassGroupModifiers:o}=r;return{getClassGroupId:f=>{const c=f.split(lc);return c[0]===""&&c.length!==1&&c.shift(),wp(c,n)||Lg(f)},getConflictingClassGroupIds:(f,c)=>{const p=s[f]||[];return c&&o[f]?[...p,...o[f]]:p}}},wp=(r,n)=>{if(r.length===0)return n.classGroupId;const s=r[0],o=n.nextPart.get(s),a=o?wp(r.slice(1),o):void 0;if(a)return a;if(n.validators.length===0)return;const u=r.join(lc);return n.validators.find(({validator:f})=>f(u))?.classGroupId},vf=/^\[(.+)\]$/,Lg=r=>{if(vf.test(r)){const n=vf.exec(r)[1],s=n?.substring(0,n.indexOf(":"));if(s)return"arbitrary.."+s}},Rg=r=>{const{theme:n,prefix:s}=r,o={nextPart:new Map,validators:[]};return Og(Object.entries(r.classGroups),s).forEach(([u,f])=>{Yl(f,o,u,n)}),o},Yl=(r,n,s,o)=>{r.forEach(a=>{if(typeof a=="string"){const u=a===""?n:xf(n,a);u.classGroupId=s;return}if(typeof a=="function"){if(zg(a)){Yl(a(o),n,s,o);return}n.validators.push({validator:a,classGroupId:s});return}Object.entries(a).forEach(([u,f])=>{Yl(f,xf(n,u),s,o)})})},xf=(r,n)=>{let s=r;return n.split(lc).forEach(o=>{s.nextPart.has(o)||s.nextPart.set(o,{nextPart:new Map,validators:[]}),s=s.nextPart.get(o)}),s},zg=r=>r.isThemeGetter,Og=(r,n)=>n?r.map(([s,o])=>{const a=o.map(u=>typeof u=="string"?n+u:typeof u=="object"?Object.fromEntries(Object.entries(u).map(([f,c])=>[n+f,c])):u);return[s,a]}):r,Fg=r=>{if(r<1)return{get:()=>{},set:()=>{}};let n=0,s=new Map,o=new Map;const a=(u,f)=>{s.set(u,f),n++,n>r&&(n=0,o=s,s=new Map)};return{get(u){let f=s.get(u);if(f!==void 0)return f;if((f=o.get(u))!==void 0)return a(u,f),f},set(u,f){s.has(u)?s.set(u,f):a(u,f)}}},bp="!",Dg=r=>{const{separator:n,experimentalParseClassName:s}=r,o=n.length===1,a=n[0],u=n.length,f=c=>{const p=[];let g=0,y=0,v;for(let C=0;C<c.length;C++){let I=c[C];if(g===0){if(I===a&&(o||c.slice(C,C+u)===n)){p.push(c.slice(y,C)),y=C+u;continue}if(I==="/"){v=C;continue}}I==="["?g++:I==="]"&&g--}const w=p.length===0?c:c.substring(y),S=w.startsWith(bp),k=S?w.substring(1):w,E=v&&v>y?v-y:void 0;return{modifiers:p,hasImportantModifier:S,baseClassName:k,maybePostfixModifierPosition:E}};return s?c=>s({className:c,parseClassName:f}):f},$g=r=>{if(r.length<=1)return r;const n=[];let s=[];return r.forEach(o=>{o[0]==="["?(n.push(...s.sort(),o),s=[]):s.push(o)}),n.push(...s.sort()),n},Bg=r=>({cache:Fg(r.cacheSize),parseClassName:Dg(r),...Ag(r)}),Ug=/\s+/,Hg=(r,n)=>{const{parseClassName:s,getClassGroupId:o,getConflictingClassGroupIds:a}=n,u=[],f=r.trim().split(Ug);let c="";for(let p=f.length-1;p>=0;p-=1){const g=f[p],{modifiers:y,hasImportantModifier:v,baseClassName:w,maybePostfixModifierPosition:S}=s(g);let k=!!S,E=o(k?w.substring(0,S):w);if(!E){if(!k){c=g+(c.length>0?" "+c:c);continue}if(E=o(w),!E){c=g+(c.length>0?" "+c:c);continue}k=!1}const C=$g(y).join(":"),I=v?C+bp:C,b=I+E;if(u.includes(b))continue;u.push(b);const M=a(E,k);for(let D=0;D<M.length;++D){const L=M[D];u.push(I+L)}c=g+(c.length>0?" "+c:c)}return c};function Wg(){let r=0,n,s,o="";for(;r<arguments.length;)(n=arguments[r++])&&(s=kp(n))&&(o&&(o+=" "),o+=s);return o}const kp=r=>{if(typeof r=="string")return r;let n,s="";for(let o=0;o<r.length;o++)r[o]&&(n=kp(r[o]))&&(s&&(s+=" "),s+=n);return s};function Vg(r,...n){let s,o,a,u=f;function f(p){const g=n.reduce((y,v)=>v(y),r());return s=Bg(g),o=s.cache.get,a=s.cache.set,u=c,c(p)}function c(p){const g=o(p);if(g)return g;const y=Hg(p,s);return a(p,y),y}return function(){return u(Wg.apply(null,arguments))}}const qe=r=>{const n=s=>s[r]||[];return n.isThemeGetter=!0,n},Sp=/^\[(?:([a-z-]+):)?(.+)\]$/i,Gg=/^\d+\/\d+$/,Yg=new Set(["px","full","screen"]),Kg=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Xg=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Qg=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,qg=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Zg=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Tn=r=>ls(r)||Yg.has(r)||Gg.test(r),or=r=>fs(r,"length",o0),ls=r=>!!r&&!Number.isNaN(Number(r)),Rl=r=>fs(r,"number",ls),Ks=r=>!!r&&Number.isInteger(Number(r)),Jg=r=>r.endsWith("%")&&ls(r.slice(0,-1)),Le=r=>Sp.test(r),ar=r=>Kg.test(r),e0=new Set(["length","size","percentage"]),t0=r=>fs(r,e0,Np),n0=r=>fs(r,"position",Np),r0=new Set(["image","url"]),s0=r=>fs(r,r0,l0),i0=r=>fs(r,"",a0),Xs=()=>!0,fs=(r,n,s)=>{const o=Sp.exec(r);return o?o[1]?typeof n=="string"?o[1]===n:n.has(o[1]):s(o[2]):!1},o0=r=>Xg.test(r)&&!Qg.test(r),Np=()=>!1,a0=r=>qg.test(r),l0=r=>Zg.test(r),c0=()=>{const r=qe("colors"),n=qe("spacing"),s=qe("blur"),o=qe("brightness"),a=qe("borderColor"),u=qe("borderRadius"),f=qe("borderSpacing"),c=qe("borderWidth"),p=qe("contrast"),g=qe("grayscale"),y=qe("hueRotate"),v=qe("invert"),w=qe("gap"),S=qe("gradientColorStops"),k=qe("gradientColorStopPositions"),E=qe("inset"),C=qe("margin"),I=qe("opacity"),b=qe("padding"),M=qe("saturate"),D=qe("scale"),L=qe("sepia"),F=qe("skew"),H=qe("space"),q=qe("translate"),te=()=>["auto","contain","none"],K=()=>["auto","hidden","clip","visible","scroll"],z=()=>["auto",Le,n],W=()=>[Le,n],ae=()=>["",Tn,or],ee=()=>["auto",ls,Le],he=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Z=()=>["solid","dashed","dotted","double","none"],ce=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],O=()=>["start","end","center","between","around","evenly","stretch"],V=()=>["","0",Le],Y=()=>["auto","avoid","all","avoid-page","page","left","right","column"],P=()=>[ls,Le];return{cacheSize:500,separator:":",theme:{colors:[Xs],spacing:[Tn,or],blur:["none","",ar,Le],brightness:P(),borderColor:[r],borderRadius:["none","","full",ar,Le],borderSpacing:W(),borderWidth:ae(),contrast:P(),grayscale:V(),hueRotate:P(),invert:V(),gap:W(),gradientColorStops:[r],gradientColorStopPositions:[Jg,or],inset:z(),margin:z(),opacity:P(),padding:W(),saturate:P(),scale:P(),sepia:V(),skew:P(),space:W(),translate:W()},classGroups:{aspect:[{aspect:["auto","square","video",Le]}],container:["container"],columns:[{columns:[ar]}],"break-after":[{"break-after":Y()}],"break-before":[{"break-before":Y()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...he(),Le]}],overflow:[{overflow:K()}],"overflow-x":[{"overflow-x":K()}],"overflow-y":[{"overflow-y":K()}],overscroll:[{overscroll:te()}],"overscroll-x":[{"overscroll-x":te()}],"overscroll-y":[{"overscroll-y":te()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[E]}],"inset-x":[{"inset-x":[E]}],"inset-y":[{"inset-y":[E]}],start:[{start:[E]}],end:[{end:[E]}],top:[{top:[E]}],right:[{right:[E]}],bottom:[{bottom:[E]}],left:[{left:[E]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ks,Le]}],basis:[{basis:z()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Le]}],grow:[{grow:V()}],shrink:[{shrink:V()}],order:[{order:["first","last","none",Ks,Le]}],"grid-cols":[{"grid-cols":[Xs]}],"col-start-end":[{col:["auto",{span:["full",Ks,Le]},Le]}],"col-start":[{"col-start":ee()}],"col-end":[{"col-end":ee()}],"grid-rows":[{"grid-rows":[Xs]}],"row-start-end":[{row:["auto",{span:[Ks,Le]},Le]}],"row-start":[{"row-start":ee()}],"row-end":[{"row-end":ee()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Le]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Le]}],gap:[{gap:[w]}],"gap-x":[{"gap-x":[w]}],"gap-y":[{"gap-y":[w]}],"justify-content":[{justify:["normal",...O()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...O(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...O(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[C]}],mx:[{mx:[C]}],my:[{my:[C]}],ms:[{ms:[C]}],me:[{me:[C]}],mt:[{mt:[C]}],mr:[{mr:[C]}],mb:[{mb:[C]}],ml:[{ml:[C]}],"space-x":[{"space-x":[H]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[H]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Le,n]}],"min-w":[{"min-w":[Le,n,"min","max","fit"]}],"max-w":[{"max-w":[Le,n,"none","full","min","max","fit","prose",{screen:[ar]},ar]}],h:[{h:[Le,n,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Le,n,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Le,n,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Le,n,"auto","min","max","fit"]}],"font-size":[{text:["base",ar,or]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Rl]}],"font-family":[{font:[Xs]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Le]}],"line-clamp":[{"line-clamp":["none",ls,Rl]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Tn,Le]}],"list-image":[{"list-image":["none",Le]}],"list-style-type":[{list:["none","disc","decimal",Le]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[I]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[I]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Z(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Tn,or]}],"underline-offset":[{"underline-offset":["auto",Tn,Le]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:W()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Le]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Le]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[I]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...he(),n0]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",t0]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},s0]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[k]}],"gradient-via-pos":[{via:[k]}],"gradient-to-pos":[{to:[k]}],"gradient-from":[{from:[S]}],"gradient-via":[{via:[S]}],"gradient-to":[{to:[S]}],rounded:[{rounded:[u]}],"rounded-s":[{"rounded-s":[u]}],"rounded-e":[{"rounded-e":[u]}],"rounded-t":[{"rounded-t":[u]}],"rounded-r":[{"rounded-r":[u]}],"rounded-b":[{"rounded-b":[u]}],"rounded-l":[{"rounded-l":[u]}],"rounded-ss":[{"rounded-ss":[u]}],"rounded-se":[{"rounded-se":[u]}],"rounded-ee":[{"rounded-ee":[u]}],"rounded-es":[{"rounded-es":[u]}],"rounded-tl":[{"rounded-tl":[u]}],"rounded-tr":[{"rounded-tr":[u]}],"rounded-br":[{"rounded-br":[u]}],"rounded-bl":[{"rounded-bl":[u]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[I]}],"border-style":[{border:[...Z(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[I]}],"divide-style":[{divide:Z()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...Z()]}],"outline-offset":[{"outline-offset":[Tn,Le]}],"outline-w":[{outline:[Tn,or]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:ae()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[I]}],"ring-offset-w":[{"ring-offset":[Tn,or]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",ar,i0]}],"shadow-color":[{shadow:[Xs]}],opacity:[{opacity:[I]}],"mix-blend":[{"mix-blend":[...ce(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ce()}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[o]}],contrast:[{contrast:[p]}],"drop-shadow":[{"drop-shadow":["","none",ar,Le]}],grayscale:[{grayscale:[g]}],"hue-rotate":[{"hue-rotate":[y]}],invert:[{invert:[v]}],saturate:[{saturate:[M]}],sepia:[{sepia:[L]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[o]}],"backdrop-contrast":[{"backdrop-contrast":[p]}],"backdrop-grayscale":[{"backdrop-grayscale":[g]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[y]}],"backdrop-invert":[{"backdrop-invert":[v]}],"backdrop-opacity":[{"backdrop-opacity":[I]}],"backdrop-saturate":[{"backdrop-saturate":[M]}],"backdrop-sepia":[{"backdrop-sepia":[L]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[f]}],"border-spacing-x":[{"border-spacing-x":[f]}],"border-spacing-y":[{"border-spacing-y":[f]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Le]}],duration:[{duration:P()}],ease:[{ease:["linear","in","out","in-out",Le]}],delay:[{delay:P()}],animate:[{animate:["none","spin","ping","pulse","bounce",Le]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[D]}],"scale-x":[{"scale-x":[D]}],"scale-y":[{"scale-y":[D]}],rotate:[{rotate:[Ks,Le]}],"translate-x":[{"translate-x":[q]}],"translate-y":[{"translate-y":[q]}],"skew-x":[{"skew-x":[F]}],"skew-y":[{"skew-y":[F]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Le]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Le]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":W()}],"scroll-mx":[{"scroll-mx":W()}],"scroll-my":[{"scroll-my":W()}],"scroll-ms":[{"scroll-ms":W()}],"scroll-me":[{"scroll-me":W()}],"scroll-mt":[{"scroll-mt":W()}],"scroll-mr":[{"scroll-mr":W()}],"scroll-mb":[{"scroll-mb":W()}],"scroll-ml":[{"scroll-ml":W()}],"scroll-p":[{"scroll-p":W()}],"scroll-px":[{"scroll-px":W()}],"scroll-py":[{"scroll-py":W()}],"scroll-ps":[{"scroll-ps":W()}],"scroll-pe":[{"scroll-pe":W()}],"scroll-pt":[{"scroll-pt":W()}],"scroll-pr":[{"scroll-pr":W()}],"scroll-pb":[{"scroll-pb":W()}],"scroll-pl":[{"scroll-pl":W()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Le]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[Tn,or,Rl]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},u0=Vg(c0);function xe(...r){return u0(Tg(r))}var ke=(r=>(r.RINA="rina",r.SHINO="shino",r))(ke||{});const fn={addiction:{min:0,max:10},obedience:{min:0,max:10},moralScale:{min:0,max:12},corruption:{min:0,max:4}},Xt={basic:{nodeID:0,currPOV:"rina"},meta:{},topFlagState:{currentTime:""},currentEventState:{current:null},portraitFrame:{bodyId:void 0,faceId:void 0,enabledClothingIds:void 0},statusCard:{mood:"",location:"",displayTitle:"",trueTitle:"",fatigue:0,desire:0,will:0,san:0,avatar:void 0},dashboardGauges:{addiction:0,obedience:0,moralScale:0,corruption:0},mainTextBox:{content:"",options:[],mapPosition:{mapId:null,facilityId:null},parseFailed:!1},requestFeatures:{povTarget:null,forceEscapeEvent:!1,encourageLewd:!1,forbidLewd:!1,suppressDespair:!1},detailPanel:{nodes:{}},logPanel:{diaryText:"",todoList:[],amount:0},societyPanel:{regions:{}},timelinePanel:{nodes:[],currentNodeId:null,lockedNodeIds:[]}};function d0(r,n){switch(n.type){case"PATCH_SLICE":{const{slice:s,patch:o}=n;return{...r,[s]:{...r[s],...o}}}case"RESET":return n.state??Xt;default:return r}}const _p=N.createContext(void 0),Ep=N.createContext(void 0);function f0({children:r}){const[n,s]=N.useReducer(d0,Xt);return h.jsx(_p.Provider,{value:n,children:h.jsx(Ep.Provider,{value:s,children:r})})}function p0(){const r=N.useContext(_p);if(!r)throw new Error("useGameState E GameProvider E");return r}function cc(){const r=N.useContext(Ep);if(!r)throw new Error("useGameDispatch E GameProvider E");return r}function pt(r){return p0()[r]}function uc(r){const n=cc();return N.useCallback(s=>{n({type:"PATCH_SLICE",slice:r,patch:s})},[n,r])}const h0=["p1","p2","p3","p4","p5","p6","p7","p8"],m0=["ext1","ext2","ext3","ext4","ext5","ext6","ext7","ext8","ext9","ext10","ext11","ext12","ext13","ext14","ext15","ext16","ext17","ext18"],g0=h0.map((r,n)=>({kind:"built-in",key:r,label:` ${n+1}`,imageUrl:`/images/wallpaper/${r}.webp`})),y0=["https://files.catbox.moe/2s19rt.jpg","https://files.catbox.moe/sg3hla.jpg","https://files.catbox.moe/b6teof.jpg","https://files.catbox.moe/kvd85k.jpg","https://files.catbox.moe/f3y3im.jpg","https://files.catbox.moe/ga7a4q.jpg","https://files.catbox.moe/ci6tc3.jpg","https://files.catbox.moe/sza1xh.jpg","https://files.catbox.moe/50wq6f.jpg","https://files.catbox.moe/gzrj2b.jpg","https://files.catbox.moe/1r6gt8.jpg","https://files.catbox.moe/l5k71d.jpg","https://files.catbox.moe/ncdzfy.jpg","https://files.catbox.moe/f3dyha.jpg","https://files.catbox.moe/sdxgn0.jpg","https://files.catbox.moe/8kzj8b.jpg","https://files.catbox.moe/1vwr4w.jpg","https://files.catbox.moe/9keu2f.jpg"],Cp=m0.map((r,n)=>({kind:"external",key:r,label:` ${n+1}`,downloadUrl:y0[n]})),Ip=[{kind:"built-in",key:"pattern",label:"E},...g0],v0=Ip,Ro=Cp,jp=[...Ip,...Cp],x0="p8",Mp=r=>r.startsWith("real:")?r:`real:${r}`,Kl=new Map,w0=r=>typeof r=="string"&&jp.some(n=>n.key===r),Pp=r=>{const n=jp.find(s=>s.key===r);if(n)return n.kind==="external"?Kl.get(n.key)??Mp(n.downloadUrl):n.imageUrl},wf=(r,n)=>{const s=Mp(n),o=Kl.get(r);if(o&&o.startsWith("real:")){const a=o.slice(5);a.startsWith("blob:")&&URL.revokeObjectURL(a)}Kl.set(r,s)},b0="DISPLAY_SETTINGS",Ln={selectedFont:"naikai",typingEnabled:!1,textOpacity:.7,surfaceOpacity:.7,storyFontSize:1,storyPadding:24,backgroundKey:x0,mobileLayoutStyle:"style2"},k0=["naikai","fzyousong","system"],S0=["style1","style2"],N0=r=>k0.includes(r),_0=r=>S0.includes(r),bf=r=>{const n=Number(r);return Number.isFinite(n)?Math.min(Math.max(n,0),1):Ln.textOpacity},E0=r=>{const n=Number(r);return Number.isFinite(n)?Math.min(Math.max(n,.5),2):Ln.storyFontSize},C0=r=>{const n=Number(r);return Number.isFinite(n)?Math.min(Math.max(n,0),100):Ln.storyPadding};class I0{constructor(n=b0){this.variableKey=n}memorySettings={...Ln};load(){try{if(typeof window.TavernHelper>"u"||!window.TavernHelper.getVariables)return this.memorySettings;const s=window.TavernHelper.getVariables({type:"chat"})?.[this.variableKey],o=this.parseSettings(s);return this.memorySettings=o,o}catch(n){return console.error("[SettingsStorage] Failed to load settings",n),this.memorySettings}}async save(n){const s=this.parseSettings(n);this.memorySettings=s;try{if(typeof window.TavernHelper>"u"||!window.TavernHelper.insertOrAssignVariables)return;await window.TavernHelper.insertOrAssignVariables({[this.variableKey]:s},{type:"chat"})}catch(o){console.error("[SettingsStorage] Failed to save settings",o)}}parseSettings(n){const s=N0(n?.selectedFont)?n?.selectedFont:Ln.selectedFont,o=typeof n?.typingEnabled=="boolean"?n?.typingEnabled:Ln.typingEnabled,a=bf(n?.textOpacity),u=n?.surfaceOpacity!==void 0?bf(n?.surfaceOpacity):Ln.surfaceOpacity,f=E0(n?.storyFontSize),c=C0(n?.storyPadding),p=w0(n?.backgroundKey)?n?.backgroundKey:Ln.backgroundKey,g=_0(n?.mobileLayoutStyle)?n?.mobileLayoutStyle:Ln.mobileLayoutStyle;return{selectedFont:s,typingEnabled:o,textOpacity:a,surfaceOpacity:u,storyFontSize:f,storyPadding:c,backgroundKey:p,mobileLayoutStyle:g}}}const kf=new I0,Tp=N.createContext(null);function j0({children:r}){const[n]=N.useState(()=>kf.load()),[s,o]=N.useState(n.selectedFont),[a,u]=N.useState(n.typingEnabled),[f,c]=N.useState(n.textOpacity),[p,g]=N.useState(n.surfaceOpacity),[y,v]=N.useState(n.storyFontSize),[w,S]=N.useState(n.storyPadding),[k,E]=N.useState(n.backgroundKey),[C,I]=N.useState(n.mobileLayoutStyle);N.useEffect(()=>{const M={selectedFont:s,typingEnabled:a,textOpacity:f,surfaceOpacity:p,storyFontSize:y,storyPadding:w,backgroundKey:k,mobileLayoutStyle:C};kf.save(M).catch(D=>{console.error("[SettingsProvider] Failed to persist settings",D)})},[s,a,f,p,y,w,k,C]);const b=N.useMemo(()=>({selectedFont:s,setSelectedFont:o,typingEnabled:a,setTypingEnabled:u,textOpacity:f,setTextOpacity:c,surfaceOpacity:p,setSurfaceOpacity:g,storyFontSize:y,setStoryFontSize:v,storyPadding:w,setStoryPadding:S,backgroundKey:k,setBackgroundKey:E,mobileLayoutStyle:C,setMobileLayoutStyle:I}),[s,a,f,p,y,w,k,C]);return h.jsx(Tp.Provider,{value:b,children:r})}function ps(){const r=N.useContext(Tp);if(!r)throw new Error("useSettings must be used within a SettingsProvider");return r}const dc=1024,M0=`(max-width: ${dc-1}px)`,fc=N.createContext(null);function P0({children:r}){const{mobileLayoutStyle:n}=ps(),s=Ap(M0),o=s?n==="style1"?"mobile-drawer":"mobile-inline":"desktop",a=N.useMemo(()=>({isNarrow:s,layoutVariant:o,breakpoint:dc,mobileLayoutStyle:n}),[s,o,n]);return h.jsx(fc.Provider,{value:a,children:r})}function si(){const r=N.useContext(fc);if(!r)throw new Error("useLayoutMode must be used within a LayoutModeProvider");return r}function T0(){return N.useContext(fc)}function Ap(r,n={}){const{enabled:s=!0,initialValue:o=!1}=n,[a,u]=N.useState(()=>!s||typeof window>"u"||typeof window.matchMedia>"u"?o:window.matchMedia(r).matches);return N.useEffect(()=>{if(!s||typeof window>"u"||typeof window.matchMedia>"u")return;const f=window.matchMedia(r),c=p=>u(p.matches);return u(f.matches),f.addEventListener("change",c),()=>f.removeEventListener("change",c)},[r,s]),a}function pc({className:r,values:n,variant:s="default"}){const o=n??{addiction:0,obedience:0,moralScale:0,corruption:0},a=s==="rowCompact",{isNarrow:u}=si();return h.jsxs("div",{className:xe("bg-surface border-2 border-mist-300 rounded-xl relative",a?"w-full p-3":"w-45 p-4","paper-texture sticker-card",r),children:[!a&&h.jsx("h3",{className:"font-cpTitle font-semibold text-mist-700 text-center mb-3",children:""}),h.jsxs("div",{className:xe("justify-items-center items-center",a?"grid grid-cols-4 gap-2 sm:gap-3":"grid grid-cols-2 gap-4"),children:[h.jsx(yo,{label:"",compact:a,children:h.jsx(Sf,{value:o.addiction,min:fn.addiction.min,max:fn.addiction.max,colorClass:"text-sakura-500",trackClass:"text-charcoal-300",emoji:"",size:a?"sm":"md"})}),h.jsx(yo,{label:"E,compact:a,children:h.jsx(Nf,{value:o.obedience,min:fn.obedience.min,max:fn.obedience.max,segments:fn.obedience.max,colorClass:"text-lavender-500",trackClass:"text-charcoal-300",emoji:"",size:a?"sm":"md"})}),h.jsx(yo,{label:"",compact:a,children:h.jsx(Nf,{value:o.corruption,min:fn.corruption.min,max:fn.corruption.max,segments:fn.corruption.max,colorClass:"text-mist-500",trackClass:"text-charcoal-300",emoji:"E,size:a?"sm":"md"})}),h.jsx(yo,{label:"EE",compact:a,children:h.jsx(Sf,{value:o.moralScale,min:fn.moralScale.min,max:fn.moralScale.max,colorClass:"text-matcha-500",trackClass:"text-charcoal-300",emoji:"",size:a?"sm":"md"})})]})]})}function yo({label:r,children:n,compact:s}){return h.jsxs("div",{className:xe("flex flex-col items-center",s?"space-y-1":void 0),children:[n,h.jsx("div",{className:xe("mt-1 text-charcoal-700 font-primary text-center",s?"text-[10px] leading-tight":"text-[11px] leading-none"),children:r})]})}function Sf({value:r,min:n=0,max:s=100,colorClass:o,trackClass:a,emoji:u,size:f="md"}){const c=f==="sm",p=c?"w-20 h-20":"w-[88px] h-[88px]",g=c?"w-8 h-8 text-base":"w-8 h-8",y=c?"px-2 h-6 text-[11px]":"px-2 h-7 text-[12px]",v=c?92:100,w=c?6:7,S=c?33:34,k={"--gauge-flip-size":c?"80px":"88px"},E=2*Math.PI*S,{clamped:C,percent:I}=Lp(r,n,s),b=E*(1-I/100),M=Rp(C,s);return h.jsxs(zp,{flipStyle:k,children:[h.jsx("div",{className:"gauge-face gauge-face--front",children:h.jsxs("div",{className:xe("relative flex items-center justify-center",p),children:[h.jsxs("svg",{width:v,height:v,viewBox:"0 0 100 100","aria-hidden":!0,className:"block",children:[h.jsx("circle",{cx:"50",cy:"50",r:S+w/2+1.5,fill:"currentColor",className:"text-matcha-50"}),h.jsx("circle",{cx:"50",cy:"50",r:S+w/2+3,fill:"none",stroke:"currentColor",strokeWidth:2,className:"text-charcoal-400",opacity:.9}),h.jsx("circle",{cx:"50",cy:"50",r:S,fill:"none",stroke:"currentColor",strokeWidth:w,className:xe(a||"text-charcoal-200"),opacity:.35}),h.jsx("circle",{cx:"50",cy:"50",r:S,fill:"none",stroke:"currentColor",strokeWidth:w,strokeLinecap:"round",strokeDasharray:E,strokeDashoffset:b,transform:"rotate(-90 50 50)",className:xe(o||"text-matcha-500")})]}),h.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:h.jsx("span",{className:xe("inline-flex items-center justify-center rounded-full border-2 border-matcha-300 bg-matcha-50 select-none",g),children:u})})]})}),h.jsx("div",{className:"gauge-face gauge-face--back",children:h.jsxs("div",{className:xe("relative flex items-center justify-center",p),children:[h.jsxs("svg",{width:v,height:v,viewBox:"0 0 100 100","aria-hidden":!0,className:"block",children:[h.jsx("circle",{cx:"50",cy:"50",r:S+w/2+1.5,fill:"currentColor",className:"text-matcha-50"}),h.jsx("circle",{cx:"50",cy:"50",r:S+w/2+3,fill:"none",stroke:"currentColor",strokeWidth:2,className:"text-charcoal-400",opacity:.9})]}),h.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:h.jsx("span",{className:xe("inline-flex items-center justify-center rounded-md border-2 border-charcoal-200 bg-paper-cream font-mono tabular-nums text-charcoal-900",y),children:M})})]})})]})}function Nf({value:r,min:n=0,max:s=100,segments:o=12,colorClass:a,trackClass:u,emoji:f,centerLabel:c,size:p="md"}){const g=p==="sm",y=g?"w-20 h-20":"w-[88px] h-[88px]",v=g?"w-8 h-8 text-[13px]":"w-8 h-8 text-xs",w=g?"px-2 h-6 text-[11px]":"px-2 h-7 text-[12px]",S=g?92:100,k=g?6:7,E=g?33:34,C={"--gauge-flip-size":g?"80px":"88px"},{clamped:I,percent:b}=Lp(r,n,s),M=Math.max(1,Math.round(o||1)),D=360/M,L=Math.min(M,Math.round(b/100*M)),F=Rp(I,s),H=Array.from({length:M}).map((K,z)=>{const W=(z*D-90)*(Math.PI/180),ae=E-k/2-2,ee=E+k/2+2,he=50+ae*Math.cos(W),Z=50+ae*Math.sin(W),ce=50+ee*Math.cos(W),O=50+ee*Math.sin(W);return h.jsx("line",{x1:he,y1:Z,x2:ce,y2:O,stroke:"currentColor",strokeWidth:1,className:xe("text-charcoal-200")},z)}),q=Array.from({length:L}).map((K,z)=>{const W=z*D-90+4,ae=(z+1)*D-90-4,ee=Ef(50,50,E,W,ae);return h.jsx("path",{d:ee,fill:"none",stroke:"currentColor",strokeWidth:k,strokeLinecap:"round",className:xe(a||"text-lavender-500")},z)}),te=Array.from({length:M}).map((K,z)=>{const W=z*D-90+4,ae=(z+1)*D-90-4,ee=Ef(50,50,E,W,ae);return h.jsx("path",{d:ee,fill:"none",stroke:"currentColor",strokeWidth:k,strokeLinecap:"round",opacity:.2,className:xe(u||"text-charcoal-200")},z)});return h.jsxs(zp,{flipStyle:C,children:[h.jsx("div",{className:"gauge-face gauge-face--front",children:h.jsxs("div",{className:xe("relative flex items-center justify-center",y),children:[h.jsxs("svg",{width:S,height:S,viewBox:"0 0 100 100","aria-hidden":!0,className:"block",children:[h.jsx("circle",{cx:"50",cy:"50",r:E+k/2+1.5,fill:"currentColor",className:"text-matcha-50"}),h.jsx("circle",{cx:"50",cy:"50",r:E+k/2+3,fill:"none",stroke:"currentColor",strokeWidth:2,className:"text-charcoal-400",opacity:.9}),te,q,H]}),h.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:h.jsx("span",{className:xe("inline-flex items-center justify-center rounded-full border-2 border-matcha-300 bg-matcha-50 select-none",v),children:f??c})})]})}),h.jsx("div",{className:"gauge-face gauge-face--back",children:h.jsxs("div",{className:xe("relative flex items-center justify-center",y),children:[h.jsxs("svg",{width:S,height:S,viewBox:"0 0 100 100","aria-hidden":!0,className:"block",children:[h.jsx("circle",{cx:"50",cy:"50",r:E+k/2+1.5,fill:"currentColor",className:"text-matcha-50"}),h.jsx("circle",{cx:"50",cy:"50",r:E+k/2+3,fill:"none",stroke:"currentColor",strokeWidth:2,className:"text-charcoal-400",opacity:.9})]}),h.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:h.jsx("span",{className:xe("inline-flex items-center justify-center rounded-md border-2 border-charcoal-200 bg-paper-cream font-mono tabular-nums text-charcoal-900",w),children:F})})]})})]})}function _f(r,n,s,o){const a=o*Math.PI/180;return{x:r+s*Math.cos(a),y:n+s*Math.sin(a)}}function Ef(r,n,s,o,a){const u=_f(r,n,s,a),f=_f(r,n,s,o),c=a-o<=180?"0":"1";return["M",u.x,u.y,"A",s,s,0,c,0,f.x,f.y].join(" ")}function Lp(r,n,s){const o=Math.min(n,s),a=Math.max(n,s),u=Number.isFinite(r)?r:o,f=Math.min(Math.max(u,o),a),c=a===o?0:(f-o)/(a-o)*100;return{clamped:f,percent:c}}function Rp(r,n){return`${Number.isInteger(r)?r.toString():r.toFixed(1)}/${n}`}function zp({flipStyle:r,children:n}){const{isNarrow:s}=si(),[o,a]=N.useState(!1),u=()=>{s&&a(f=>!f)};return h.jsx("div",{className:xe("gauge-flip gauge-flip-outer mx-auto",o&&"gauge-flip--flipped",s&&"gauge-flip--mobile"),role:"button",tabIndex:0,onClick:u,style:r,children:h.jsx("div",{className:"gauge-flip-inner",style:s?{transform:o?"rotateY(180deg)":"rotateY(0deg)"}:void 0,children:n})})}var A0={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const L0=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const hc=(r,n)=>{const s=N.forwardRef(({color:o="currentColor",size:a=24,strokeWidth:u=2,absoluteStrokeWidth:f,className:c="",children:p,...g},y)=>N.createElement("svg",{ref:y,...A0,width:a,height:a,stroke:o,strokeWidth:f?Number(u)*24/Number(a):u,className:["lucide",`lucide-${L0(r)}`,c].join(" "),...g},[...n.map(([v,w])=>N.createElement(v,w)),...Array.isArray(p)?p:[p]]));return s.displayName=`${r}`,s};const R0=hc("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);const z0=hc("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);const O0=hc("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);function mc({characterName:r,mood:n,location:s,displayTitle:o,trueTitle:a,fatigue:u,desire:f,will:c,san:p,className:g,style:y}){const[v,w]=N.useState(!1);return h.jsxs("div",{className:xe("w-45 bg-surface border-2 border-mist-300 rounded-xl p-4 relative min-w-0","sticker-card",g),style:y,children:[h.jsx("div",{className:"washi-tape washi-tape--center pointer-events-none"}),h.jsxs("div",{className:"mb-3",children:[h.jsx("div",{className:"text-left mb-1",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"w-1.5 h-5 rounded-full bg-gradient-to-b from-sakura-400 via-mist-400 to-matcha-500"}),h.jsx("h3",{className:"font-cpTitle font-bold text-sakura-700 text-xl leading-tight",children:r})]})}),h.jsx("div",{className:"mt-2 space-y-2 text-sm text-charcoal-700",children:h.jsxs("div",{className:"space-y-1",children:[h.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[h.jsx(R0,{className:"w-4 h-4 shrink-0 text-sakura-700","aria-hidden":!0}),h.jsx(vo,{text:o,className:"font-semibold leading-tight"})]}),h.jsxs("button",{type:"button",onClick:()=>w(S=>!S),className:xe("relative flex items-center gap-1.5 px-0 py-0.5 text-left cursor-pointer select-none overflow-visible max-w-full min-w-0","focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-mist-400","text-charcoal-900"),"aria-pressed":v,"aria-label":"E",children:[h.jsx("span",{className:"w-4 h-4","aria-hidden":!0}),h.jsxs("div",{className:"relative flex-1 min-w-0 py-[2px]",children:[h.jsx("span",{"aria-hidden":!0,className:"pointer-events-none absolute inset-0 bg-charcoal-900 rounded-none"}),h.jsx(vo,{text:a,className:xe("relative z-10 text-sm font-semibold transition-colors duration-200",v?"text-white":"text-transparent"),tooltipClassName:"text-sm"})]})]}),h.jsxs("div",{className:"flex items-center justify-start gap-1.5 min-w-0",children:[h.jsx(z0,{className:"w-4 h-4 shrink-0 text-mist-700"}),h.jsx(vo,{text:s})]}),h.jsxs("div",{className:"flex items-center justify-start gap-1.5 min-w-0",children:[h.jsx(O0,{className:"w-4 h-4 shrink-0 text-sakura-700"}),h.jsx(vo,{text:n})]})]})})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(xo,{label:"",value:u,trackClass:"bg-sakura-100",fillClass:"bg-sakura-500"}),h.jsx(xo,{label:"E,value:f,trackClass:"bg-sakura-100",fillClass:"bg-sakura-300"}),h.jsx(xo,{label:"E,value:c,trackClass:"bg-matcha-100",fillClass:"bg-matcha-500"}),h.jsx(xo,{label:"E",value:p,trackClass:"bg-mist-100",fillClass:"bg-mist-500"})]})]})}function vo({text:r,className:n,tooltipClassName:s}){const o=N.useRef(null),[a,u]=N.useState(!1),[f,c]=N.useState(!1);return N.useEffect(()=>{const p=o.current;if(!p)return;const g=()=>{u(p.scrollWidth>p.clientWidth+1)};g();const y=typeof ResizeObserver<"u"?new ResizeObserver(g):null;return y?.observe(p),window.addEventListener("resize",g),()=>{y?.disconnect(),window.removeEventListener("resize",g)}},[r]),h.jsxs("span",{className:xe("relative inline-flex flex-1 min-w-0 max-w-full align-middle",n),onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),onFocus:()=>c(!0),onBlur:()=>c(!1),tabIndex:a?0:-1,children:[h.jsx("span",{ref:o,className:"block w-full truncate leading-tight",children:r}),a?h.jsx("span",{role:"tooltip",className:xe("absolute left-0 top-full mt-1 z-20 max-w-[260px] whitespace-normal rounded-md border border-charcoal-700 bg-white dark:bg-charcoal-900 px-2 py-1 text-xs text-charcoal-900 dark:text-surface","transition ease-out duration-150 origin-top-left",f?"opacity-100 translate-y-0":"pointer-events-none opacity-0 translate-y-1",s),children:r}):null]})}function xo({label:r,value:n,trackClass:s,fillClass:o}){const a=Math.max(0,Math.min(100,n));return h.jsxs("div",{className:xe("relative w-full h-4 rounded-full overflow-hidden",s),children:[h.jsx("div",{className:xe("h-full rounded-full transition-all duration-700 ease-out",o),style:{width:`${a}%`}}),h.jsxs("div",{className:"absolute inset-0 flex items-center justify-between px-2 text-[11px] leading-none font-medium text-charcoal-900",children:[h.jsx("span",{className:"truncate",children:r}),h.jsxs("span",{className:"font-mono tabular-nums",children:[n,"/100"]})]})]})}class F0{pack=null;ensureInit(){if(!this.pack)throw console.error("RiiPack: pack not initialized when expected to be ready"),new Error("RiiPack: pack not initialized - resources should be loaded before calling this method")}setPack(n){this.pack=n}has(n){const s=this.normalize(n);return this.ensureInit(),this.pack.has(s)}normalize(n){return n&&(n.startsWith("/")?n.slice(1):n)}async getDataUrl(n){const s=this.normalize(n);if(this.ensureInit(),!this.pack.has(s))return console.error("RiiPack: missing file in pack:",s),"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=";const o=this.pack.getBlob(s);return await new Promise((u,f)=>{const c=new FileReader;c.onerror=()=>f(c.error),c.onload=()=>u(String(c.result)),c.readAsDataURL(o)})}async resolveForPixi(n,s){return s==="texture"||s==="font"?this.getDataUrl(n):this.resolvePath(n)}resolvePath(n){if(n.startsWith("real:"))return n.substring(5);const s=this.normalize(n);if(this.ensureInit(),!this.pack.has(s))return console.error("RiiPack: missing file in pack:",s),"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=";const o=this.pack.getUrl(s);return o||(console.error("RiiPack: cannot make blob URL for:",s),"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=")}}const Nt=new F0,Op=Ge.createContext(null);function D0(){return Ge.useContext(Op)??{isWide:!1,enter:()=>!1,exit:()=>!1}}var Ho=vp();const Xl=r=>r&&r.startsWith("real:")?r.slice(5):r;function $0({option:r,state:n,isActive:s,onDownload:o,onApply:a}){const u=Xl(n.previewUrl??(n.status==="downloaded"?r.downloadUrl:void 0)),f=n.status==="downloading",c=n.status==="downloaded",p=c?"":f?"...":"";return h.jsxs("div",{className:xe("external-wallpaper-card",s?"is-active":""),role:"listitem",children:[h.jsx("div",{className:"external-wallpaper-card__thumb paper-noise",children:u?h.jsx("img",{src:u,alt:r.label,loading:"lazy"}):h.jsx("div",{className:"external-wallpaper-card__placeholder",children:h.jsx("span",{className:"external-wallpaper-card__placeholder-main",children:""})})}),h.jsxs("div",{className:"external-wallpaper-card__info",children:[n.error&&n.status==="error"&&h.jsx("div",{className:"external-wallpaper-card__error",children:n.error}),h.jsxs("div",{className:"external-wallpaper-card__actions",children:[h.jsx("button",{type:"button",className:"external-wallpaper-card__primary",onClick:c?a:o,disabled:f,children:p}),c&&h.jsx("button",{type:"button",className:"external-wallpaper-card__secondary",onClick:o,disabled:f,children:""})]})]})]})}const Fp="external-wallpaper-downloads",B0=()=>{if(typeof window>"u"||typeof localStorage>"u")return new Set;try{const r=localStorage.getItem(Fp);if(!r)return new Set;const n=JSON.parse(r);if(!Array.isArray(n))return new Set;const s=new Set(Ro.map(a=>a.key)),o=n.filter(a=>typeof a=="string"&&s.has(a));return new Set(o)}catch(r){return console.warn("[BackgroundGallery] ",r),new Set}},U0=()=>{const r=B0();return Ro.reduce((n,s)=>(n[s.key]=r.has(s.key)?{status:"downloaded",previewUrl:s.downloadUrl}:{status:"idle"},n),{})},H0=r=>{if(typeof window>"u"||typeof localStorage>"u")return;const n=Object.entries(r).filter(([,s])=>s.status==="downloaded").map(([s])=>s);try{localStorage.setItem(Fp,JSON.stringify(n))}catch(s){console.warn("[BackgroundGallery] ",s)}};function W0({isOpen:r,onClose:n,selectedFont:s,onFontChange:o,typingEnabled:a,onTypingToggle:u,textOpacity:f,onTextOpacityChange:c,surfaceOpacity:p,onSurfaceOpacityChange:g,storyFontSize:y,onStoryFontSizeChange:v,storyPadding:w,onStoryPaddingChange:S,backgroundKey:k,onBackgroundChange:E,onPreview:C,mobileLayoutStyle:I,onMobileLayoutStyleChange:b}){const M=N.useMemo(()=>[{key:"naikai",label:"naikai",className:"font-naikai"},{key:"fzyousong",label:"E,className:"font-fzyousong"},{key:"system",label:"E,className:"font-sans"}],[]),[D,L]=N.useState(()=>U0()),[F,H]=N.useState(!1),q=N.useMemo(()=>Object.values(D).filter(z=>z.status==="downloaded").length,[D]);N.useEffect(()=>{H0(D)},[D]),N.useEffect(()=>{if(!r)return;const z=W=>{W.key==="Escape"&&n()};return document.addEventListener("keydown",z),()=>document.removeEventListener("keydown",z)},[r,n]),N.useEffect(()=>{if(!r)return;const z=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=z}},[r]);const te=N.useCallback(async z=>{L(W=>({...W,[z.key]:{status:"downloading",previewUrl:W[z.key]?.previewUrl}}));try{const W=await fetch(z.downloadUrl);if(!W.ok)throw new Error(`EE{W.status}E`);const ae=W.clone(),ee=await W.blob(),he=URL.createObjectURL(ee);wf(z.key,he);try{globalThis.caches&&await(await globalThis.caches.open("rii-external-wallpapers")).put(z.downloadUrl,ae)}catch(Z){console.warn("[BackgroundGallery] ",Z)}L(Z=>({...Z,[z.key]:{status:"downloaded",previewUrl:he}})),E(z.key)}catch(W){L(ae=>({...ae,[z.key]:{status:"error",error:W instanceof Error?W.message:"EE,previewUrl:ae[z.key]?.previewUrl}}))}},[E]),K=N.useCallback(z=>{const W=D[z.key]?.previewUrl;W&&wf(z.key,W),E(z.key)},[D,E]);return!r||typeof document>"u"?null:Ho.createPortal(h.jsxs("div",{className:"display-settings-overlay",role:"dialog","aria-modal":!0,"aria-label":"",children:[h.jsx("div",{className:"display-settings-overlay__backdrop",onClick:n}),h.jsx("div",{className:"display-settings-card paper-noise",role:"document",onClick:z=>z.stopPropagation(),children:h.jsxs("div",{className:"display-settings-card__inner",children:[h.jsx("div",{className:"display-settings-card__header",children:h.jsx("div",{children:h.jsx("div",{className:"display-settings-card__title",children:""})})}),h.jsxs("div",{className:"display-settings-card__body",children:[h.jsxs("div",{className:"display-settings-card__section",children:[h.jsx("div",{className:"display-settings-card__label",children:"E}),h.jsx("div",{className:"display-settings-card__gallery",role:"list",children:v0.map(z=>h.jsx("div",{role:"listitem",className:xe("display-settings-card__wallpaper",k===z.key?"is-active":""),"aria-label":`${z.label}`,tabIndex:0,onClick:()=>E(z.key),onKeyDown:W=>{(W.key==="Enter"||W.key===" ")&&(W.preventDefault(),E(z.key))},children:h.jsx("div",{className:"display-settings-card__wallpaper-thumb paper-noise",children:z.imageUrl?h.jsx("img",{src:Nt.resolvePath(z.imageUrl),alt:z.label,loading:"lazy"}):h.jsx("div",{className:"display-settings-card__wallpaper-pattern","aria-hidden":!0})})},z.key))}),h.jsx("div",{className:"display-settings-card__preview",children:h.jsx("button",{type:"button",className:"display-settings-card__preview-btn",onClick:()=>C(k),children:"E"})}),h.jsx("div",{className:"display-settings-card__external-separator","aria-hidden":!0}),h.jsx(V0,{isOpen:F,onToggle:()=>H(z=>!z),states:D,backgroundKey:k,onDownload:te,onApply:K,downloadedCount:q})]}),h.jsxs("div",{className:"display-settings-card__section",children:[h.jsx("div",{className:"display-settings-card__label",children:"E}),h.jsx("div",{className:"display-settings-card__choices",children:M.map(z=>h.jsx("button",{onClick:()=>o(z.key),className:xe("display-settings-card__choice-btn font-cpTitle font-semibold",z.className,s===z.key?"is-active":""),children:z.label},z.key))})]}),h.jsx("div",{className:"display-settings-card__section",children:h.jsxs("div",{className:"display-settings-card__row",children:[h.jsxs("label",{className:"display-settings-card__toggle",children:[h.jsx("input",{type:"checkbox",checked:a,onChange:z=>u(z.target.checked)}),h.jsx("span",{className:"display-settings-card__toggle-label",children:""})]}),h.jsx("span",{className:"display-settings-card__hint",children:"EEEE})]})}),h.jsx("div",{className:"display-settings-card__section",children:h.jsxs("div",{className:"flex flex-col gap-4",children:[h.jsx(wo,{label:"EEE",value:f,onChange:c}),h.jsx(wo,{label:"E",value:p,onChange:g}),h.jsx(wo,{label:"",value:y,onChange:v,min:.5,max:2,step:.1,formatValue:z=>`${Math.round(z*100)}%`}),h.jsx(wo,{label:"EE,value:w,onChange:S,min:0,max:100,step:4,formatValue:z=>`${z}px`})]})}),h.jsxs("div",{className:"display-settings-card__section",children:[h.jsx("div",{className:"display-settings-card__label",children:"E}),h.jsxs("div",{className:"display-settings-card__choices",children:[h.jsx("button",{type:"button",className:xe("display-settings-card__choice-btn font-cpTitle font-semibold",I==="style1"?"is-active":""),onClick:()=>b("style1"),children:"EEEE}),h.jsx("button",{type:"button",className:xe("display-settings-card__choice-btn font-cpTitle font-semibold",I==="style2"?"is-active":""),onClick:()=>b("style2"),children:"EEEE})]}),h.jsx("div",{className:"display-settings-card__hint",children:"EE})]})]})]})})]}),document.body)}function wo({value:r,onChange:n,label:s,min:o=0,max:a=1,step:u=.05,formatValue:f}){return h.jsxs("div",{className:"w-full",children:[h.jsxs("div",{className:"flex justify-between mb-2",children:[h.jsx("span",{className:"text-sm font-medium text-charcoal-600",children:s}),h.jsx("span",{className:"text-sm font-medium text-charcoal-400",children:f?f(r):`${Math.round(r*100)}%`})]}),h.jsx("input",{type:"range",min:o,max:a,step:u,value:r,onChange:c=>n(parseFloat(c.target.value)),className:"w-full h-2 bg-charcoal-200 rounded-lg appearance-none cursor-pointer accent-matcha-500"})]})}function V0({isOpen:r,onToggle:n,states:s,backgroundKey:o,onDownload:a,onApply:u,downloadedCount:f}){const c=Ro.length;return h.jsxs("div",{className:"external-wallpaper",children:[h.jsxs("button",{type:"button",className:"external-wallpaper__toggle",onClick:n,"aria-expanded":r,children:[h.jsxs("div",{className:"external-wallpaper__toggle-text",children:[h.jsx("div",{className:"external-wallpaper__eyebrow",children:"Human Art"}),h.jsxs("div",{className:"external-wallpaper__title",children:[h.jsx("a",{href:"https://www.pixiv.net/users/22334948",target:"_blank",rel:"noreferrer",className:"external-wallpaper__link",onClick:p=>p.stopPropagation(),children:"mi"}),h.jsx("span",{})," E"]})]}),h.jsxs("div",{className:"external-wallpaper__meta",children:[h.jsxs("span",{className:"external-wallpaper__counter",children:[f," / ",c," "]}),h.jsx("span",{className:xe("external-wallpaper__chevron",r?"is-open":""),children:"E})]})]}),r&&h.jsx("div",{className:"external-wallpaper__grid",role:"list",children:Ro.map(p=>h.jsx($0,{option:p,state:s[p.key]??{status:"idle"},isActive:o===p.key,onDownload:()=>a(p),onApply:()=>u(p)},p.key))})]})}const gc=({open:r,children:n,containerClassName:s="",overlayClassName:o="",onOverlayClick:a})=>{if(!r||typeof document>"u")return null;const u=["shino-modal__overlay",o].filter(Boolean).join(" "),f=["shino-modal__container",s].filter(Boolean).join(" ");return Ho.createPortal(h.jsx("div",{className:u,onClick:a,children:h.jsx("div",{className:f,onClick:c=>{c.stopPropagation()},children:n})}),document.body)};function yc({className:r}){const{selectedFont:n,setSelectedFont:s,typingEnabled:o,setTypingEnabled:a,textOpacity:u,setTextOpacity:f,surfaceOpacity:c,setSurfaceOpacity:p,storyFontSize:g,setStoryFontSize:y,storyPadding:v,setStoryPadding:w,backgroundKey:S,setBackgroundKey:k,mobileLayoutStyle:E,setMobileLayoutStyle:C}=ps(),{exit:I}=D0(),[b,M]=N.useState(!1),[D,L]=N.useState(null),[F,H]=N.useState(!1),q=N.useCallback(()=>M(!1),[]),te=N.useCallback(()=>{H(!0)},[]),K=N.useCallback(()=>{M(!0)},[]),z=N.useCallback(()=>{I()},[I]);return N.useEffect(()=>{b||L(null)},[b]),h.jsxs("div",{className:xe("bg-surface border-2 border-matcha-300 rounded-xl p-3 sticker-card",r),children:[h.jsxs("div",{className:"flex flex-nowrap justify-center gap-3",children:[h.jsx(zl,{icon:h.jsx("span",{className:"text-sm",children:""}),label:"E,onClick:te,color:"matcha"}),h.jsx(zl,{icon:h.jsx("span",{className:"text-sm",children:"E}),label:"",onClick:K,color:"matcha"}),h.jsx(zl,{icon:h.jsx("span",{className:"text-sm",children:""}),label:"",onClick:z,color:"matcha"})]}),h.jsx(W0,{isOpen:b,onClose:q,selectedFont:n,onFontChange:s,typingEnabled:o,onTypingToggle:a,textOpacity:u,onTextOpacityChange:f,surfaceOpacity:c,onSurfaceOpacityChange:p,storyFontSize:g,onStoryFontSizeChange:y,storyPadding:v,onStoryPaddingChange:w,backgroundKey:S,onBackgroundChange:k,onPreview:L,mobileLayoutStyle:E,onMobileLayoutStyleChange:C}),D&&h.jsx(G0,{backgroundKey:D,onClose:()=>L(null)}),h.jsx(gc,{open:F,overlayClassName:"plot-bias-modal__overlay",containerClassName:"plot-bias-modal",onOverlayClick:()=>H(!1),children:h.jsx("div",{className:"plot-bias-modal__panel",children:h.jsxs("div",{className:"plot-bias-modal__image-wrap",children:[h.jsx("img",{src:Nt.resolvePath("/images/sorry.webp"),className:"plot-bias-modal__image"}),h.jsxs("div",{className:"plot-bias-modal__dialog",children:[h.jsx("div",{className:"plot-bias-modal__dialog-name",children:"E}),h.jsxs("div",{className:"plot-bias-modal__dialog-text",children:[".......E..",h.jsx("br",{}),"E.."]})]})]})})})]})}function zl({icon:r,label:n,onClick:s,color:o}){const a=()=>{switch(o){case"sakura":return"border-sakura-300 bg-sakura-50 hover:bg-sakura-100 text-sakura-700";case"matcha":return"border-matcha-300 bg-matcha-50 hover:bg-matcha-100 text-matcha-700";case"mist":return"border-mist-300 bg-mist-50 hover:bg-mist-100 text-mist-700";case"lavender":return"border-lavender-300 bg-lavender-50 hover:bg-lavender-100 text-lavender-700";default:return"border-matcha-300 bg-matcha-50 hover:bg-matcha-100 text-matcha-700"}};return h.jsx("button",{onClick:s,className:xe("w-12 h-12 rounded-lg border-2 border-dashed transition-all duration-250","hover:transform hover:translate-y-[-2px] flex items-center justify-center","font-primary text-sm font-medium",a()),children:h.jsxs("div",{className:"flex flex-col items-center gap-1 px-2 py-1",children:[r,h.jsx("span",{className:"text-xs",children:n})]})})}function G0({backgroundKey:r,onClose:n}){const s=Pp(r),o=N.useMemo(()=>{if(s){if(s.startsWith("real:"))return Xl(s);try{return Nt.resolvePath(s)}catch(a){return console.warn("[BackgroundPreviewOverlay] EEEE,a),Xl(s)}}},[s]);return N.useEffect(()=>{const a=u=>{u.key==="Escape"&&n()};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[n]),typeof document>"u"?null:Ho.createPortal(h.jsxs("div",{className:"background-preview-overlay",role:"presentation",onClick:n,children:[h.jsx("div",{className:xe("background-preview-overlay__canvas",o?"background-preview-overlay__canvas--image":"bg-pattern"),style:o?{backgroundImage:`url(${o})`}:void 0}),h.jsx("div",{className:"background-preview-overlay__hint",children:"EEE})]}),document.body)}function Y0(r,n=Dp){const s=new Map;if(n.forEach(o=>{s.set(o.id,o.enabled)}),r&&r.length>0){const o=new Set(r);s.forEach((a,u)=>{s.set(u,a||o.has(u))})}return s}const K0=[{id:"",pov:ke.RINA,title:"",aliases:["oral",""],clips:[{id:"rina-oral-1",fileName:"1.mkv",playback:"loop"},{id:"rina-oral-2",fileName:"2.mkv",playback:"loop"},{id:"rina-oral-3",fileName:"3.mkv",playback:"loop"}]},{id:"E",pov:ke.RINA,title:"E",aliases:["doggy","EE,"E"],clips:[{id:"rina-doggy-1",fileName:"E1.mkv",playback:"loop"},{id:"rina-doggy-2",fileName:"E2.mkv",playback:"loop"},{id:"rina-doggy-3",fileName:"E3.mkv",playback:"once"}]},{id:"",pov:ke.RINA,title:"",aliases:["lift","E,"E"],clips:[{id:"rina-lift-1",fileName:"1.mkv",playback:"loop"},{id:"rina-lift-2",fileName:"2.mkv",playback:"loop"},{id:"rina-lift-3",fileName:"3.mkv",playback:"loop"}]},{id:"E,pov:ke.RINA,title:"E,aliases:["cowgirl","E],clips:[{id:"rina-cowgirl-1",fileName:"E.mkv",playback:"loop"},{id:"rina-cowgirl-2",fileName:"E.mkv",playback:"loop"},{id:"rina-cowgirl-3",fileName:"E.mkv",playback:"loop"}]},{id:"",pov:ke.RINA,title:"E,aliases:["missionary","E,""],clips:[{id:"rina-missionary-1",fileName:"1.mkv",playback:"once"}]}],vc=[{id:"rina-nude",pov:ke.RINA,initialOwned:!0,name:"",fileName:"nude.webp",description:"E"},{id:"rina-gym-class-delinquent",pov:ke.RINA,name:"E,fileName:"gym_class_delinquent.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-sports-uniform",pov:ke.RINA,name:"",fileName:"sports_uniform.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEE,hideFace:!0},{id:"rina-school-swimsuit",pov:ke.RINA,name:"",fileName:"school_swimsuit.webp",description:"EEEEUEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-adventurer-lolita",pov:ke.RINA,initialOwned:!0,name:"E,fileName:"adventurer_lolita.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-back-alley-clinic",pov:ke.RINA,name:"E,fileName:"back_alley_clinic.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEVEEE},{id:"rina-bondage-bunny",pov:ke.RINA,name:"E,fileName:"bondage_bunny.webp",description:"EEESMEEEEEEEEEEOEEEEEEEEEEEEEEEEVEEEEEEEEEEEEEEE},{id:"rina-bondage-schoolgirl",pov:ke.RINA,name:"E",fileName:"bondage_schoolgirl.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEETEEEEEEEEEEEEEEEEEEEE},{id:"rina-captive-garb",pov:ke.RINA,name:"",fileName:"captive_garb.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-countryside-succubus",pov:ke.RINA,initialOwned:!0,name:"E,fileName:"countryside_succubus.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-cropped-sailor-uniform",pov:ke.RINA,name:"E,fileName:"cropped_sailor_uniform.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-cut-here-line",pov:ke.RINA,name:"E",fileName:"cut_here_line.webp",hideFace:!0,description:"EEEEEE},{id:"rina-delinquent-summer-style",pov:ke.RINA,name:"",fileName:"delinquent_summer_style.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-delinquent-uniform",pov:ke.RINA,name:"E,fileName:"delinquent_uniform.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-delivery-girl",pov:ke.RINA,name:"E,fileName:"delivery_girl.webp",description:"EPoloEEEEPoloEEEEEEEEEEEEEEEEEEEEE,hideFace:!0},{id:"rina-demonic-cow-girl",pov:ke.RINA,name:"E,fileName:"demonic_cow_girl.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-enkou-uniform",pov:ke.RINA,name:"",fileName:"enkou_uniform.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-ero-yukata",pov:ke.RINA,name:"",fileName:"ero_yukata.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-erotic-china-dress",pov:ke.RINA,name:"E,fileName:"erotic_china_dress.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-erotic-restraint",pov:ke.RINA,name:"SME,fileName:"erotic_restraint.webp",description:"EEEEEEEEEEEOEEEEEEEEEEEEVEEEEOEEEEE,hideFace:!0},{id:"rina-fetish-clubwear",pov:ke.RINA,initialOwned:!0,name:"E,fileName:"fetish_clubwear.webp",description:"EEEEEEEEEEEEOEEVEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-nightdress",pov:ke.RINA,initialOwned:!0,name:"",fileName:"first_night.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-gothic-biker",pov:ke.RINA,initialOwned:!0,name:"E,fileName:"gothic_biker.webp",description:"EEEEEEEEEEEEEEEEEOEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-bath-towel",pov:ke.RINA,name:"E,fileName:"just_showered.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-lewd-nurse-uniform",pov:ke.RINA,name:"E,fileName:"lewd_nurse_uniform.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-metallic-pink-microkini",pov:ke.RINA,name:"E,fileName:"metallic_pink_microkini.webp",description:"EEEEEEEEEEEEEEEVEEEEEEEEEEEEEEEEEEEE},{id:"rina-naked-apron-maid",pov:ke.RINA,name:"EE,fileName:"naked_apron_maid.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-neko-devil",pov:ke.RINA,name:"E,fileName:"neko_devil.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-open-side-babydoll",pov:ke.RINA,name:"",fileName:"open_side_babydoll.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-public-indecency",pov:ke.RINA,name:"EE,fileName:"public_indecency.webp",description:"EEEPoloEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-qipao-maid",pov:ke.RINA,name:"",fileName:"qipao_maid.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-rebellious-mechanic",pov:ke.RINA,name:"E,fileName:"rebellious_mechanic.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEVEEEEEEEEE},{id:"rina-rebellious-student",pov:ke.RINA,initialOwned:!0,name:"E",fileName:"rebellious_student.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-slingshot-bikini",pov:ke.RINA,name:"E,fileName:"slingshot_bikini.webp",description:"EEEEEEEOEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-slingshot-succubus",pov:ke.RINA,name:"E,fileName:"slingshot_succubus.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEVEEEEEEEEEEEEEE,hideFace:!0},{id:"rina-succubus-gym-class",pov:ke.RINA,name:"E,fileName:"succubus_gym_class.webp",description:"EEEEEEETEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-succubus-lingerie",pov:ke.RINA,name:"",fileName:"succubus_lingerie.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-underboob-sportswear",pov:ke.RINA,name:"E,fileName:"underboob_sportswear.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-unfastened-robe",pov:ke.RINA,name:"",fileName:"unfastened_robe.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-vampire-nurse",pov:ke.RINA,name:"",fileName:"vampire_nurse.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE},{id:"rina-virgin-killing-sweater",pov:ke.RINA,name:"E",fileName:"virgin_killing_sweater.webp",description:"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEVEEE}],Dp=vc.map(r=>({id:r.id,enabled:!!r.initialOwned})),X0=[{id:"rina-simple",pov:ke.RINA,name:"E,fileName:"simple.webp"},{id:"rina-smile",pov:ke.RINA,name:"E,fileName:"smile.webp"},{id:"rina-shy",pov:ke.RINA,name:"E,fileName:"shy.webp"},{id:"rina-angry",pov:ke.RINA,name:"E,fileName:"angry.webp"},{id:"rina-cry",pov:ke.RINA,name:"",fileName:"cry.webp"},{id:"rina-scared",pov:ke.RINA,name:"E,fileName:"scared.webp"},{id:"rina-dark_smile",pov:ke.RINA,name:"E,fileName:"dark_smile.webp"},{id:"rina-empty_eyes",pov:ke.RINA,name:"E,fileName:"empty_eyes.webp"},{id:"rina-normal",pov:ke.RINA,name:"",fileName:"normal.webp"},{id:"rina-sex",pov:ke.RINA,name:"E,fileName:"sex.webp"}];function Wo(){const r=T0(),n=Ap(`(max-width: ${dc-1}px)`,{enabled:!r,initialValue:!1});return r?r.isNarrow:n}const Cf=r=>typeof r!="string"?"":r.trim().toLowerCase(),If=(r,n)=>{const s=N.useRef(!1),o=N.useRef(0),a=N.useRef(0),u=N.useCallback(p=>{r.current&&(s.current=!0,o.current=p.pageX,a.current=r.current.scrollLeft,r.current.style.cursor="grabbing",r.current.style.userSelect="none")},[r]),f=N.useCallback(()=>{s.current=!1,r.current&&(r.current.style.cursor="grab",r.current.style.removeProperty("user-select"))},[r]),c=N.useCallback(p=>{if(!s.current||!r.current)return;p.preventDefault();const y=(p.pageX-o.current)*1.5;r.current.scrollLeft=a.current-y},[r]);return N.useEffect(()=>{const p=r.current;if(!p)return;const g=y=>{y.deltaY!==0&&(y.preventDefault(),p.scrollLeft+=y.deltaY)};return p.addEventListener("wheel",g,{passive:!1}),()=>{p.removeEventListener("wheel",g)}},[r,n]),{onMouseDown:u,onMouseLeave:f,onMouseUp:f,onMouseMove:c,style:{cursor:"grab"}}};function xc(){const r=pt("basic"),n=pt("portraitFrame"),s=pt("currentEventState"),o=uc("portraitFrame"),a=N.useRef(null),u=N.useRef(null),f=N.useRef(null),c=N.useRef(null),p=N.useRef(null),g=N.useRef(new Map),y=If(c,r.currPOV),v=If(p,r.currPOV),[w,S]=N.useState({width:0,height:0}),[k,E]=N.useState(0),[C,I]=N.useState(0),[b,M]=N.useState(!1),D=Wo(),[L,F]=N.useState(!1),[H,q]=N.useState(0),{mobileLayoutStyle:te}=ps(),K=N.useMemo(()=>Y0(n.enabledClothingIds,Dp),[n.enabledClothingIds]),z=N.useMemo(()=>vc.filter(Q=>Q.pov===r.currPOV).sort((Q,fe)=>{const we=K.get(Q.id)??!0,Ce=K.get(fe.id)??!0;return we===Ce?0:we?-1:1}),[r.currPOV,K]),W=N.useMemo(()=>X0.filter(Q=>Q.pov===r.currPOV),[r.currPOV]),ae=N.useMemo(()=>{const Q=s.current?.sexAction;return typeof Q!="string"?"":Q.trim()},[s]),ee=N.useMemo(()=>{if(!ae)return null;const Q=Cf(ae);return K0.find(fe=>fe.pov===r.currPOV&&[fe.id,...fe.aliases??[]].some(we=>Cf(we)===Q))??null},[ae,r.currPOV]),he=!!ee?.clips?.length,Z=N.useMemo(()=>z.find(Q=>K.get(Q.id)??!0),[K,z]),ce=(n.bodyId&&(K.get(n.bodyId)??!0)&&n.bodyId)??Z?.id??z[0]?.id,O=n.faceId??W[0]?.id,V=z.find(Q=>Q.id===ce)??z[0],Y=W.find(Q=>Q.id===O)??W[0];N.useEffect(()=>{if(D){if(te==="style1"){M(!0);return}te==="style2"&&M(!1)}},[D,te]),N.useEffect(()=>{if(!he||!ee){F(!1),q(0);return}H>=ee.clips.length&&q(0)},[ee,he,H]);const P=N.useMemo(()=>!ee||!he?null:ee.clips[H]??null,[ee,he,H]),_=N.useMemo(()=>P?Nt.resolvePath(`/images/${r.currPOV}/anime/${P.fileName}`):"",[r.currPOV,P]),B=P?.playback??"loop",X=N.useCallback(()=>{F(!1),q(0);const Q=f.current;Q&&(Q.pause(),Q.currentTime=0)},[]),J=N.useCallback(()=>{if(!L||B==="loop")return;const Q=f.current;Q&&(Q.currentTime=0,Q.play().catch(()=>{}))},[B,L]),ne=N.useCallback(Q=>{if(Q.stopPropagation(),!(!he||!ee)){if(!L){q(0),F(!0);return}if(H<ee.clips.length-1){q(fe=>Math.min(fe+1,ee.clips.length-1));return}X()}},[ee,he,H,X,L]),se=N.useCallback(()=>{if(B==="loop")return;const Q=f.current;Q&&Q.pause()},[B]);N.useEffect(()=>{if(!L||!P)return;const Q=f.current;if(!Q)return;Q.loop=B==="loop",Q.currentTime=0;const fe=Q.play();fe&&fe.catch(()=>{})},[P,B,L]);const pe=L?H<(ee?.clips.length??1)-1?"next":"end":"play",ge=pe==="play"?"":pe==="next"?"":"E,_e=pe==="play"?"":pe==="next"?"":"E,A=N.useCallback(Q=>{const fe=g.current;return fe.has(Q)||fe.set(Q,new Promise(we=>{const Ce=new Image;Ce.onload=()=>we(Ce),Ce.onerror=()=>we(Ce),Ce.src=Q})),fe.get(Q)},[]);N.useEffect(()=>{!V||!Y||n.bodyId===V.id&&n.faceId===Y.id||o({bodyId:V.id,faceId:Y.id})},[o,n.bodyId,n.faceId,V,Y]),N.useEffect(()=>{const Q=()=>{if(!a.current)return;const fe=a.current,we=fe.clientWidth,Ce=fe.clientHeight;S({width:we,height:Ce})};return Q(),window.addEventListener("resize",Q),()=>window.removeEventListener("resize",Q)},[]),N.useEffect(()=>{const Q=u.current;if(!Q||w.width===0||w.height===0)return;const fe=Q.getContext("2d");if(!fe)return;const we=window.devicePixelRatio||1;Q.width=Math.round(w.width*we),Q.height=Math.round(w.height*we),Q.style.width=`${w.width}px`,Q.style.height=`${w.height}px`,fe.setTransform(we,0,0,we,0,0)},[w.width,w.height]),N.useEffect(()=>{const Q=z.map(we=>Nt.resolvePath(`/images/${r.currPOV}/body/${we.fileName}`)),fe=W.map(we=>Nt.resolvePath(`/images/${r.currPOV}/face/${we.fileName}`));[...Q,...fe].forEach(we=>{A(we)})},[r.currPOV,z,W,A]),N.useEffect(()=>{const Q=u.current;if(!Q)return;const fe=Q.getContext("2d");if(!fe||(fe.imageSmoothingEnabled=!0,fe.imageSmoothingQuality="high",fe.clearRect(0,0,w.width,w.height),fe.fillStyle="#F0E4E0",fe.fillRect(0,0,w.width,w.height),!V))return;const we=Nt.resolvePath(`/images/${r.currPOV}/body/${V.fileName}`),Ce=V.hideFace!==!0&&!!Y,Re=Ce?Nt.resolvePath(`/images/${r.currPOV}/face/${Y?.fileName??""}`):null;let Fe=!1;return(async()=>{const[Ze,ze]=await Promise.all([A(we),Ce&&Re?A(Re):Promise.resolve(null)]);if(Fe)return;const Je=Ye=>{if(!Ye.width||!Ye.height)return;const Mt=w.width/w.height||1,gt=Ye.width/Ye.height||1;let ut=w.width,nt=w.height,Ke=0,et=0;gt>Mt?(nt=w.width/gt,et=(w.height-nt)/2):(ut=w.height*gt,Ke=(w.width-ut)/2),fe.drawImage(Ye,Ke,et,ut,nt)};Je(Ze),Ce&&ze&&Je(ze)})(),()=>{Fe=!0}},[r.currPOV,w.height,w.width,A,V,Y]),N.useEffect(()=>{const Q=c.current;if(!Q){E(0);return}const{scrollLeft:fe,scrollWidth:we,clientWidth:Ce}=Q,Re=we-Ce,Fe=Re>0?fe/Re:0;E(Fe)},[z.length]),N.useEffect(()=>{const Q=p.current;if(!Q){I(0);return}const{scrollLeft:fe,scrollWidth:we,clientWidth:Ce}=Q,Re=we-Ce,Fe=Re>0?fe/Re:0;I(Fe)},[W.length]);const ue=()=>{const Q=c.current;if(!Q){E(0);return}const{scrollLeft:fe,scrollWidth:we,clientWidth:Ce}=Q,Re=we-Ce,Fe=Re>0?fe/Re:0;E(Fe)},oe=()=>{const Q=p.current;if(!Q){I(0);return}const{scrollLeft:fe,scrollWidth:we,clientWidth:Ce}=Q,Re=we-Ce,Fe=Re>0?fe/Re:0;I(Fe)},me="w-[180px] max-w-full";return h.jsxs("div",{className:"w-full flex flex-col items-center gap-1.5 relative",children:[h.jsx("div",{className:xe("border-2 border-matcha-300 character-frame mx-auto relative sticker-card box-content",me),children:h.jsxs("div",{ref:a,className:"relative w-full",style:{aspectRatio:"904 / 1600"},onClick:L&&B!=="loop"?J:void 0,role:L&&B!=="loop"?"button":void 0,"aria-label":L&&B!=="loop"?"":void 0,children:[L&&P&&h.jsx("video",{ref:f,className:"absolute inset-0 w-full h-full rounded-lg object-contain bg-paper-cream",src:_,loop:B==="loop",autoPlay:!0,controls:!1,playsInline:!0,onEnded:se},_),h.jsx("canvas",{ref:u,className:xe("absolute inset-0 w-full h-full rounded-lg select-none",L?"opacity-0 pointer-events-none":"opacity-100")}),he&&h.jsx("button",{type:"button",onClick:ne,className:"absolute top-2 right-2 z-10 rounded-full border-2 border-dashed border-sakura-300 bg-paper-cream px-1 text-xs text-sakura-800 transition-transform hover:scale-105 active:scale-95","aria-label":_e,children:ge})]})}),h.jsx("button",{type:"button",onClick:()=>M(Q=>!Q),className:xe("flex items-center justify-center w-5 h-5 rounded-full","bg-paper-cream text-sakura-800 text-[7px] leading-none shadow-none","transition-transform active:scale-95 hover:scale-105"),"aria-expanded":b,"aria-label":b?"":"",children:h.jsx("span",{className:xe("inline-block transition-transform duration-200",b?"rotate-180":"rotate-0"),"aria-hidden":!0,children:""})}),h.jsx("div",{className:xe("w-full portrait-collapse",b?"portrait-collapse--open":"portrait-collapse--closed"),"aria-hidden":!b,children:h.jsx("div",{className:xe("flex flex-col gap-2 pt-1 pb-1",me,"mx-auto"),children:(z.length>0||W.length>0)&&h.jsxs("div",{className:xe("bg-surface border-2 border-matcha-300 rounded-xl px-0 py-2 space-y-2 overflow-hidden",me,"mx-auto"),children:[z.length>0&&h.jsxs("div",{className:"space-y-1",children:[h.jsx("div",{ref:c,className:"relative w-full portrait-selector-scroll",onScroll:ue,...y,children:h.jsx("div",{className:"flex items-center gap-1.5 pb-1 px-2 min-w-max",children:z.map(Q=>h.jsx("button",{type:"button",onClick:()=>{(K.get(Q.id)??!0)&&o({bodyId:Q.id})},"aria-disabled":!(K.get(Q.id)??!0),className:xe("whitespace-nowrap rounded-full border-2 border-dashed px-2.5 py-1 text-[11px] leading-tight","transition-transform active:scale-95",K.get(Q.id)??!0?V?.id===Q.id?"bg-mist-300 border-mist-500 text-charcoal-800":"bg-mist-50 border-mist-300 text-mist-700 hover:bg-mist-100":"bg-mist-50 border-mist-200 text-mist-400 opacity-60 cursor-not-allowed"),children:Q.name},Q.id))})}),h.jsx("div",{className:"h-0.5 w-full portrait-selector-track rounded-full",children:h.jsx("div",{className:"h-full w-full portrait-selector-thumb",style:{width:`${Math.max(0,Math.min(1,k))*100}%`}})})]}),W.length>0&&h.jsxs("div",{className:"space-y-1",children:[h.jsx("div",{ref:p,className:"relative w-full portrait-selector-scroll",onScroll:oe,...v,children:h.jsx("div",{className:"flex items-center gap-1.5 pb-1 px-2 min-w-max",children:W.map(Q=>h.jsx("button",{type:"button",onClick:()=>{o({faceId:Q.id})},className:xe("whitespace-nowrap rounded-full border-2 border-dashed px-2.5 py-1 text-[11px] leading-tight","transition-transform active:scale-95",Y?.id===Q.id?"bg-mist-300 border-mist-500 text-charcoal-800":"bg-mist-50 border-mist-300 text-mist-700 hover:bg-mist-100"),children:Q.name},Q.id))})}),h.jsx("div",{className:"h-0.5 w-full portrait-selector-track rounded-full",children:h.jsx("div",{className:"h-full w-full portrait-selector-thumb",style:{width:`${Math.max(0,Math.min(1,C))*100}%`}})})]})]})})})]})}function Q0(r){return r===ke.SHINO?"E:"E}function wc(){const r=pt("topFlagState"),n=pt("basic"),s=pt("statusCard"),o=pt("dashboardGauges"),a=Q0(n.currPOV),u=N.useMemo(()=>({characterName:a,mood:s.mood,location:s.location,displayTitle:s.displayTitle,trueTitle:s.trueTitle,fatigue:s.fatigue,desire:s.desire,will:s.will,san:s.san,avatar:s.avatar}),[a,s.avatar,s.desire,s.displayTitle,s.fatigue,s.location,s.mood,s.san,s.trueTitle,s.will]),f=N.useMemo(()=>({addiction:o.addiction,obedience:o.obedience,moralScale:o.moralScale,corruption:o.corruption}),[o.addiction,o.corruption,o.moralScale,o.obedience]);return{characterName:a,woodenSignTime:r.currentTime,statusCardProps:u,gaugesValues:f}}function q0(r){if(!r)return null;const s=r.replace(/[./]/g,"-").replace(//g,"-").replace(/Eg,"-").replace(/[]/g,"").trim().split("-").filter(Boolean);if(s.length>=2){const o=Number(s[s.length-2]),a=Number(s[s.length-1]);if(Number.isFinite(o)&&Number.isFinite(a))return`${o}E{a}`}return r.trim()||null}function bc({currentTime:r,className:n}){const s=(r??"").trim(),[o,...a]=s.split(/\s+/),u=q0(o),f=a.join(" ").trim()||null;return h.jsxs("div",{"aria-label":"wooden-sign",className:`border-2 border-matcha-300 wooden-sign sticker-card mx-auto ${n??""}`.trim(),children:[h.jsx("div",{className:"absolute top-3 left-3 w-1.5 h-1.5 bg-charcoal-600 rounded-full"}),h.jsx("div",{className:"absolute top-3 right-3 w-1.5 h-1.5 bg-charcoal-600 rounded-full"}),h.jsx("div",{className:"flex flex-col items-center justify-center gap-1 p-3",children:h.jsx("div",{className:"w-[calc(100%-16px)] rounded-lg border border-charcoal-200 border-dashed px-3 py-2 text-center bg-paper-cream/60",children:u&&f?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"px-2.5 py-0.5 rounded-full bg-matcha-50 border border-matcha-300 text-charcoal-700 text-[11px] leading-none font-primary tracking-wide",children:u}),h.jsx("div",{className:"mt-1 text-charcoal-900 font-cpTitle text-2xl font-bold leading-tight",children:f})]}):h.jsx("div",{className:"px-3 py-1 rounded-xl bg-matcha-50 border border-matcha-300 text-charcoal-900 text-base font-semibold font-cpTitle",children:s})})})]})}const $p={povTarget:null,forceEscapeEvent:!1,encourageLewd:!1,forbidLewd:!1,suppressDespair:!1};function Z0(r){return r?!!(r.povTarget||r.forceEscapeEvent||r.encourageLewd||r.forbidLewd||r.suppressDespair):!1}function jf(r){return r===ke.RINA?ke.SHINO:ke.RINA}function J0(r){return r===ke.RINA?"E:"EE}const Bp=new Set(["b","del","br","hr","ul","ol","li"]),kc=new Set(["br","hr"]);function Ql(r){return r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function ey(r){try{const s=new DOMParser().parseFromString(r,"text/html");let o="";const a=u=>{if(u.nodeType===Node.TEXT_NODE){const f=u.data.replace(/\r\n/g,`
`);return Ql(f).replace(/\n/g,"<br>")}if(u.nodeType===Node.ELEMENT_NODE){const f=u,c=f.tagName.toLowerCase();if(!Bp.has(c)){let g="";return f.childNodes.forEach(y=>{g+=a(y)}),g}if(kc.has(c))return`<${c}>`;let p="";return f.childNodes.forEach(g=>{p+=a(g)}),`<${c}>${p}</${c}>`}return""};return s.body.childNodes.forEach(u=>{o+=a(u)}),o}catch{return Ql(r.replace(/\r\n/g,`
`)).replace(/\n/g,"<br>")}}function Up(r){if(r.nodeType===Node.TEXT_NODE)return r.data.length;if(r.nodeType===Node.ELEMENT_NODE){const n=r,s=n.tagName.toLowerCase();if(kc.has(s))return 1;let o=0;return n.childNodes.forEach(a=>{o+=Up(a)}),o}return 0}function ql(r,n){if(n<=0)return{html:"",remaining:n,visible:!1};if(r.nodeType===Node.TEXT_NODE){const s=r.data;if(!s)return{html:"",remaining:n,visible:!1};const o=s.slice(0,n);return{html:Ql(o),remaining:n-o.length,visible:o.length>0}}if(r.nodeType===Node.ELEMENT_NODE){const s=r,o=s.tagName.toLowerCase();if(!Bp.has(o)){let c="",p=n,g=!1;return s.childNodes.forEach(y=>{if(p<=0)return;const v=ql(y,p);v.visible&&(c+=v.html,g=!0),p=v.remaining}),{html:c,remaining:p,visible:g}}if(kc.has(o))return n<=0?{html:"",remaining:n,visible:!1}:{html:`<${o}>`,remaining:n-1,visible:!0};let a="",u=n,f=!1;return s.childNodes.forEach(c=>{if(u<=0)return;const p=ql(c,u);p.visible&&(a+=p.html,f=!0),u=p.remaining}),f?{html:`<${o}>${a}</${o}>`,remaining:u,visible:!0}:{html:"",remaining:u,visible:!1}}return{html:"",remaining:n,visible:!1}}function ty(r,n){let s="",o=n;for(const a of Array.from(r)){if(o<=0)break;const{html:u,remaining:f}=ql(a,o);s+=u,o=f}return s}function ny({content:r,typingEnabled:n,typingSpeed:s,className:o,style:a,onComplete:u}){const f=N.useMemo(()=>ey(r),[r]),c=N.useMemo(()=>new DOMParser().parseFromString(f,"text/html"),[f]),p=N.useMemo(()=>{let b=0;return c.body.childNodes.forEach(M=>{b+=Up(M)}),b},[c]),[g,y]=N.useState(0),[v,w]=N.useState(!1),[S,k]=N.useState(!1),E=N.useRef(null);N.useEffect(()=>{if(E.current!==null&&(window.clearInterval(E.current),E.current=null),!f||p===0){y(0),w(!1),k(!1);return}if(!n){y(p),w(!1),k(!1),u?.();return}return y(0),w(!0),k(!0),E.current=window.setInterval(()=>{y(b=>{const M=Math.min(b+1,p);return M>=p&&(E.current!==null&&(window.clearInterval(E.current),E.current=null),w(!1),k(!1),u?.()),M})},s),()=>{E.current!==null&&(window.clearInterval(E.current),E.current=null)}},[u,f,p,n,s]),N.useEffect(()=>{if(!v)return;const b=window.setInterval(()=>{k(M=>!M)},530);return()=>{window.clearInterval(b)}},[v]);const C=N.useMemo(()=>!f||p===0?"":ty(c.body.childNodes,g),[c,f,p,g]),I=N.useMemo(()=>{if(!v)return C;const b=xe("inline-block w-2 h-5 bg-charcoal-800 ml-1 align-middle",S?"opacity-100":"opacity-0");return`${C}<span class="${b}"></span>`},[v,C,S]);return h.jsx("div",{className:xe("relative",o),style:a,dangerouslySetInnerHTML:{__html:I}})}const ry=({currentMap:r,canGoBack:n,onBack:s,onResetNavigation:o})=>h.jsx("div",{className:"flex items-center justify-between gap-2 text-xs",children:h.jsxs("div",{className:"flex items-center gap-2",children:[n&&h.jsxs("button",{type:"button",onClick:s,className:"inline-flex items-center gap-1 rounded-full bg-white/80 px-2 py-1 text-[11px] text-slate-600 shadow-sm transition hover:bg-white",children:[h.jsx("span",{className:"text-[10px]",children:"E}),h.jsx("span",{children:"E})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"rounded-full bg-white/80 px-3 py-1 text-[11px] text-pink-600 shadow-sm",children:r.name??`EE{r.id}`}),n&&h.jsx("button",{type:"button",onClick:o,className:"flex h-7 w-7 items-center justify-center rounded-full border border-pink-200 bg-white/80 text-pink-500 transition hover:bg-pink-50","aria-label":"E,children:h.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[h.jsx("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),h.jsx("path",{d:"M3 3v5h5"})]})})]})]})}),Hp=({text:r,className:n,variant:s="dark"})=>{if(!r)return null;const o=/(<(?:sakura|matcha|mist|lavender)>.*?<\/(?:sakura|matcha|mist|lavender)>)/g,a=r.split(o),u=s==="light"?{sakura:"text-sakura-700",matcha:"text-matcha-700",mist:"text-mist-700",lavender:"text-lavender-700"}:{sakura:"text-sakura-300",matcha:"text-matcha-300",mist:"text-mist-300",lavender:"text-lavender-300"},f="mx-0.5 font-semibold";return h.jsx("span",{className:n,children:a.map((c,p)=>{if(c.startsWith("<sakura>")){const g=c.replace(/<\/?sakura>/g,"");return h.jsx("span",{className:`${f} ${u.sakura}`,children:g},p)}if(c.startsWith("<matcha>")){const g=c.replace(/<\/?matcha>/g,"");return h.jsx("span",{className:`${f} ${u.matcha}`,children:g},p)}if(c.startsWith("<mist>")){const g=c.replace(/<\/?mist>/g,"");return h.jsx("span",{className:`${f} ${u.mist}`,children:g},p)}if(c.startsWith("<lavender>")){const g=c.replace(/<\/?lavender>/g,"");return h.jsx("span",{className:`${f} ${u.lavender}`,children:g},p)}return h.jsx("span",{className:f,children:c},p)})})},sy={door:"",star:"E,info:"EE,shop:"E,stairs:"EE,garden:"",board:"",save:"",classroom:"",book:"",balcony:"",npc:"",counter:"",seat:"E,booth:"EE,kitchen:"",cat:"",gate:"",fountain:"EE,bench:"E,tree:"",secret:""},iy=({facility:r,isCurrent:n,isInPreview:s,isHovered:o,onClick:a,onMouseEnter:u,onMouseLeave:f,renderIcon:c})=>{const p=()=>{a(r.id)},g=r.icon?sy[r.icon]||r.icon:"E,y=r.enterable,v=r.y>20,w=r.x<20?"left":r.x>80?"right":"center",[S,k]=Ge.useState(v?"top":"bottom"),[E,C]=Ge.useState(w),I=Ge.useRef(null),b=Ge.useRef(null);Ge.useLayoutEffect(()=>{if(!o)return;const te=I.current,K=b.current;if(!te||!K)return;const z=te.closest("[data-map-canvas]");if(!z)return;const W=z.getBoundingClientRect(),ae=te.getBoundingClientRect(),ee=K.getBoundingClientRect(),he=8,Z=ee.height,ce=ee.width,O=W.top+4,V=W.bottom-4,Y=W.left+4,P=W.right-4,_={top:ae.top-Z-he,bottom:ae.top-he},B={top:ae.bottom+he,bottom:ae.bottom+Z+he},X=_.top>=O&&_.bottom<=V,J=B.top>=O&&B.bottom<=V;let ne;if(X&&!J)ne="top";else if(!X&&J)ne="bottom";else if(X&&J)ne=v?"top":"bottom";else{const oe=Math.min(_.bottom,V)-Math.max(_.top,O),me=Math.min(B.bottom,V)-Math.max(B.top,O);ne=oe>=me?"top":"bottom"}const se=ae.left+ae.width/2,pe=oe=>oe==="center"?{left:se-ce/2,right:se+ce/2}:oe==="left"?{left:ae.left,right:ae.left+ce}:{left:ae.right-ce,right:ae.right},ge=["center","left","right"],_e={left:0,center:0,right:0},A={left:!1,center:!1,right:!1};ge.forEach(oe=>{const me=pe(oe),Q=Math.min(me.right,P)-Math.max(me.left,Y);_e[oe]=Q,A[oe]=me.left>=Y&&me.right<=P});let ue="center";A.center||A.left||A.right?A.center?ue="center":A.left&&A.right?ue=w:A.left?ue="left":A.right&&(ue="right"):ue=ge.reduce((oe,me)=>_e[me]>_e[oe]?me:oe,"center"),k(ne),C(ue)},[o,v,w]);const M=S==="top"?"bottom-full mb-2":"top-full mt-2",D=E==="left"?"left-0":E==="right"?"right-0":"left-1/2",L=S==="top"?"top-full border-t-4 border-t-slate-800":"bottom-full border-b-4 border-b-slate-800",F=E==="left"?"left-6":E==="right"?"right-6":"left-1/2",H=E==="center"?{transform:"translateX(-50%)"}:void 0,q=E==="center"?{transform:"translateX(-50%)"}:void 0;return h.jsxs("div",{ref:I,className:["absolute",o?"z-30":"z-10"].join(" "),style:{left:`${r.x}%`,top:`${r.y}%`,transform:"translate(-50%, -50%)"},children:[h.jsxs("button",{type:"button",onClick:p,onMouseEnter:u,onMouseLeave:f,className:["group relative h-12 w-12 rounded-full border-2 backdrop-blur-sm transition-all duration-200 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2",y?"bg-sky-50/90 border-sky-200 hover:bg-sky-100/90":"bg-rose-50/90 border-rose-200 hover:bg-rose-100/90",n?"ring-2 ring-pink-400 ring-offset-2 ring-offset-transparent":"",s?"border-pink-400":"",o?"border-orange-300 ring-2 ring-orange-200/50":""].join(" "),children:[h.jsx("div",{className:["flex h-full w-full items-center justify-center text-xl transition-colors",y?"text-sky-600":"text-rose-600"].join(" "),children:c?c(r):h.jsx("span",{children:g})}),n&&h.jsx("div",{className:"absolute -top-1 -right-1 h-4 w-4 rounded-full bg-pink-500 border-2 border-white animate-pulse"})]}),h.jsx("div",{className:"absolute top-full left-1/2 mt-1 whitespace-nowrap",style:{transform:"translateX(-50%)"},children:h.jsx("div",{className:["px-2 py-0.5 rounded-md text-xs font-medium text-center backdrop-blur-sm border transition-all duration-200",y?"bg-sky-100/80 border-sky-200 text-sky-700":"bg-rose-100/80 border-rose-200 text-rose-700"].join(" "),children:r.meta?.name??""})}),o&&h.jsxs("div",{ref:b,className:["absolute rounded-md bg-slate-800 px-3 py-2 text-sm text-white shadow-lg pointer-events-none transition-opacity duration-200 min-w-[350px] max-w-[400px]",M,D].join(" "),style:H,children:[h.jsxs("div",{className:"space-y-1 text-left",children:[h.jsx("div",{className:"font-medium text-base",children:r.meta?.name??""}),r.meta?.description&&h.jsx(Hp,{text:r.meta.description,className:"block text-xs text-slate-300 leading-relaxed whitespace-pre-wrap",variant:"dark"}),!r.meta?.description&&h.jsx(h.Fragment,{children:y?h.jsx("div",{className:"text-xs text-sky-300",children:"E"}):r.isTerminal&&h.jsx("div",{className:"text-xs text-rose-300",children:"E"})})]}),h.jsx("div",{className:["absolute border-l-4 border-r-4 border-transparent",L,F].join(" "),style:q})]})]})},oy=({map:r,currentFacilityId:n,characterFacilityId:s,previewPath:o,onFacilityClick:a,renderFacilityIcon:u})=>{const f=Object.values(r.facilities),[c,p]=N.useState(null),g=N.useMemo(()=>(k,E)=>{if(!k||!E||k===E)return[];const C=[k],I=new Set([k]),b=new Map;for(;C.length>0;){const M=C.shift();if(M===E)break;const D=r.facilities[M];if(D){for(const L of D.neighbors)if(!I.has(L)&&(I.add(L),b.set(L,M),C.push(L),L===E)){const F=[E];let H=E;for(;H!==k;)H=b.get(H),F.unshift(H);return F}}}return[]},[r.facilities]),v=N.useMemo(()=>!n||!c?null:g(n,c),[n,c,g])||o,w=N.useMemo(()=>new Set(o??[]),[o]),S=N.useMemo(()=>{const k=[],E=new Set;return f.forEach(C=>{C.neighbors.forEach(I=>{const b=r.facilities[I];if(!b)return;const M=[C.id,b.id].sort().join("-");E.has(M)||(E.add(M),k.push([C.id,b.id]))})}),k},[f,r.facilities]);return h.jsxs("div",{className:"relative h-full w-full",children:[h.jsxs("div",{className:"pointer-events-none absolute inset-0 opacity-30",children:[h.jsx("div",{className:"absolute -left-10 -top-10 h-40 w-40 rounded-full bg-pink-200/40 blur-2xl"}),h.jsx("div",{className:"absolute -right-10 bottom-0 h-40 w-40 rounded-full bg-sky-200/40 blur-2xl"})]}),h.jsx("svg",{className:"absolute inset-0 h-full w-full",viewBox:"0 0 100 100",preserveAspectRatio:"none",shapeRendering:"crispEdges",children:S.map(([k,E])=>{const C=r.facilities[k],I=r.facilities[E];if(!C||!I)return null;const b=[k,E].sort().join("-");return v&&v.some((D,L)=>{if(L===v.length-1)return!1;const F=v[L],H=v[L+1];return F===C.id&&H===I.id||F===I.id&&H===C.id})?null:h.jsx("line",{x1:C.x,y1:C.y,x2:I.x,y2:I.y,stroke:"rgba(219, 233, 254, 0.7)",strokeWidth:5,vectorEffect:"non-scaling-stroke",style:{shapeRendering:"crispEdges",transition:"stroke 0.2s, stroke-width 0.2s"}},b)})}),h.jsx("svg",{className:"absolute inset-0 h-full w-full z-10",viewBox:"0 0 100 100",preserveAspectRatio:"none",shapeRendering:"crispEdges",children:S.map(([k,E])=>{const C=r.facilities[k],I=r.facilities[E];if(!C||!I)return null;const b=[k,E].sort().join("-");return v&&v.some((D,L)=>{if(L===v.length-1)return!1;const F=v[L],H=v[L+1];return F===C.id&&H===I.id||F===I.id&&H===C.id})?h.jsx("line",{x1:C.x,y1:C.y,x2:I.x,y2:I.y,stroke:"#ff8c42",strokeWidth:7,vectorEffect:"non-scaling-stroke",style:{shapeRendering:"crispEdges",transition:"stroke 0.2s, stroke-width 0.2s",filter:"drop-shadow(0 0 2px rgba(255, 140, 66, 0.3))"}},b):null})}),f.map(k=>{const E=k.id===s,C=w.has(k.id),I=k.id===c;return h.jsx(iy,{facility:k,isCurrent:E,isInPreview:C,isHovered:I,onClick:a,onMouseEnter:()=>p(k.id),onMouseLeave:()=>p(null),renderIcon:u},k.id)})]})};function Wp(r,n,s){if(!r||r.length===0)return[];const a=r.some(y=>y.facilityId===n)?r:[...r,{mapId:r[r.length-1].mapId,facilityId:n}],u=a.map((y,v)=>{const S=!!(s[y.mapId]?.facilities?.[y.facilityId]?.enterable&&v<a.length-1);return{...y,isIntermediateGateway:S,isVisible:!S}}),f=[];if(u.length>0){let y={mapId:u[0].mapId,nodes:[],hasVisibleNodes:!1};for(const v of u)v.mapId!==y.mapId&&(f.push(y),y={mapId:v.mapId,nodes:[],hasVisibleNodes:!1}),y.nodes.push(v),v.isVisible&&(y.hasVisibleNodes=!0);f.push(y)}const c=f.filter(y=>y.hasVisibleNodes),p=[],g=y=>s[y]?.name||y;for(let y=0;y<c.length;y++){const v=c[y],w=y>0?c[y-1]:null;w&&w.mapId!==v.mapId&&(p.push({type:"transition_leave",text:`E{g(w.mapId)}`,mapId:w.mapId}),p.push({type:"transition_enter",text:`EE{g(v.mapId)}`,mapId:v.mapId}));for(const S of v.nodes)if(S.isVisible){const E=s[S.mapId]?.facilities?.[S.facilityId]?.meta?.name||S.facilityId;p.push({type:"node",text:E,mapId:S.mapId,facilityId:S.facilityId})}}return p}const ay=({open:r,target:n,isLoading:s,previewPathNodes:o,maps:a,onCancel:u,onConfirm:f})=>{if(!r||!n||typeof document>"u")return null;const c=n.enterable,p=()=>{if(!o||o.length===0||!n)return null;const g=Wp(o,n.id,a),y=[];if(g.forEach((w,S)=>{y.push(h.jsx("div",{className:"flex flex-col gap-1",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("span",{className:"text-xs text-slate-500",children:[S+1,"."]}),h.jsx("span",{className:"text-xs font-medium text-slate-700",children:w.text})]})},`${w.type}-${S}`)),S<g.length-1&&y.push(h.jsx("div",{className:"ml-4 text-xs text-slate-400",children:"E},`arrow-${S}`))}),g.length<=5)return y;const v=[];return v.push(y[0]),v.push(y[1]),v.push(h.jsxs("div",{className:"flex flex-col gap-1",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-xs text-slate-400",children:""}),h.jsxs("span",{className:"text-xs text-slate-400",children:["EE",g.length-2," EE]})]}),h.jsx("div",{className:"ml-4 text-xs text-slate-400",children:"E})]},"ellipsis-short")),v.push(y[y.length-1]),v};return h.jsxs(gc,{open:r,containerClassName:"!w-[80%]",children:[h.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[h.jsx("div",{className:"h-8 w-8 rounded-full bg-pink-100 text-center text-lg",children:h.jsx("span",{className:"align-middle",children:"E})}),h.jsxs("div",{children:[h.jsx("div",{className:"text-sm font-semibold text-slate-800",children:c?"EE:"E}),n?.meta?.name&&h.jsxs("div",{className:"text-xs text-pink-500",children:["EE,n.meta.name]})]})]}),n.meta?.description&&h.jsxs("div",{className:"mb-3 rounded-2xl bg-pink-50/60 p-3 text-xs text-slate-700",children:[h.jsx("div",{className:"mb-1 font-semibold text-pink-600",children:c?"E:"E}),h.jsx(Hp,{text:n.meta.description,className:"block text-[11px] whitespace-pre-wrap",variant:"light"})]}),o&&o.length>0&&h.jsxs("div",{className:"mb-3 rounded-2xl bg-amber-50/60 p-3",children:[h.jsx("div",{className:"mb-2 text-xs font-semibold text-amber-600",children:"EE}),h.jsx("div",{className:"space-y-1",children:p()})]}),h.jsxs("div",{className:"flex justify-end gap-2 text-xs",children:[h.jsx("button",{type:"button",onClick:u,disabled:s,className:"rounded-full bg-slate-100 px-3 py-1 text-slate-600 transition hover:bg-slate-200 disabled:opacity-60",children:""}),h.jsx("button",{type:"button",onClick:f,disabled:s,className:"rounded-full bg-pink-500 px-4 py-1 text-white shadow-sm transition hover:bg-pink-600 disabled:opacity-60",children:s?"":c?"EE:""})]})]})};function ly(r,n,s){if(n.mapId===s.mapId&&n.facilityId===s.facilityId)return[n];const o=[{node:n,path:[n]}],a=new Set;for(a.add(`${n.mapId}:${n.facilityId}`);o.length>0;){const{node:u,path:f}=o.shift();if(u.mapId===s.mapId&&u.facilityId===s.facilityId)return f;const c=r[u.mapId];if(!c)continue;const p=c.facilities[u.facilityId];if(p){for(const g of p.neighbors){const y=`${u.mapId}:${g}`;if(!a.has(y)){a.add(y);const v={mapId:u.mapId,facilityId:g};o.push({node:v,path:[...f,v]})}}if(p.enterable&&p.childMapId){const g=r[p.childMapId];if(g){const v=g.facilities[u.mapId]?.id??g.entryFacilityId??Object.keys(g.facilities)[0];if(v){const w=`${p.childMapId}:${v}`;if(!a.has(w)){a.add(w);const S={mapId:p.childMapId,facilityId:v};o.push({node:S,path:[...f,S]})}}}}}}return null}function cy(r,n){const s=r.findIndex(o=>o.mapId===n.mapId&&o.facilityId===n.facilityId);return s>=0?r.slice(0,s+1):[...r,n]}function uy({maps:r,initialMapId:n,initialFacilityId:s,mapPosition:o,onTravel:a,onPositionChange:u,isSending:f}){const[c,p]=N.useState(()=>{const I=r[n],b=s??I?.entryFacilityId??Object.values(I?.facilities??{})[0]?.id??null;return{currentMapId:n,currentFacilityId:b,stack:[],previewPath:null,previewPathNodes:null,previewTarget:null,previewTargetMapId:null,isTravelling:!1,message:null,historyStackBase:0}}),g=N.useMemo(()=>r[c.currentMapId],[r,c.currentMapId]),y=N.useMemo(()=>!g||!c.currentFacilityId?null:g.facilities[c.currentFacilityId]??null,[g,c.currentFacilityId]);N.useEffect(()=>{if(!o)return;const I=o.mapId??c.currentMapId;let b=o.facilityId??c.currentFacilityId;const M=r[I];M&&(M&&(!b||!M.facilities[b])&&(b=M.entryFacilityId??Object.values(M.facilities)[0]?.id??null),p(D=>D.currentMapId===I&&D.currentFacilityId===b?D:{...D,currentMapId:I,currentFacilityId:b}))},[o?.facilityId,o?.mapId,r]);const v=N.useCallback((I,b)=>{p(M=>({...M,currentMapId:I,currentFacilityId:b})),b&&u&&u({mapId:I,facilityId:b})},[u]),w=N.useCallback(I=>{if(c.isTravelling||!g)return;const b=g.facilities[I];if(!b)return;if(b.enterable&&b.childMapId){const q=r[b.childMapId];if(!q)return;const K=q.facilities[c.currentMapId]?.id??q.entryFacilityId??Object.values(q.facilities??{})[0]?.id??null;p(z=>{const W=cy(z.stack,{mapId:z.currentMapId,facilityId:z.currentFacilityId}),ae=Math.min(z.historyStackBase,W.length);return{...z,stack:W,currentMapId:b.childMapId,currentFacilityId:K,previewPath:null,previewPathNodes:null,previewTarget:null,previewTargetMapId:null,message:`E${b.meta?.name||"E}`,historyStackBase:ae}});return}const M=o?.mapId||n,D=o?.facilityId||s||r[M]?.entryFacilityId||Object.keys(r[M]?.facilities||{})[0],L=ly(r,{mapId:M,facilityId:D},{mapId:c.currentMapId,facilityId:I});if(!L||L.length===0){p(q=>({...q,previewPath:null,previewPathNodes:null,previewTarget:null,previewTargetMapId:null,message:"EE}));return}const H=L.filter(q=>q.mapId===c.currentMapId).map(q=>q.facilityId);if(L.length===1&&L[0].facilityId===D&&L[0].mapId===M){p(q=>({...q,previewPath:null,previewPathNodes:null,previewTarget:null,previewTargetMapId:null,message:null}));return}p(q=>({...q,previewPath:H,previewPathNodes:L,previewTarget:b,previewTargetMapId:c.currentMapId,message:null}))},[g,r,c.currentFacilityId,c.currentMapId,c.historyStackBase,c.isTravelling,c.stack,o,n,s]),S=N.useCallback(()=>{const I=r[n],b=s??I?.entryFacilityId??Object.values(I?.facilities??{})[0]?.id??null;p({currentMapId:n,currentFacilityId:b,stack:[],previewPath:null,previewPathNodes:null,previewTarget:null,previewTargetMapId:null,isTravelling:!1,message:null,historyStackBase:0})},[s,n,r]),k=N.useCallback(()=>{c.isTravelling||p(I=>({...I,previewPath:null,previewPathNodes:null,previewTarget:null,previewTargetMapId:null,message:null}))},[c.isTravelling]);N.useEffect(()=>{f!==void 0&&!f&&c.isTravelling&&p(I=>({...I,isTravelling:!1,previewPath:null,previewPathNodes:null,previewTarget:null,previewTargetMapId:null}))},[f,c.isTravelling]);const E=N.useCallback(async()=>{if(!c.previewTarget||!c.previewPath||!c.previewPathNodes||!g||!c.currentFacilityId||c.previewPathNodes.length===0)return;const I=c.currentFacilityId;c.previewTargetMapId||c.currentMapId,c.previewPathNodes[c.previewPathNodes.length-1].facilityId;const b=c.previewPathNodes.filter(L=>L.mapId===c.currentMapId).map(L=>L.facilityId),M={mapId:g.id,from:I,to:b[b.length-1],path:b,fullPathNodes:c.previewPathNodes};p(L=>({...L,isTravelling:!0,message:null}));let D=null;try{D=await a(M)}catch(L){console.error("Travel handler error:",L),p(F=>({...F,isTravelling:!1,message:"EEEE}));return}if(!D){p(L=>({...L,isTravelling:!1,message:"EE"}));return}p(L=>({...L,isTravelling:!1,previewPath:null,previewPathNodes:null,previewTarget:null,previewTargetMapId:null,message:D.success?"EEE:D.reason??"EEE,historyStackBase:L.stack.length}))},[g,a,c.currentMapId,c.currentFacilityId,c.previewPathNodes,c.previewTargetMapId,c.previewTarget,c.previewPath]),C=N.useCallback(()=>{if(c.isTravelling)return;const I=c.stack[c.stack.length-1];I&&p(b=>({...b,currentMapId:I.mapId,currentFacilityId:I.facilityId,stack:b.stack.slice(0,-1),previewPath:null,previewPathNodes:null,previewTarget:null,previewTargetMapId:null,message:null,historyStackBase:Math.min(b.historyStackBase,b.stack.length-1)}))},[c.isTravelling,c.stack]);return{state:c,currentMap:g,currentFacility:y,handleFacilityClick:w,cancelPreview:k,confirmTravel:E,goBack:C,updatePosition:v,resetNavigation:S}}const dy=r=>{const n=r.travelDurationMs??6e4,s=r.isSending||!1,{state:o,currentMap:a,handleFacilityClick:u,cancelPreview:f,confirmTravel:c,goBack:p,resetNavigation:g}=uy(r),y=(()=>{if(!(!r.mapPosition?.mapId||!a)){if(r.mapPosition.mapId===a.id)return r.mapPosition.facilityId;if(a.facilities[r.mapPosition.mapId])return r.mapPosition.mapId}})();return a?h.jsxs("div",{className:"flex flex-col gap-3 rounded-[32px] border border-white/40 bg-pink-50 p-4",children:[h.jsx(ry,{currentMap:a,canGoBack:o.stack.length>0,onBack:p,onResetNavigation:g}),h.jsxs("div",{className:"relative h-[420px] w-full overflow-hidden rounded-[28px] bg-white/70 ring-1 ring-rose-100","data-map-canvas":!0,children:[h.jsx(oy,{map:a,currentFacilityId:y??o.currentFacilityId,characterFacilityId:y,previewPath:o.previewPath,onFacilityClick:u,renderFacilityIcon:r.renderFacilityIcon}),h.jsxs("div",{className:`absolute inset-0 z-30 flex flex-col items-center justify-center gap-5 bg-black/45 transition-opacity duration-200 ${o.isTravelling||s?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,children:[h.jsx("div",{className:"rounded-full border border-white/80 bg-black/35 px-5 py-2 text-sm font-cpTitle text-white",children:""}),h.jsx("div",{className:"h-3 w-4/5 max-w-[340px] overflow-hidden rounded-full border border-white/80 bg-black/35",children:h.jsx("div",{className:"h-full bg-sakura-300",style:{width:o.isTravelling||s?"100%":"0%",transitionProperty:"width",transitionTimingFunction:"linear",transitionDuration:`${o.isTravelling||s?n:240}ms`}})})]})]}),o.message&&h.jsx("div",{className:"rounded-2xl bg-white/85 px-3 py-2 text-xs text-pink-700",children:o.message}),h.jsx(ay,{open:!!o.previewPath,target:o.previewTarget,isLoading:o.isTravelling,previewPathNodes:o.previewPathNodes,maps:r.maps,onCancel:f,onConfirm:c})]}):h.jsx("div",{className:"rounded-2xl bg-pink-50 p-4 text-center text-sm text-pink-700",children:"EEE})},cs={city_map:{id:"city_map",name:"E,entryFacilityId:"residential_area",facilities:{central_district:{id:"central_district",x:45,y:52,neighbors:["residential_area","commercial_district","rich_district","seaside"],enterable:!0,childMapId:"central_district",icon:"",meta:{name:"E",description:`Emist></mist>EEEEEEmatcha>EE/matcha>...
E<sakura></sakura>Elavender>E/lavender>`}},residential_area:{id:"residential_area",x:35,y:68,neighbors:["central_district","commercial_district"],enterable:!0,childMapId:"residential_area",icon:"",meta:{name:"E",description:`EEE<mist></mist>EEEEEEEEsakura></sakura>E...
Ematcha>E/matcha>EE<lavender>E/lavender>E`}},commercial_district:{id:"commercial_district",x:60,y:60,neighbors:["central_district","residential_area","entertainment_district"],enterable:!0,childMapId:"commercial_district",icon:"EE,meta:{name:"E",description:`<mist></mist>EEEEEEsakura>EE/sakura>EEE<matcha>E/matcha>EEE..<lavender></lavender>E`}},entertainment_district:{id:"entertainment_district",x:78,y:75,neighbors:["commercial_district","slums"],enterable:!0,childMapId:"entertainment_district",icon:"",meta:{name:"E,description:`EEEmist></mist>EEEEEsakura>EE/sakura>EEEEEEEEmatcha>EE/matcha>E<lavender></lavender>EE`}},rich_district:{id:"rich_district",x:55,y:15,neighbors:["central_district","elite_academy"],enterable:!0,childMapId:"rich_district",icon:"",meta:{name:"",description:`EEmist></mist>EEEEEEsakura>E</sakura>EEE..
EEEEEEE<matcha></matcha>E<lavender></lavender>EE`}},elite_academy:{id:"elite_academy",x:78,y:12,neighbors:["rich_district"],enterable:!0,childMapId:"elite_academy",icon:"",meta:{name:"",description:`EEmist></mist>EEEEEEmatcha>E</matcha>E<sakura></sakura>EEElavender></lavender>...`}},slums:{id:"slums",x:90,y:75,neighbors:["entertainment_district"],enterable:!0,childMapId:"slums",icon:"EE,meta:{name:"",description:`E<mist></mist>EEE..
EE<matcha></matcha>EEE<sakura>EE/sakura>EE<lavender>E/lavender>EE`}},seaside:{id:"seaside",x:10,y:45,neighbors:["central_district"],enterable:!0,childMapId:"seaside",icon:"EE,meta:{name:"",description:`E<mist></mist>EEsakura>EE/sakura>EEEEEE<matcha>EE</matcha>...
E<lavender>E/lavender>`}}}},residential_area:{id:"residential_area",name:"E",entryFacilityId:"to_city_map",facilities:{apartment:{id:"apartment",x:25,y:50,neighbors:["to_city_map","store","coin_laundry"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"EEE,description:`EEmatcha></matcha>EEEmist></mist>E..EEEEEE<sakura>E/sakura>EEElavender>E/lavender>EE...`}},store:{id:"store",x:45,y:60,neighbors:["apartment","to_city_map"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"E,description:`Ematcha></matcha>EEE~
EEmist>E/mist>EEEEE<sakura></sakura>EElavender>E/lavender>E`}},park:{id:"park",x:70,y:75,neighbors:["to_city_map","clinic"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"",description:`EE<mist></mist>EEEEEEEmatcha>E</matcha>EEsakura></sakura>EE<lavender>E/lavender>E`}},clinic:{id:"clinic",x:65,y:30,neighbors:["to_city_map","park"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"",description:`EEEmist>E</mist>EEmatcha>E/matcha>EEEE...
EEE<sakura></sakura>EElavender>E/lavender>`}},coin_laundry:{id:"coin_laundry",x:20,y:80,neighbors:["apartment"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"",description:`EEEEmist>EE</mist>EEE<matcha>EE/matcha>...
<sakura></sakura>Elavender>E</lavender>EE`}},to_city_map:{id:"to_city_map",x:90,y:50,neighbors:["apartment","store","park","clinic"],enterable:!0,childMapId:"city_map",icon:"",meta:{name:"E",description:`EEEEmist></mist>EEEEEE<matcha></matcha>EE..
EEE<sakura></sakura>EElavender>E/lavender>E`}}}},commercial_district:{id:"commercial_district",name:"E",entryFacilityId:"from_city_map",facilities:{from_city_map:{id:"from_city_map",x:15,y:75,neighbors:["clothing_store","maid_cafe","massage_parlor"],enterable:!0,childMapId:"city_map",icon:"",meta:{name:"E",description:`EEEEmist>E/mist>EE<matcha>E/matcha>EEEEEEsakura>E</sakura><lavender></lavender>E`}},clothing_store:{id:"clothing_store",x:50,y:50,neighbors:["from_city_map","karaoke_box","cinema"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"EE,description:`EEsakura>E/sakura>EEEEEEEE<mist>E/mist>EE..
<matcha></matcha>E<lavender></lavender>`}},karaoke_box:{id:"karaoke_box",x:50,y:25,neighbors:["clothing_store","cinema"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"OK",description:`<mist></mist>EEEEEEEEE<matcha>EEE/matcha>EEEEsakura>E/sakura>EE<lavender></lavender>...`}},cinema:{id:"cinema",x:85,y:30,neighbors:["clothing_store","karaoke_box"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"",description:`EEEEE<mist>E/mist>EEEEmatcha>EE</matcha>EE<sakura>EE</sakura>EEElavender>E/lavender>E`}},maid_cafe:{id:"maid_cafe",x:70,y:75,neighbors:["from_city_map"],enterable:!1,isTerminal:!0,icon:"E,meta:{name:"EE,description:`EEsakura></sakura>EEEEmist></mist>EEEEEmatcha></matcha>EE<lavender>E/lavender>E`}},massage_parlor:{id:"massage_parlor",x:20,y:25,neighbors:["from_city_map"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"E,description:`EEmist>EE/mist>EEE<matcha>E/matcha>EEEEE<sakura>E/sakura>EE<lavender>E/lavender>`}}}},central_district:{id:"central_district",name:"E",entryFacilityId:"from_city_map",facilities:{from_city_map:{id:"from_city_map",x:50,y:50,neighbors:["tram_station","general_hospital","night_school"],enterable:!0,childMapId:"city_map",icon:"",meta:{name:"E,description:`EE<mist></mist>EEEE<matcha></matcha>...
E<sakura></sakura>EEEElavender>E/lavender>EE`}},tram_station:{id:"tram_station",x:50,y:80,neighbors:["from_city_map"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"",description:`...E<mist></mist>EEEEEEEmatcha>E</matcha>E<sakura>EE/sakura>EEElavender>EE/lavender>E`}},general_hospital:{id:"general_hospital",x:20,y:25,neighbors:["from_city_map"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"",description:`E...EEEEmist>E/mist>EEEEmatcha></matcha>EEEsakura>E/sakura>EEE<lavender>EE/lavender>EE`}},night_school:{id:"night_school",x:80,y:20,neighbors:["from_city_map"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"E",description:`EEEE<mist>EEE/mist>EEEmatcha></matcha>...
EEsakura>EE</sakura>EE<lavender></lavender>...`}}}},entertainment_district:{id:"entertainment_district",name:"E,entryFacilityId:"from_city_map",facilities:{from_city_map:{id:"from_city_map",x:10,y:50,neighbors:["pachinko_parlor","host_club","av_studio","adult_goods_store"],enterable:!0,childMapId:"city_map",icon:"EE,meta:{name:"E",description:`...EEEmist>EE</mist>EEEEEEmatcha></matcha>EEEEEEE...
EE<sakura></sakura>E<lavender>E/lavender>E}},soapland:{id:"soapland",x:80,y:70,neighbors:["av_studio","host_club","sm_club"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"",description:`EEmist>E/mist>EEEEE<matcha>EE/matcha>EEEEEEEEEsakura>EE/sakura>EE<lavender></lavender>`}},pachinko_parlor:{id:"pachinko_parlor",x:35,y:30,neighbors:["from_city_map","host_club"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"E,description:`EE<mist></mist>EEEE<matcha>E</matcha>EEEEEEEE<sakura>E</sakura><lavender>E/lavender>EE`}},host_club:{id:"host_club",x:40,y:75,neighbors:["from_city_map","pachinko_parlor","soapland","sm_club"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"",description:`EE<mist>E</mist>EEEEE<matcha></matcha>EEElavender></lavender>E..`}},av_studio:{id:"av_studio",x:75,y:25,neighbors:["soapland","from_city_map","adult_goods_store"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"AV",description:`EE<mist></mist>EEEmatcha>E/matcha>EEEEsakura>E</sakura>EEElavender>E</lavender>EE`}},adult_goods_store:{id:"adult_goods_store",x:55,y:15,neighbors:["from_city_map","av_studio"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"E,description:`<mist>EE/mist>EEEEE<matcha>E</matcha>EEEEEEEEEsakura></sakura>Elavender></lavender>`}},sm_club:{id:"sm_club",x:90,y:50,neighbors:["soapland","host_club"],enterable:!1,isTerminal:!0,icon:"E,meta:{name:"SM",description:`EEEE<mist>E</mist>EEEEsakura>E</sakura>E<lavender>E/lavender>E`}}}},rich_district:{id:"rich_district",name:"",entryFacilityId:"to_central_district",facilities:{boulevard:{id:"boulevard",x:50,y:60,neighbors:["mansion","luxury_hotel","delivery_station","to_central_district"],enterable:!1,isTerminal:!0,icon:"EE,meta:{name:"E,description:`<mist></mist>EEsakura>EE/sakura>EEEEE..
E<matcha></matcha>E<lavender>E/lavender>EE`}},mansion:{id:"mansion",x:25,y:25,neighbors:["boulevard","elite_sports_center"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"E,description:`Esakura></sakura>EEEE<matcha>E/matcha>EEEE<mist>E</mist>EEEElavender></lavender>E`}},luxury_hotel:{id:"luxury_hotel",x:60,y:40,neighbors:["boulevard","delivery_station","advanced_business_park"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"EE,description:`E<sakura></sakura>EEEEEEE<mist></mist><lavender>E/lavender>EEE..`}},delivery_station:{id:"delivery_station",x:80,y:65,neighbors:["boulevard","luxury_hotel","advanced_business_park"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"E,description:`Esakura>XAPP</sakura>EEEEEEmatcha>E/matcha>EEEEEEEEEmist>E/mist>EElavender></lavender>E`}},elite_sports_center:{id:"elite_sports_center",x:75,y:20,neighbors:["mansion"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"E,description:`<matcha>E/matcha>EEEE<sakura>E</sakura>EEE<mist>E/mist>Elavender>E/lavender>EE`}},advanced_business_park:{id:"advanced_business_park",x:80,y:45,neighbors:["luxury_hotel","delivery_station"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"",description:`EE<sakura></sakura>EEEE<matcha>E/matcha>EE<mist></mist>EEEEElavender></lavender>E`}},to_central_district:{id:"to_central_district",x:50,y:85,neighbors:["boulevard"],enterable:!0,childMapId:"city_map",icon:"",meta:{name:"E",description:`<mist></mist>EEEEEEE<matcha>E</matcha>EEsakura>E</sakura>EElavender>E</lavender>`}}}},elite_academy:{id:"elite_academy",name:"",entryFacilityId:"from_rich_district",facilities:{from_rich_district:{id:"from_rich_district",x:50,y:85,neighbors:["classroom","clubroom_building"],enterable:!0,childMapId:"city_map",icon:"",meta:{name:"",description:`Emist>EE/mist>EEEmatcha>E</matcha>EE...
<sakura>EE/sakura>EEElavender></lavender>E`}},classroom:{id:"classroom",x:35,y:50,neighbors:["from_rich_district","rooftop"],enterable:!1,isTerminal:!0,icon:"E,meta:{name:"",description:`<sakura>E</sakura>EEEEEmist>E/mist>EEEmatcha></matcha>EEE..EEEEElavender>EE</lavender>E`}},clubroom_building:{id:"clubroom_building",x:70,y:55,neighbors:["from_rich_district","gym"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"",description:`EEEmist>EE/mist>EEmatcha></matcha>EE<sakura>E/sakura>EEEEEE...<lavender></lavender>E`}},gym:{id:"gym",x:80,y:20,neighbors:["clubroom_building","rooftop"],enterable:!1,isTerminal:!0,icon:"EE,meta:{name:"E,description:`EEE<mist></mist>EE<sakura>E/sakura>EEE<matcha>E/matcha><lavender>E/lavender>E..`}},rooftop:{id:"rooftop",x:50,y:15,neighbors:["classroom","gym"],enterable:!1,isTerminal:!0,icon:"EE,meta:{name:"",description:`EEmist></mist>EEE<sakura>E</sakura>EEEmatcha></matcha>EE<lavender></lavender>E`}}}},slums:{id:"slums",name:"",entryFacilityId:"from_entertainment_district",facilities:{from_entertainment_district:{id:"from_entertainment_district",x:10,y:40,neighbors:["streetwalker_street","unfinished_building"],enterable:!0,childMapId:"city_map",icon:"",meta:{name:"E,description:`EEE<mist></mist>...
EEEEmatcha>E</matcha>EEEEEEsakura>EE/sakura><lavender></lavender>E`}},streetwalker_street:{id:"streetwalker_street",x:60,y:80,neighbors:["from_entertainment_district","public_toilet","riverside"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"",description:`EE<mist>EEE/mist>...
E<matcha>E</matcha>EEEEEEsakura>E/sakura>E<lavender></lavender>...`}},unfinished_building:{id:"unfinished_building",x:50,y:50,neighbors:["from_entertainment_district","illegal_casino","sweatshop","junkyard"],enterable:!1,isTerminal:!0,icon:"EE,meta:{name:"",description:`EEmist>E</mist>EE<matcha>EEE</matcha>EEE..
E<sakura></sakura>Elavender>E</lavender>E`}},public_toilet:{id:"public_toilet",x:45,y:85,neighbors:["streetwalker_street","illegal_casino"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"",description:`E..EEE<mist>E</mist>EEE<matcha>E/matcha>EEEEE<sakura></sakura>EE<lavender>E/lavender>E`}},illegal_casino:{id:"illegal_casino",x:25,y:60,neighbors:["unfinished_building","public_toilet"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"",description:`<mist></mist>EEEEEEEEEEmatcha>E</matcha>...
EEEE<sakura></sakura>E<lavender>E</lavender>E`}},sweatshop:{id:"sweatshop",x:30,y:20,neighbors:["unfinished_building","riverside"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"E,description:`E<mist></mist>EEEEEmatcha>EE/matcha>EEsakura>E</sakura>EEElavender>EE/lavender>...`}},riverside:{id:"riverside",x:80,y:20,neighbors:["streetwalker_street","sweatshop","junkyard"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"",description:`EEEEEmist></mist>EEEE<matcha></matcha>EEEEE<sakura></sakura>EElavender></lavender>...`}},junkyard:{id:"junkyard",x:85,y:40,neighbors:["unfinished_building","riverside"],enterable:!1,isTerminal:!0,icon:"EE,meta:{name:"E",description:`EEEEE<mist>E</mist>EEEEmatcha>E/matcha>EE<sakura>E/sakura>EElavender></lavender>E`}}}},seaside:{id:"seaside",name:"",entryFacilityId:"from_city_map",facilities:{from_city_map:{id:"from_city_map",x:90,y:50,neighbors:["beach"],enterable:!0,childMapId:"city_map",icon:"",meta:{name:"E",description:`EEEmist></mist>EEEmatcha></matcha>EE..
EE<sakura>EE/sakura>E<lavender>E/lavender>E`}},beach:{id:"beach",x:60,y:50,neighbors:["from_city_map","beach_house","hot_spring_inn","hidden_cave"],enterable:!1,isTerminal:!0,icon:"EE,meta:{name:"",description:`EEE<mist>E</mist>EEEE<matcha></matcha>EEEsakura>E</sakura>EEE<lavender>E/lavender>E`}},beach_house:{id:"beach_house",x:45,y:75,neighbors:["beach"],enterable:!1,isTerminal:!0,icon:"",meta:{name:"E,description:`Emist>E/mist>EEE<matcha>E</matcha>EEEsakura>E</sakura>EEEEEEElavender>E</lavender>E..E`}},hot_spring_inn:{id:"hot_spring_inn",x:20,y:60,neighbors:["beach"],enterable:!1,isTerminal:!0,icon:"EE,meta:{name:"E,description:`EEE<mist>E/mist>E
EEEEmatcha></matcha>EEE..
E<sakura>E</sakura>EEEE<lavender>E</lavender>`}},hidden_cave:{id:"hidden_cave",x:25,y:15,neighbors:["beach"],enterable:!1,isTerminal:!0,icon:"EE,meta:{name:"",description:`EE...E<mist></mist>EEE<matcha></matcha>EEEE<sakura>E/sakura>EEE<lavender>E/lavender>E`}}}}};function fy(r,n){const s=r??"",o=n??"";let a=s,u=o,f=s,c=o;const p=r?cs[r]:void 0;if(p&&(a=p.name??p.id??s,f=p.id??s,n)){const g=p.facilities[n];if(g)return u=g.meta?.name??g.id??o,c=g.id??o,{mapName:a,facilityName:u,mapId:f,facilityId:c}}if(n)for(const g of Object.values(cs)){const y=g.facilities[n];if(y){a=g.name??g.id??s,f=g.id??s,u=y.meta?.name??y.id??o,c=y.id??o;break}}return{mapName:a,facilityName:u,mapId:f,facilityId:c}}const Zl={sakura:{base:"border-sakura-300 hover:bg-sakura-50",active:"bg-sakura-300 text-white border-sakura-500 hover:text-black"},matcha:{base:"border-matcha-300 hover:bg-matcha-50",active:"bg-matcha-300 text-white border-matcha-500 hover:text-black"},mist:{base:"border-mist-300 hover:bg-mist-50",active:"bg-mist-300 text-white border-mist-500 hover:text-black"}};function py({isSending:r,isEditing:n}){const s=pt("basic"),o=pt("requestFeatures"),a=uc("requestFeatures"),[u,f]=N.useState(!1),c=N.useMemo(()=>[{id:"switchPov",title:"E POV",description:"EEEEEE,tone:"mist",disable:!0},{id:"forceEscapeEvent",title:"",description:"E",tone:"sakura"},{id:"encourageLewd",title:"",description:"E",tone:"matcha"},{id:"forbidLewd",title:"",description:"E",tone:"matcha"},{id:"suppressDespair",title:"",description:"E,tone:"sakura"}],[]),p=v=>v==="switchPov"?!!o.povTarget:!!o[v],g=v=>{if(v.disable){f(!0);return}if(r||n)return;if(v.id==="switchPov"){a({povTarget:o.povTarget?null:jf(s.currPOV)});return}const w=v.id,S=!o[w],k={[w]:S};w==="encourageLewd"&&S&&(k.forbidLewd=!1),w==="forbidLewd"&&S&&(k.encourageLewd=!1),a(k)},y=o.povTarget??jf(s.currPOV);return h.jsxs("div",{className:"w-full px-4",children:[h.jsxs("div",{className:"mx-auto max-w-[540px] rounded-2xl border-2 border-dashed border-matcha-200 bg-paper-white/90 px-4 py-3",children:[h.jsx("div",{className:"mb-3 text-center text-sm text-charcoal-500 font-naikai",children:"E"}),h.jsxs("div",{className:"flex flex-col gap-2",children:[c.map(v=>{const w=p(v.id),k=v.id==="switchPov"?`EEE{J0(y)}`:w?"":"",E=Zl[v.tone];return h.jsx("button",{type:"button",className:xe("w-full text-left px-4 py-3 rounded-xl border-2 border-dashed transition-transform duration-150","bg-paper-white font-cpTitle text-charcoal-800","hover:-translate-y-0.5 active:translate-y-[1px]",w?E.active:E.base,(r||n)&&"opacity-60 cursor-not-allowed hover:translate-y-0",v.disable&&"opacity-80"),"aria-pressed":w,"aria-disabled":v.disable,onClick:()=>g(v),disabled:r||n,children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-base font-semibold",children:v.title}),h.jsx("div",{className:"text-xs text-charcoal-500",children:v.description})]}),h.jsx("div",{className:xe("shrink-0 rounded-full border px-3 py-1 text-xs font-semibold",w?"bg-white/90 border-charcoal-300 text-charcoal-800":"bg-white border-charcoal-200 text-charcoal-500"),children:k})]})},v.id)}),h.jsx("button",{type:"button",className:"mt-1 w-full text-center text-xs text-charcoal-500 underline decoration-dashed underline-offset-4 disabled:opacity-50",onClick:()=>a({...$p}),disabled:r||n,children:""})]})]}),h.jsx(gc,{open:u,overlayClassName:"plot-bias-modal__overlay",containerClassName:"plot-bias-modal",onOverlayClick:()=>f(!1),children:h.jsx("div",{className:"plot-bias-modal__panel",children:h.jsxs("div",{className:"plot-bias-modal__image-wrap",children:[h.jsx("img",{src:Nt.resolvePath("/images/sorry.webp"),className:"plot-bias-modal__image"}),h.jsxs("div",{className:"plot-bias-modal__dialog",children:[h.jsx("div",{className:"plot-bias-modal__dialog-name",children:"E}),h.jsxs("div",{className:"plot-bias-modal__dialog-text",children:[".......E..",h.jsx("br",{}),"E.."]})]})]})})})]})}const ss=[{id:"tools",label:"",color:"matcha"},{id:"options",label:"",color:"sakura"},{id:"map",label:"",color:"mist"}],hy={tools:0,options:0,map:0},my=36,Mf=48,gy=24,bo=[{key:"first",className:"option-bubble option-bubble--1"},{key:"second",className:"option-bubble option-bubble--2"},{key:"third",className:"option-bubble option-bubble--3"}];function yy({optionTexts:r,optionTextClass:n,isSending:s,editMode:o=!1,editableOptions:a,onEditableOptionsChange:u,expectedDurationMs:f,selectedOptionKey:c,onOptionClick:p,onMapTravelPrompt:g,mapPosition:y,onMapPositionChange:v,characterImageSrc:w}){const[S,k]=N.useState("options"),E=ss.length,C=Math.max(0,ss.findIndex(Z=>Z.id===S)),I=N.useRef({tools:null,options:null,map:null}),[b,M]=N.useState({tools:0,options:0,map:0}),[D,L]=N.useState(!1),F=N.useRef(null),H=N.useRef(null);N.useEffect(()=>{const Z=()=>{if(!F.current||!F.current.parentElement)return;const O=F.current.offsetWidth,V=F.current.parentElement.offsetWidth;L(O>V*.85)};Z();const ce=new ResizeObserver(()=>{Z()});return F.current&&ce.observe(F.current),F.current?.parentElement&&ce.observe(F.current.parentElement),()=>ce.disconnect()},[S,r.length]),N.useEffect(()=>{const Z=()=>{M(O=>{let V=!1;const Y={...O};return ss.forEach(({id:P})=>{const _=I.current[P];if(!_)return;const B=Math.ceil(_.getBoundingClientRect().height),X=P==="options"?(()=>{const ne=_.querySelector(".option-bubble-stack");if(!ne)return Mf;const se=ne.getBoundingClientRect();if(!se.width||!se.height)return Mf;const pe=se.width+my,ge=Math.max(0,(pe-se.height)/2);return Math.max(ge,gy)})():0,J=B+hy[P]+X;!B||O[P]===J||(Y[P]=J,V=!0)}),V?Y:O})};if(Z(),typeof ResizeObserver>"u")return window.addEventListener("resize",Z),()=>window.removeEventListener("resize",Z);const ce=ss.map(({id:O})=>{const V=I.current[O];if(!V)return null;const Y=new ResizeObserver(Z);return Y.observe(V),Y}).filter(Boolean);return()=>{ce.forEach(O=>O.disconnect())}},[]);const q=Math.max(520,...ss.map(({id:Z})=>b[Z]??0)),te=!!o,K=te?[...a??r,"","",""].slice(0,bo.length):r,z=bo.map((Z,ce)=>K[ce]??""),W=!te&&s,ae=W&&!!c,ee=(Z,ce)=>{const O=cs[Z]?.facilities?.[ce];return O?.meta?.name??O?.id??ce},he=Z=>{let ce="",O="";if(Z.fullPathNodes&&Z.fullPathNodes.length>0){ce=Wp(Z.fullPathNodes,Z.to,cs).map(P=>P.text).join(" -> ");const Y=Z.fullPathNodes[Z.fullPathNodes.length-1];O=ee(Y.mapId,Y.facilityId)}else{const V=(Z.path&&Z.path.length>0?Z.path:[Z.from,Z.to]).filter(Boolean),_=(V.length>0?V:[Z.to]).map(B=>ee(Z.mapId,B)).filter((B,X,J)=>X===0||B!==J[X-1]);O=ee(Z.mapId,Z.to),ce=_.join(" -> ")||O}return`EEE{O}EEE{ce}EEE\`<chat_history>\`EEEEEEEEEEEE`};return h.jsxs("div",{className:"w-full flex flex-col items-center gap-6 option-tabs",children:[h.jsxs("div",{className:"relative w-full overflow-hidden min-h-[520px] flex items-center",style:{minHeight:q},children:[h.jsx("div",{className:"w-full",children:h.jsxs("div",{className:"flex w-full items-center",style:{width:`${E*100}%`,transform:`translateX(-${100/E*C}%)`,transition:"transform 300ms ease-out"},children:[h.jsx("div",{ref:Z=>{I.current.tools=Z},className:"flex-shrink-0 flex items-center justify-center py-6",style:{width:`${100/E}%`},children:h.jsx(py,{isSending:s,isEditing:te})}),h.jsx("div",{ref:Z=>{I.current.options=Z},className:"flex-shrink-0 flex items-center justify-center py-6",style:{width:`${100/E}%`},children:h.jsx("div",{className:"flex flex-col items-center justify-center gap-8 w-full",children:r.length>0?h.jsx("div",{className:"option-stage",children:h.jsxs("div",{className:"option-layout",children:[h.jsxs("div",{ref:H,className:xe("option-bubble-stack",ae&&"option-bubble-stack--active"),children:[bo.map((Z,ce)=>{const O=z[ce];if(!O&&!te)return null;const V=W&&c===Z.key,Y=W&&!!c,P={width:V?"100%":"0%",transitionDuration:`${V?f:220}ms`};return te?h.jsx("div",{className:xe(Z.className,"option-bubble--editing"),role:"group","aria-label":` ${ce+1}`,children:h.jsx("div",{className:xe("option-bubble__content",n),children:h.jsx("textarea",{className:"option-bubble__input",value:O,onChange:_=>{const B=[...a??r];B[ce]=_.target.value,u?.(B.slice(0,bo.length))},placeholder:` ${ce+1}`,rows:2})})},Z.key):h.jsxs("button",{className:xe(Z.className,V&&"option-bubble--active",V&&Y&&"option-bubble--floating",!V&&Y&&"option-bubble--locked"),type:"button",disabled:W||te,onClick:()=>{W||te||p(O,Z.key)},children:[h.jsx("div",{className:"option-bubble__progress","aria-hidden":!0,children:h.jsx("div",{className:"option-bubble__progress-fill",style:P})}),h.jsx("div",{className:xe("option-bubble__content",n),children:h.jsx("span",{className:"inline-block relative z-10",children:O})})]},Z.key)}),h.jsxs("div",{className:xe("option-bubble__trail",D&&"option-bubble__trail--vertical"),"aria-hidden":!0,children:[h.jsx("span",{className:"option-bubble__trail-dot"}),h.jsx("span",{className:"option-bubble__trail-dot option-bubble__trail-dot--small"}),h.jsx("span",{className:"option-bubble__trail-dot option-bubble__trail-dot--tiny"})]})]}),h.jsx("div",{className:"option-character",children:h.jsx("div",{className:"option-character__wrap",ref:F,children:h.jsx("img",{src:w,alt:"E",className:"option-character__img"})})})]})}):h.jsx("div",{className:"font-naikai text-base leading-relaxed italic text-charcoal-400",children:""})})}),h.jsx("div",{ref:Z=>{I.current.map=Z},className:"flex-shrink-0 flex items-center justify-center py-6",style:{width:`${100/E}%`},children:h.jsx("div",{className:"w-full",children:h.jsx(dy,{maps:cs,initialMapId:y.mapId||"residential_area",initialFacilityId:y.facilityId||"apartment",mapPosition:y,travelDurationMs:f,isSending:s||o,onTravel:async Z=>{if(s||o)return{success:!1,finalFacilityId:Z.from,reason:"EEEE};const ce=he(Z);try{return await g(ce,Z.mapId),{success:!0,finalFacilityId:Z.to}}catch(O){return console.error("[OptionTabs] Map travel prompt failed",O),{success:!1,finalFacilityId:Z.from,reason:"EE}}},onPositionChange:({mapId:Z,facilityId:ce})=>{v({mapId:Z,facilityId:ce})}})})})]})}),h.jsxs("div",{className:"pointer-events-none absolute inset-0 z-30",children:[h.jsx("div",{className:"absolute left-2 top-2 h-6 w-6 border-l-2 border-t-2 border-charcoal-400"}),h.jsx("div",{className:"absolute right-2 top-2 h-6 w-6 border-r-2 border-t-2 border-charcoal-400"}),h.jsx("div",{className:"absolute left-2 bottom-2 h-6 w-6 border-l-2 border-b-2 border-charcoal-400"}),h.jsx("div",{className:"absolute right-2 bottom-2 h-6 w-6 border-r-2 border-b-2 border-charcoal-400"})]})]}),h.jsx("div",{className:"w-full flex justify-center",children:h.jsx("div",{className:"flex items-center justify-center gap-3 rounded-full border-2 border-dashed border-sakura-200 bg-paper-white/90 px-4 py-2",children:ss.map(Z=>h.jsx("button",{type:"button",className:xe("h-10 px-4 rounded-full border-2 border-dashed bg-paper-white font-cpTitle text-sm tracking-wide text-charcoal-800 transition-colors duration-150","active:translate-y-[1px]",Zl[Z.color].base,S===Z.id&&Zl[Z.color].active),onClick:()=>k(Z.id),"aria-pressed":S===Z.id,children:Z.label},Z.id))})})]})}const Po="rii_story",Pf=Po.length,Rn=(...r)=>{};class vy{constructor(n){this.callbacks=n}state="searchingKey";buffer="";searchFrom=0;capturePos=0;storyBuffer="";escapeNext=!1;unicodeBuffer=null;started=!1;push(n){!n||this.state==="done"||(this.buffer+=n,this.process())}decodeEscapedChar(n){switch(n){case'"':return'"';case"\\":return"\\";case"/":return"/";case"b":return"\b";case"f":return"\f";case"n":return`
`;case"r":return"\r";case"t":return"	";default:return n}}resetSearch(){this.state="searchingKey",this.searchFrom=Math.max(0,this.buffer.length-Pf*2),this.escapeNext=!1,this.unicodeBuffer=null}process(){let n=!1,s=0;for(;s<10;){if(s+=1,this.state==="searchingKey"){const o=this.findKeyEndIndex(this.searchFrom);if(o===-1){this.searchFrom=Math.max(0,this.buffer.length-Pf*2);break}Rn("key detected",{at:o,bufferTail:this.buffer.slice(Math.max(0,o-10),o+10)}),this.state="waitingForQuote",this.searchFrom=o+1;continue}if(this.state==="waitingForQuote"){const o=this.buffer.indexOf(":",this.searchFrom);if(o===-1){this.searchFrom=Math.max(0,this.buffer.length-1);break}let a=o+1;for(;a<this.buffer.length&&/\s/.test(this.buffer[a]);)a+=1;if(a>=this.buffer.length){this.searchFrom=a;break}if(this.buffer[a]==='"'){this.capturePos=a+1,this.state="capturing",Rn("enter capturing",{cursor:a,bufferLen:this.buffer.length}),this.started||(this.started=!0,this.callbacks.onStart());continue}this.resetSearch();continue}if(this.state==="capturing"){n=this.captureStream()||n;break}break}n&&this.callbacks.onUpdate(this.storyBuffer)}captureStream(){let n=!1,s=this.capturePos;for(;s<this.buffer.length&&this.state==="capturing";){const o=this.buffer[s];if(this.unicodeBuffer!==null){if(/[0-9a-fA-F]/.test(o)){if(this.unicodeBuffer+=o,this.unicodeBuffer.length>=4){const a=Number.parseInt(this.unicodeBuffer.slice(0,4),16);Number.isFinite(a)&&(this.storyBuffer+=String.fromCharCode(a),n=!0),this.unicodeBuffer=null}s+=1;continue}this.storyBuffer+=`\\u${this.unicodeBuffer}${o}`,n=!0,this.unicodeBuffer=null,s+=1;continue}if(this.escapeNext){if(this.escapeNext=!1,o==="u"){this.unicodeBuffer="",s+=1;continue}this.storyBuffer+=this.decodeEscapedChar(o),n=!0,s+=1;continue}if(o==="\\"){this.escapeNext=!0,s+=1;continue}if(o==='"'){if(this.storyBuffer.length===0){s+=1;continue}this.state="done",Rn("capture completed",{length:this.storyBuffer.length});break}this.storyBuffer+=o,n=!0,s+=1}return this.capturePos=s,n}findKeyEndIndex(n){let s=0;for(let o=n;o<this.buffer.length;o+=1){const a=this.buffer[o];if(a!=='"'){if(a===Po[s]){if(s+=1,s>=Po.length)return o;continue}s=a===Po[0]?1:0}}return-1}}class xy{constructor(n){this.options=n,this.parser=new vy({onStart:()=>{this.active&&(this.options.onStart(),Rn("stream start -> clear & reset",{id:this.options.generationId}))},onUpdate:s=>{this.active&&(this.options.onUpdate(s),Rn("stream update",{id:this.options.generationId,preview:s.slice(-80)}))}})}parser;active=!0;attached=!1;attach(){!this.canUseEvents()||this.attached||(eventOn(iframe_events.STREAM_TOKEN_RECEIVED_INCREMENTALLY,this.handleStreamChunk),this.attached=!0,Rn("attach listener",{id:this.options.generationId}))}dispose(){this.active=!1,!(!this.attached||!this.canUseEvents())&&(eventRemoveListener(iframe_events.STREAM_TOKEN_RECEIVED_INCREMENTALLY,this.handleStreamChunk),this.attached=!1,Rn("dispose listener",{id:this.options.generationId}))}handleStreamChunk=(n,s)=>{if(this.active){if(s!==this.options.generationId){Rn("skip chunk (id mismatch)",{incoming:s,expected:this.options.generationId});return}Rn("chunk received",{id:s,size:n.length,preview:n.slice(0,120)}),this.parser.push(n)}};canUseEvents(){return typeof iframe_events<"u"&&typeof eventOn=="function"&&typeof eventRemoveListener=="function"}}class is extends Error{constructor(n,s){super(`${n} at position ${s}`),this.position=s}}const Vp=32,wy=10,Gp=9,Yp=13,by=160,ky=8192,Sy=8202,Ny=8239,_y=8287,Ey=12288;function Cy(r){return/^[0-9A-Fa-f]$/.test(r)}function jr(r){return r>="0"&&r<="9"}function Iy(r){return r>=" "}function ko(r){return`,:[]/{}()
+`.includes(r)}function Tf(r){return r>="a"&&r<="z"||r>="A"&&r<="Z"||r==="_"||r==="$"}function Af(r){return r>="a"&&r<="z"||r>="A"&&r<="Z"||r==="_"||r==="$"||r>="0"&&r<="9"}const Lf=/^(http|https|ftp|mailto|file|data|irc):\/\/$/,Rf=/^[A-Za-z0-9-._~:/?#@!$&'()*+;=]$/;function zf(r){return`,[]/{}
+`.includes(r)}function Of(r){return To(r)||jy.test(r)}const jy=/^[[{\w-]$/;function My(r){return r===`
`||r==="\r"||r==="	"||r==="\b"||r==="\f"}function Pr(r,n){const s=r.charCodeAt(n);return s===Vp||s===wy||s===Gp||s===Yp}function Py(r,n){const s=r.charCodeAt(n);return s===Vp||s===Gp||s===Yp}function Ty(r,n){const s=r.charCodeAt(n);return s===by||s>=ky&&s<=Sy||s===Ny||s===_y||s===Ey}function To(r){return Kp(r)||Jl(r)}function Kp(r){return r==='"'||r==="E||r==="E}function Ff(r){return r==='"'}function Jl(r){return r==="'"||r==="E||r==="E||r==="`"||r===""}function Df(r){return r==="'"}function Qs(r,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=r.lastIndexOf(n);return o!==-1?r.substring(0,o)+(s?"":r.substring(o+1)):r}function dn(r,n){let s=r.length;if(!Pr(r,s-1))return r+n;for(;Pr(r,s-1);)s--;return r.substring(0,s)+n+r.substring(s)}function Ay(r,n,s){return r.substring(0,n)+r.substring(n+s)}function Ly(r){return/[,\n][ \t\r]*$/.test(r)}const Ry={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},zy={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function Oy(r){let n=0,s="";g(["```","[```","{```"]),u()||ee(),g(["```","```]","```}"]);const a=v(",");for(a&&f(),Of(r[n])&&Ly(s)?(a||(s=dn(s,",")),I()):a&&(s=Qs(s,","));r[n]==="}"||r[n]==="]";)n++,f();if(n>=r.length)return s;ae();function u(){f();const O=E()||C()||b()||D()||L()||H(!1)||q();return f(),O}function f(){let O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const V=n;let Y=c(O);do Y=p(),Y&&(Y=c(O));while(Y);return n>V}function c(O){const V=O?Pr:Py;let Y="";for(;;)if(V(r,n))Y+=r[n],n++;else if(Ty(r,n))Y+=" ",n++;else break;return Y.length>0?(s+=Y,!0):!1}function p(){if(r[n]==="/"&&r[n+1]==="*"){for(;n<r.length&&!Fy(r,n);)n++;return n+=2,!0}if(r[n]==="/"&&r[n+1]==="/"){for(;n<r.length&&r[n]!==`
`;)n++;return!0}return!1}function g(O){if(y(O)){if(Tf(r[n]))for(;n<r.length&&Af(r[n]);)n++;return f(),!0}return!1}function y(O){c(!0);for(const V of O){const Y=n+V.length;if(r.slice(n,Y)===V)return n=Y,!0}return!1}function v(O){return r[n]===O?(s+=r[n],n++,!0):!1}function w(O){return r[n]===O?(n++,!0):!1}function S(){return w("\\")}function k(){return f(),r[n]==="."&&r[n+1]==="."&&r[n+2]==="."?(n+=3,f(),w(","),!0):!1}function E(){if(r[n]==="{"){s+="{",n++,f(),w(",")&&f();let O=!0;for(;n<r.length&&r[n]!=="}";){let V;if(O?(V=!0,O=!1):(V=v(","),V||(s=dn(s,",")),f()),k(),!(b()||H(!0))){r[n]==="}"||r[n]==="{"||r[n]==="]"||r[n]==="["||r[n]===void 0?s=Qs(s,","):he();break}f();const P=v(":"),_=n>=r.length;P||(Of(r[n])||_?s=dn(s,":"):Z()),u()||(P||_?s+="null":Z())}return r[n]==="}"?(s+="}",n++):s=dn(s,"}"),!0}return!1}function C(){if(r[n]==="["){s+="[",n++,f(),w(",")&&f();let O=!0;for(;n<r.length&&r[n]!=="]";)if(O?O=!1:v(",")||(s=dn(s,",")),k(),!u()){s=Qs(s,",");break}return r[n]==="]"?(s+="]",n++):s=dn(s,"]"),!0}return!1}function I(){let O=!0,V=!0;for(;V;)O?O=!1:v(",")||(s=dn(s,",")),V=u();V||(s=Qs(s,",")),s=`[
${s}
]`}function b(){let O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,Y=r[n]==="\\";if(Y&&(n++,Y=!0),To(r[n])){const P=Ff(r[n])?Ff:Df(r[n])?Df:Jl(r[n])?Jl:Kp,_=n,B=s.length;let X='"';for(n++;;){if(n>=r.length){const J=te(n-1);return!O&&ko(r.charAt(J))?(n=_,s=s.substring(0,B),b(!0)):(X=dn(X,'"'),s+=X,!0)}if(n===V)return X=dn(X,'"'),s+=X,!0;if(P(r[n])){const J=n,ne=X.length;if(X+='"',n++,s+=X,f(!1),O||n>=r.length||ko(r[n])||To(r[n])||jr(r[n]))return M(),!0;const se=te(J-1),pe=r.charAt(se);if(pe===",")return n=_,s=s.substring(0,B),b(!1,se);if(ko(pe))return n=_,s=s.substring(0,B),b(!0);s=s.substring(0,B),n=J+1,X=`${X.substring(0,ne)}\\${X.substring(ne)}`}else if(O&&zf(r[n])){if(r[n-1]===":"&&Lf.test(r.substring(_+1,n+2)))for(;n<r.length&&Rf.test(r[n]);)X+=r[n],n++;return X=dn(X,'"'),s+=X,M(),!0}else if(r[n]==="\\"){const J=r.charAt(n+1);if(zy[J]!==void 0)X+=r.slice(n,n+2),n+=2;else if(J==="u"){let se=2;for(;se<6&&Cy(r[n+se]);)se++;se===6?(X+=r.slice(n,n+6),n+=6):n+se>=r.length?n=r.length:ce()}else X+=J,n+=2}else{const J=r.charAt(n);J==='"'&&r[n-1]!=="\\"?(X+=`\\${J}`,n++):My(J)?(X+=Ry[J],n++):(Iy(J)||W(J),X+=J,n++)}Y&&S()}}return!1}function M(){let O=!1;for(f();r[n]==="+";){O=!0,n++,f(),s=Qs(s,'"',!0);const V=s.length;b()?s=Ay(s,V,1):s=dn(s,'"')}return O}function D(){const O=n;if(r[n]==="-"){if(n++,K())return z(O),!0;if(!jr(r[n]))return n=O,!1}for(;jr(r[n]);)n++;if(r[n]==="."){if(n++,K())return z(O),!0;if(!jr(r[n]))return n=O,!1;for(;jr(r[n]);)n++}if(r[n]==="e"||r[n]==="E"){if(n++,(r[n]==="-"||r[n]==="+")&&n++,K())return z(O),!0;if(!jr(r[n]))return n=O,!1;for(;jr(r[n]);)n++}if(!K())return n=O,!1;if(n>O){const V=r.slice(O,n),Y=/^0\d/.test(V);return s+=Y?`"${V}"`:V,!0}return!1}function L(){return F("true","true")||F("false","false")||F("null","null")||F("True","true")||F("False","false")||F("None","null")}function F(O,V){return r.slice(n,n+O.length)===O?(s+=V,n+=O.length,!0):!1}function H(O){const V=n;if(Tf(r[n])){for(;n<r.length&&Af(r[n]);)n++;let Y=n;for(;Pr(r,Y);)Y++;if(r[Y]==="(")return n=Y+1,u(),r[n]===")"&&(n++,r[n]===";"&&n++),!0}for(;n<r.length&&!zf(r[n])&&!To(r[n])&&(!O||r[n]!==":");)n++;if(r[n-1]===":"&&Lf.test(r.substring(V,n+2)))for(;n<r.length&&Rf.test(r[n]);)n++;if(n>V){for(;Pr(r,n-1)&&n>0;)n--;const Y=r.slice(V,n);return s+=Y==="undefined"?"null":JSON.stringify(Y),r[n]==='"'&&n++,!0}}function q(){if(r[n]==="/"){const O=n;for(n++;n<r.length&&(r[n]!=="/"||r[n-1]==="\\");)n++;return n++,s+=`"${r.substring(O,n)}"`,!0}}function te(O){let V=O;for(;V>0&&Pr(r,V);)V--;return V}function K(){return n>=r.length||ko(r[n])||Pr(r,n)}function z(O){s+=`${r.slice(O,n)}0`}function W(O){throw new is(`Invalid character ${JSON.stringify(O)}`,n)}function ae(){throw new is(`Unexpected character ${JSON.stringify(r[n])}`,n)}function ee(){throw new is("Unexpected end of json string",r.length)}function he(){throw new is("Object key expected",n)}function Z(){throw new is("Colon expected",n)}function ce(){const O=r.slice(n,n+6);throw new is(`Invalid unicode character "${O}"`,n)}}function Fy(r,n){return r[n]==="*"&&r[n+1]==="/"}const Xp=["violence","contaminated_by_inferior_genes","debt_collection","sex_with_petite_body","sisters_combo","vulgar_postures","bestiality","tentacles","slime","orc","goblin","insect","plant","generic","invisible","vore","toys","trap","breeder","living_clothes","sexy_clothes","brainwashing","semen_addiction","verbal_humiliation","public_humiliation","exhibitionism","objectification","tattoo","objectification","exhibitionism","yuri","breast_growth","semen_belly","masturbation","curse","body_writing","piercing","body_modification","furry_transformation","parasitic","brand"],Dy=new Set(Xp);function ni(r){if(typeof r!="string")return;const n=r.trim();return n.length>0?n:void 0}function $f(r){const n=ni(r);if(!n)return[];const s=[];return Object.entries(cs).forEach(([o,a])=>{o!=="city_map"&&a?.facilities?.[n]&&s.push(o)}),s}function $y(r,n,s){const o=ni(n),a=Array.isArray(r)?o!==void 0?r.filter(p=>ni(p?.action)===o):r:[],u=new Set,f=new Set;a.length>0&&a.forEach(p=>{const g=$f(p?.areaId);if(g.length>0)g.forEach(y=>u.add(`d${y}`));else{const y=ni(p?.areaId);y&&u.add(`tigger_${y}`)}Array.isArray(p?.kink)&&p.kink.forEach(y=>{Dy.has(y)&&f.add(`tigger_${y}`)})});const c=ni(s);if(c){const p=$f(c);p.length>0?p.forEach(g=>u.add(`tigger_${g}`)):u.add(`tigger_${c}`)}return u.size===0&&f.size===0&&o!==void 0?[]:[...u,...f]}const Sc=1440*60*1e3,Bf=Sc*7,By=["","","E,"E,"E,"E,""];function Uy(r){return r.replace(/[./]/g,"-").replace(//g,"-").replace(/Eg,"-").replace(//g,"").replace(/[E]/g,":").replace(/\s+/g," ").trim()}function Hy(r){const[,n,s,o,a="0",u="0",f="0"]=r,p=new Date(Number(n),Number(s)-1,Number(o),Number(a),Number(u),Number(f)).getTime();return Number.isNaN(p)?void 0:p}function dr(r){if(typeof r=="number"&&Number.isFinite(r))return r;if(typeof r!="string")return;const n=r.trim();if(!n)return;const s=Date.parse(n);if(!Number.isNaN(s))return s;const o=Uy(n),a=o.match(/(\d{4})-(\d{1,2})-(\d{1,2})(?:[ T](\d{1,2})(?::(\d{1,2})(?::(\d{1,2}))?)?)?/);if(a)return Hy(a);const u=o.match(/^(\d{1,2})-(\d{1,2})(?:[ T](\d{1,2})(?::(\d{1,2})(?::(\d{1,2}))?)?)?$/);if(!u)return;const[,f,c,p="0",g="0",y="0"]=u,v=new Date,S=new Date(v.getFullYear(),Number(f)-1,Number(c),Number(p),Number(g),Number(y)).getTime();return Number.isNaN(S)?void 0:S}function Wy(r,n){return r===void 0||n===void 0?!1:n>r}function us(r){const n=new Date(r);return new Date(n.getFullYear(),n.getMonth(),n.getDate()).getTime()}function Qp(r,n){return r===void 0||n===void 0?!1:us(n)>us(r)}function Vy(r,n){if(r===void 0||n===void 0)return;const s=us(r),o=us(n);return Math.round((s-o)/Sc)}function Uf(r){const n=new Date(r),s=n.getDay(),o=s===0?6:s-1;return new Date(n.getFullYear(),n.getMonth(),n.getDate()-o).getTime()}function Gy(r,n,s){if(r===void 0||n===void 0)return;const o=us(n),a=us(r),u=Math.round((a-o)/Sc);let f;u<0?f="E":u===0?f="":u===1?f="":u===2&&(f="");const c=Uf(n),p=Uf(r),g=By[new Date(r).getDay()]??"";if(!f)if(p===c)f=g||"";else if(p===c+Bf)f=`E{g||""}`;else{const y=Math.round((p-c)/Bf);y>1&&y<=4?f=`${y}E${g}`:f=new Date(r).toLocaleDateString("zh-CN")}if(f)return f==="E"?f:s?.suffix?`${f}${s.suffix}`:f}function Ut(r){return!!r&&typeof r=="object"&&!Array.isArray(r)}function He(r){if(typeof r!="string")return;const n=r.trim();return n.length>0?n:void 0}function Yy(r){return r&&r.replace(/\\n|\n/g,"<br/>").replace(/(?:<br\/>){3,}/g,"<br/><br/>")}function kn(r){const n=typeof r=="number"?r:Number(r);if(Number.isFinite(n))return n}function Ky(r){let n=r.trim();if(n.length<2)return n;const s=[['"','"'],["EE,"EE],["E,"E],["E,"E],["E,"E],["E,"E],["E,"E],["'","'"],["`","`"]];let o=!0;for(;o&&n.length>=2;){o=!1;for(const[a,u]of s)if(n.startsWith(a)&&n.endsWith(u)){n=n.slice(a.length,n.length-u.length).trim(),o=!0;break}}return n}const Xy=new Set(Xp);function Qy(r){if(!Array.isArray(r))return;const n=r.filter(s=>Xy.has(s));if(n.length!==0)return Array.from(new Set(n))}function qy(r){if(!Ut(r))return null;const n=He(r.action),s=He(r.area_id);if(!n||!s)return null;const o=He(r.event_name),a=Qy(r.kink);return{action:n,areaId:s,eventName:o,kink:a}}function Zy(r){if(!Array.isArray(r))return;const n=r.map(s=>qy(s)).filter(s=>!!s);return n.length>0?n:void 0}function Jy(r){if(r==null)return null;if(!Ut(r))return;const n=He(r.event_name),s=He(r.step),o=He(r.sex_action);if(!n||!s)return;const a={eventName:n,step:s};return o!==void 0&&(a.sexAction=o),a}function Tr(r,n=0,s=100){return Number.isFinite(r)?r<n?n:r>s?s:r:0}function ev(r){const n=r.match(/^\s*```(?:json)?\s*([\s\S]*?)\s*```\s*$/i);return n?n[1]:r}function tv(r){const n=r.indexOf('"thinking":');if(n===-1)return null;const s=r.lastIndexOf("{",n);if(s===-1)return null;const o=r.indexOf('"end_output":',n);if(o===-1)return null;const a=r.indexOf("}",o);return a===-1||a<=s?null:r.slice(s,a+1)}function nv(r,n){if(!r)return;if(!n)return r;const o=`${n.toLowerCase()}-`;if(r.startsWith(o))return r;const a=r.replace(/^[^-]+-/,"")||r;return`${o}${a}`}function rv(r,n){if(!r)return;if(!n)return r;const s=r.replace(/\.(webp|png|jpg|jpeg)$/i,""),o=`${n.toLowerCase()}-`;return s.startsWith(o)?s:`${o}${s}`}function sv(r){if(!r)return"";try{const n=globalThis?.Buffer;if(n?.from)return n.from(r,"utf-8").toString("base64")}catch{}try{if(typeof btoa=="function"){const n=new TextEncoder().encode(r);let s="";for(const o of n)s+=String.fromCharCode(o);return btoa(s)}}catch{}return""}function So(r,n){const s=sv(r??""),o=n.length>0?n.join(" | "):"unknown parse failure";s?console.error("[StructuredAIResponseParser] Fallback to raw",{message:o,base64:s}):console.error("[StructuredAIResponseParser] Fallback to raw",o)}function iv(r,n){return{mood:He(r?.mood)??n?.mood??"",location:He(r?.location)??n?.location??"",displayTitle:He(r?.display_title)??n?.displayTitle??"",trueTitle:He(r?.true_title)??n?.trueTitle??"",fatigue:Tr(kn(r?.fatigue)??n?.fatigue??0),desire:Tr(kn(r?.desire)??n?.desire??0),will:Tr(kn(r?.will)??n?.will??0),san:Tr(kn(r?.san)??n?.san??0),avatar:n?.avatar}}function ov(r,n){if(!Ut(n))return;const s={addiction:r?.addiction??0,obedience:r?.obedience??0,moralScale:r?.moralScale??0,corruption:r?.corruption??0};let o=!1;const a=(u,f)=>{const c=kn(f);if(c===void 0)return;const{min:p,max:g}=fn[u],y=Tr(c,p,g);s[u]!==y&&(s[u]=y,o=!0)};return a("addiction",n.addiction),a("obedience",n.obedience),a("moralScale",n.moral_scale),a("corruption",n.corruption),o?s:void 0}function av(r,n){if(!Ut(n))return;const s={...r?.nodes??{}};let o=!1;return Object.entries(n).forEach(([a,u])=>{if(!Ut(u))return;const f=kn(u.use_count_delta),c=kn(u.sensitivity);if(f===void 0&&c===void 0)return;const p=s[a]??{},g=typeof p.description=="string"?p.description:"",y=Number.isFinite(p.useCount)?Number(p.useCount):0,v=p.sensitivity??p.wear,w=Number.isFinite(Number(v))?Number(v):0;s[a]={description:g,useCount:y+(f??0),sensitivity:c??w},o=!0}),o?{nodes:s}:void 0}function lv(r){if(typeof r=="string"){const g=He(r);return g?{title:g}:void 0}if(!Ut(r))return;const n=He(r.title);if(!n)return;const s=r.expiresAt??r.expire??r.expires_at,o=He(s),a=Number(r.expiresAtMs),u=Number.isFinite(a)?a:dr(o??s),f=He(r.createdAt),c=Number(r.createdAtMs),p=Number.isFinite(c)?c:dr(f??r.createdAt);return{title:n,expiresAt:o,expiresAtMs:u,createdAt:f,createdAtMs:p}}function cv(r,n){if(!Ut(r))return;const s=He(r.title);if(!s)return;const o=r.expire??r.expiresAt??r.deadline,a=He(o),u=dr(a??o),f=He(n),c=dr(f);return{title:s,expiresAt:a,expiresAtMs:u,createdAt:f,createdAtMs:c}}function uv(r,n,s){if(!Ut(n))return;const o={diaryText:r?.diaryText??"",todoList:Array.isArray(r?.todoList)?r.todoList.map(lv).filter(p=>!!p):[],amount:r?.amount??0};let a=!1;const u=He(n.event_add);u&&(o.diaryText=o.diaryText?`${o.diaryText}
${u}`:u,a=!0);const f=cv(n.todo_add,s);f&&(o.todoList=[...o.todoList,f],a=!0);const c=kn(n.money_add);return c!==void 0&&(o.amount+=c,a=!0),a?o:void 0}function dv(r,n){if(!Ut(n))return;const s={...r?.regions??{}};let o=!1;return Object.entries(n).forEach(([a,u])=>{if(!Ut(u))return;const f=kn(u.fame),c=kn(u.reputation),p=He(u.gossip_add),g=p?He(Ky(p)):void 0,y=s[a]??{desc:"",fame:0,reputation:0,gossip:[]},v={...y};if(f!==void 0&&(v.fame=Tr(f,0,5)),c!==void 0&&(v.reputation=Tr(c,0,5)),g){const w=[...y.gossip??[],g];v.gossip=w.slice(-3)}s[a]=v,o=!0}),o?{regions:s}:void 0}class fv{parse(n,s){const o=n??"";let a=ev(o);const u=[],f=(te,K)=>{try{return JSON.parse(te)}catch(z){const W=z instanceof Error?z.message:String(z);return u.push(`${K}: ${W}`),null}};let c=f(a,"cleaned");if(!c){const te=tv(o);if(!te)return u.push("fallback extraction unavailable"),So(o,u),{storyContent:o,parseFailed:!0};if(a=te,c=f(a,"fallback thinking block"),!c)try{const K=Oy(a);if(u.push("jsonrepair applied to fallback thinking block"),c=f(K,"jsonrepair(fallback thinking block)"),!c)return So(o,u),{storyContent:o,parseFailed:!0}}catch(K){const z=K instanceof Error?K.message:String(K);return u.push(`jsonrepair failed: ${z}`),So(o,u),{storyContent:o,parseFailed:!0}}}const p=c?.context;if(!Ut(p))return u.push("missing or invalid context"),So(n??"",u),{storyContent:n??"",parseFailed:!0};const g={},y=s??null,v=Yy(He(p.rii_story));if(g.storyContent=v??n??"",Ut(p.rii_meta)){const te=p.rii_meta,K=He(te.title),z=He(te.summary),W=Zy(te.next_action);K!==void 0&&(g.title=K),z!==void 0&&(g.summary=z),W&&W.length>0&&(g.nextAction=W)}const w=He(p.current_time);w!==void 0&&(g.currentTime=w);const S=w??y?.currentTime;if(Ut(p.map_position)){const te=He(p.map_position.area_id)??He(p.map_position.map_id),K=He(p.map_position.facility_id);if(te!==void 0||K!==void 0){const z=y?.mapPosition??{mapId:"",facilityId:""},W=te??z.mapId??"";let ae=K;ae===void 0&&(te===void 0||te===z.mapId?ae=z.facilityId:ae=""),g.mapPosition={mapId:W,facilityId:ae??""}}}const k=Jy(p.current_event_state);k!==void 0&&(g.currentEventState=k);const E=y?.portraitFrame??{},C=y?.gamePOV??Xt.basic.currPOV,I=rv(He(p.face),C),b=nv(He(p.clothes),C),M=E.enabledClothingIds?[...E.enabledClothingIds]:[];b&&!M.includes(b)&&M.push(b);const D=M.length>0?M:void 0;(I!==void 0||b!==void 0||D!==void 0)&&(g.portraitFrame={bodyId:b??E.bodyId,faceId:I??E.faceId,enabledClothingIds:D}),Ut(p.status_card)&&(g.statusCard=iv(p.status_card,y?.statusCard));const L=ov(y?.dashboardGauges,p.trait_update);L&&(g.dashboardGauges=L);const F=av(y?.detailPanel,p.body_update);F&&(g.detailPanel=F);const H=uv(y?.logPanel,p.log,S);H&&(g.logPanel=H);const q=dv(y?.societyPanel,p.society_update);return q&&(g.societyPanel=q),g}}const pv=10;class hv{constructor(n=pv){this.defaultCount=n}async getRecentHistoryCount(){try{if(typeof window.TavernHelper>"u")return this.defaultCount;const n=window.TavernHelper.getCharWorldbookNames("current");if(!n)return this.defaultCount;const s=[...n.primary?[n.primary]:[],...n.additional];if(s.length===0)return this.defaultCount;for(const o of s)try{const u=(await window.TavernHelper.getWorldbook(o)).find(p=>p?.name==="config");if(!u)continue;const c=String(u.content??"").split(/\r?\n/);for(const p of c){let g=p.replace(/^\ufeff/,"").trim();if(!g||g.startsWith("#"))continue;const y=g.indexOf("#");y>=0&&(g=g.slice(0,y).trim());const v=g.match(/^maxFullHistoryCount\s*:\s*(\d+)/);if(v){const w=parseInt(v[1],10);if(Number.isFinite(w)&&w>=0)return w}}}catch(a){console.error("[HistoryConfig] Failed to read config entry",a)}}catch(n){console.error("[HistoryConfig] Failed to load config",n)}return this.defaultCount}}const mv=new hv;class gv{constructor(n,s){this.nodeFactory=n,this.parser=s}async initialize(n){if(n.nodes.length>0)return null;if(typeof window.TavernHelper>"u")return console.warn("[HistoryInitializer] window.TavernHelper unavailable, skip worldbook init"),null;try{const s=window.TavernHelper.getCharWorldbookNames("current");if(!s)return console.warn("[HistoryInitializer] No character worldbook names found"),null;const o=[...s.primary?[s.primary]:[],...s.additional];if(o.length===0)return console.warn("[HistoryInitializer] Worldbook list empty"),null;for(const a of o)try{const u=await window.TavernHelper.getWorldbook(a);if(!u||u.length===0){console.warn(`[HistoryInitializer] Worldbook "${a}" has no entries`);continue}const f=u.find(c=>{try{const p=!!(c?.enabled??!0),g=String(c?.name??"").toLowerCase();return p&&g.startsWith("start")}catch{return!1}});if(f){const c=String(f.content??"");try{const p=this.parser.parse(c,null);return{nodes:[this.nodeFactory.createNode({id:0,previousNode:null,userChoice:"",aiResponseText:c,parsedResponse:p})],currentNodeId:0,lockedNodeIds:[]}}catch(p){console.error(`[HistoryInitializer] Failed to parse opening entry from worldbook "${a}"`,p)}}else console.warn(`[HistoryInitializer] No enabled "start*" entry found in worldbook "${a}"`)}catch(u){console.error(`[HistoryInitializer] Failed to load worldbook "${a}"`,u)}}catch(s){console.error("[HistoryInitializer] Failed to initialize from worldbook",s)}return null}}class yv{constructor(n){this.deps=n}processingMutex=Promise.resolve();appActions;initialized=!1;initializationPromise=null;setAppActions(n){this.appActions=n}async initialize(){if(!this.initialized)return this.initializationPromise||(this.initializationPromise=this.performInitialization().then(()=>{this.initialized=!0}).catch(n=>{throw this.initializationPromise=null,n})),this.initializationPromise}async performInitialization(){const n=this.deps.storage.load();if(n.nodes.length>0)return;const s=await this.deps.initializer.initialize(n);if(!s)return;await this.deps.storage.save(s);const o=s.currentNodeId!==null?s.nodes[s.currentNodeId]:null;this.syncAppState(s,o,!0)}async waitForInitialization(){if(!this.initialized){if(this.initializationPromise){await this.initializationPromise;return}throw new Error("HistoryManager.initialize() must be called before use.")}}assertInitialized(){if(!this.initialized)throw new Error("HistoryManager.initialize() must be called before use.")}async buildPrompt(n){await this.waitForInitialization();const s=this.deps.storage.load(),o=await this.deps.configProvider.getRecentHistoryCount(),a=n?.nodeId??s.currentNodeId,u=n?.userInputMessage??"",f=n?.selectedAction??"",c=n?.selectedAreaId??"";return this.deps.promptBuilder.build(s,a,o,u,f,c,n?.requestFeatures)}async processTurn(n,s,o){const a=this.processingMutex.then(async()=>{await this.waitForInitialization();let u=this.deps.storage.load();const f=o?.targetNodeId??u.currentNodeId;o?.shouldNavigateToTarget!==!1&&f!==null&&f!==u.currentNodeId&&(await this.navigateToNode(f),u=this.deps.storage.load());const c=this.deps.storage.load(),p=c.nodes.length,g=this.deps.formatter.format(s,o?.formatterContext??{depth:p,source:"ai",target:"display"}),y=f!==null?c.nodes[f]:null,v=this.deps.nodeFactory.createNode({id:p,previousNode:y,userChoice:n,aiResponseText:g,parsedResponse:o?.parsedResponse,requestContext:o?.requestContext});c.nodes.push(v);const w=o?.shouldMovePointer!==!1;return w&&(c.currentNodeId=p),await this.deps.storage.save(c),this.syncAppState(c,v,w),{newNode:v,parseFailed:!!v.parseFailed}});return this.processingMutex=a.catch(()=>{}),a}async processPlayerInput(n,s,o){return this.processTurn(n,s,o)}previewStreamingStory(n){this.appActions?.setStreamingStoryContent?.(n)}syncAppState(n,s,o){if(!this.appActions)return;const{setCurrentNodeData:a,setSelectedNodeId:u,updateHistoryMeta:f}=this.appActions;o&&s&&(a?.(s),u?.(s.id)),f?.({totalNodes:n.nodes.length,currentNodeId:n.currentNodeId??null,lastUpdated:Date.now()})}async navigateToNode(n){await this.waitForInitialization();const s=this.deps.storage.load();if(n<0||n>=s.nodes.length)return!1;s.currentNodeId=n,await this.deps.storage.save(s);const o=s.nodes[n];return this.syncAppState(s,o,!0),!0}getCurrentNode(){this.assertInitialized();const n=this.deps.storage.load();return n.currentNodeId===null?null:n.nodes[n.currentNodeId]}async resetHistory(){await this.deps.storage.reset(),this.initialized=!1,this.initializationPromise=null,this.syncAppState({nodes:[],currentNodeId:null,lockedNodeIds:[]},null,!0)}getFullHistory(){return this.deps.storage.load()}async updateNodeContent(n,s){await this.waitForInitialization();const o=this.deps.storage.load();if(n<0||n>=o.nodes.length)return!1;const a=o.nodes[n];return Object.assign(a,s),await this.deps.storage.save(o),o.currentNodeId===n&&this.syncAppState(o,a,!0),!0}async toggleNodeLock(n){await this.waitForInitialization();const s=this.deps.storage.load();if(n<0||n>=s.nodes.length)return!1;const o=s.lockedNodeIds??[],a=o.includes(n);s.lockedNodeIds=a?o.filter(f=>f!==n):[...o,n],await this.deps.storage.save(s);const u=s.currentNodeId===null?null:s.nodes[s.currentNodeId];return this.syncAppState(s,u??null,!1),!0}isNodeLocked(n){return(this.deps.storage.load().lockedNodeIds??[]).includes(n)}getLockedNodeIds(){return this.deps.storage.load().lockedNodeIds??[]}hasPersistedHistory(){try{const n=this.deps.storage.load();return Array.isArray(n.nodes)&&n.nodes.length>0}catch{return!1}}async deleteNodeAndDescendants(n){await this.waitForInitialization();const s=this.deps.storage.load();if(n<0||n>=s.nodes.length)return!1;const o=new Map;s.nodes.forEach(k=>{if(k.previousNodeId!==null){const E=o.get(k.previousNodeId)??[];E.push(k.id),o.set(k.previousNodeId,E)}});const a=new Set([n]),u=[n];for(;u.length>0;){const k=u.shift(),E=o.get(k)??[];for(const C of E)a.has(C)||(a.add(C),u.push(C))}const f=s.nodes[n].previousNodeId,c=s.nodes.filter(k=>!a.has(k.id));if(c.length===0)return await this.resetHistory(),!0;const p=new Map;c.forEach((k,E)=>p.set(k.id,E));const g=c.map(k=>{const E=p.get(k.id),C=k.previousNodeId===null?null:p.get(k.previousNodeId)??null;return{...k,id:E,previousNodeId:C}}),y=(s.lockedNodeIds??[]).filter(k=>!a.has(k)).map(k=>p.get(k)).filter(k=>typeof k=="number"),v=f===null?null:p.get(f)??null,w={nodes:g,currentNodeId:v,lockedNodeIds:y};await this.deps.storage.save(w);const S=v===null?null:w.nodes[v];return this.syncAppState(w,S,!0),!0}}class vv{constructor(n){this.parser=n}createNode(n){const{id:s,previousNode:o,userChoice:a,aiResponseText:u}=n,f=n.parsedResponse??this.parser.parse(u,o),c=o??this.createDefaultSnapshot(),p=this.normalizeRequestContext(n.requestContext),g=Object.prototype.hasOwnProperty.call(f,"currentEventState"),y=this.resolveCurrentEventState(g?f.currentEventState:void 0,c.currentEventState??null,g);return{id:s,previousNodeId:o?o.id:null,userChoice:a,storyContent:f.storyContent??u??"",summary:f.summary??c.summary??"",title:f.title??c.title??"",nextAction:f.nextAction??c.nextAction??[],mapPosition:f.mapPosition??c.mapPosition,currentTime:f.currentTime??c.currentTime,currentEventState:y,gamePOV:f.gamePOV??c.gamePOV,portraitFrame:f.portraitFrame??c.portraitFrame,statusCard:f.statusCard??c.statusCard,dashboardGauges:f.dashboardGauges??c.dashboardGauges,detailPanel:f.detailPanel??c.detailPanel,logPanel:f.logPanel??c.logPanel,societyPanel:f.societyPanel??c.societyPanel,parseFailed:f.parseFailed,requestContext:p}}createDefaultSnapshot(){return{storyContent:"",summary:"",title:"",nextAction:[],mapPosition:{mapId:Xt.mainTextBox.mapPosition.mapId??"",facilityId:Xt.mainTextBox.mapPosition.facilityId??""},currentTime:Xt.topFlagState.currentTime,currentEventState:null,gamePOV:Xt.basic.currPOV,portraitFrame:{...Xt.portraitFrame},statusCard:{...Xt.statusCard},dashboardGauges:{...Xt.dashboardGauges},detailPanel:{...Xt.detailPanel},logPanel:{...Xt.logPanel},societyPanel:{...Xt.societyPanel}}}resolveCurrentEventState(n,s,o){if(o&&n===null)return null;const a=n??s;if(!a)return null;const u=typeof a.eventName=="string"?a.eventName.trim():"",f=typeof a.step=="string"?a.step.trim():"";if(!u||!f)return null;const c=typeof a.sexAction=="string"?a.sexAction.trim():void 0,p=typeof s?.eventName=="string"?s.eventName.trim():"",g=s?.shot,y=Number.isFinite(g)?Number(g):s?1:0,w=p===u?y+1:1;return{eventName:u,step:f,sexAction:c,shot:w}}normalizeRequestContext(n){if(!n)return;const s=n.selectedAction?.trim()||void 0,o=n.selectedAreaId?.trim()||void 0;if(!(!s&&!o))return{selectedAction:s,selectedAreaId:o}}}const xv="CUSTOM_CHAT_HISTORY_TREE";class wv{constructor(n=xv){this.variableKey=n}memoryHistory={nodes:[],currentNodeId:null,lockedNodeIds:[]};load(){try{if(typeof window.TavernHelper>"u"||!window.TavernHelper.getVariables)return this.memoryHistory;const s=window.TavernHelper.getVariables({type:"chat"})?.[this.variableKey];if(s&&Array.isArray(s.nodes))return{nodes:s.nodes,currentNodeId:s.currentNodeId??null,lockedNodeIds:s.lockedNodeIds??[]}}catch(n){console.error("[HistoryStorage] Failed to load history",n)}return{nodes:[],currentNodeId:null,lockedNodeIds:[]}}async save(n){try{if(typeof window.TavernHelper>"u"||!window.TavernHelper.insertOrAssignVariables){this.memoryHistory=n;return}await window.TavernHelper.insertOrAssignVariables({[this.variableKey]:n},{type:"chat"})}catch(s){console.error("[HistoryStorage] Failed to save history",s)}}async reset(){const n={nodes:[],currentNodeId:null,lockedNodeIds:[]};await this.save(n)}}const bv=new wv,kv={[ke.SHINO]:{name:"E,roman:"shino",role:""},[ke.RINA]:{name:"E,roman:"rina",role:"E}},Sv=[", EEEEE",", EEEEEE,"EEE,"EEEEEE","EE EEEE],Nv=["EEEEEE","EEE","EEE","EEE","EEE"],_v=["EEE","EEE,"EEE,"EEEE,"EEEEE"],Ev=["EEE","EEEE","EEEEEE,"EE","EEEEEEEEE],Cv=[{desc:"EEEEE,nextReq:"EEEEEE},{desc:"EEEEEEE,nextReq:"EE},{desc:"EEEE",nextReq:"E"},{desc:"EEEEE,nextReq:"EE"},{desc:"EEEEEEEE,nextReq:"EE"}],Iv=[{desc:"EEEE,nextReq:"EE"},{desc:"EE",nextReq:"EEE},{desc:"EEEEE",nextReq:"EE"},{desc:"EEEEEEEE,nextReq:"EEEEE"},{desc:"EEEEEEEE,nextReq:""}],Hf=[{title:"I - E,desc:"EEEEEEEEE",next:"EEEEEEE"},{title:"II - E,desc:"EEEEEEEEEEEEE,next:"EEE"},{title:"III - ",desc:"EEEEEESMEEEEE,next:"EEEE},{title:"IV - E,desc:"EEEEEEEEEE,next:"EEE"}],Wf={to_good:"E",to_evil:"EEEE},jv=[{level:1,title:"",desc:"EEEE},{level:2,title:"",desc:"EEE},{level:3,title:"E,desc:"EEEE"},{level:4,title:"EE,desc:"EEEEEEEE},{level:5,title:"",desc:"EEE}],Mv=[{level:1,title:"EE",desc:"EEEEEEEEEE},{level:2,title:"E",desc:"EEEEEEEE},{level:3,title:"E",desc:"EEEEEEEE},{level:4,title:"",desc:"EEEEE},{level:5,title:"",desc:"EEEEEEEEEEEEE}];class Pv{build(n,s,o,a,u,f,c){const p=s??n.currentNodeId,g=a?.trim()??"",y=u?.trim()||void 0,v=f?.trim()||void 0;if(p===null)return{chatHistory:"",userInput:g};const w=Ov(n,p);if(w.length===0)return{chatHistory:"",userInput:g};const S=Tv(w,o,y,v),k=zv(w[w.length-1]);return{chatHistory:S,userInput:Lv(k,g,c)}}}function Tv(r,n,s,o){const a=Math.max(0,n),u=Math.max(0,r.length-a),c=["<chat_history>",...r.map((g,y)=>{const v=`turn_${(y+1).toString().padStart(2,"0")}`,S=(y>=u?g.storyContent:g.summary)||g.storyContent||"",k=g.userChoice?.trim()||"EEEE;return[`## ${v}`,`**user**: ${k}`,`**game**: ${S}`,"---"].join(`
`)}),"</chat_history>"].join(`
`);return[Av(r[r.length-1],s,o),c].join(`
`)}function Av(r,n,s){return`/* system log(IGNORE the line): ${$y(r.nextAction,n,s).join("|")}*/`}function Lv(r,n,s){const o=Rv(s);return[r,n,...o].filter(Boolean).join(`

`)}function Rv(r){if(!r||!Z0(r))return[];const n=[];if(r.forceEscapeEvent&&n.push(": E, EEEEE),r.encourageLewd&&n.push(": EEEEEEEEEEEEEEE),r.forbidLewd&&n.push(": EEEEEEEEPOV"),r.suppressDespair&&n.push(": EEEEEEEE"),n.length!==0)return["<content_balance> EEEEEEEE: EEEEEEEEE,...n,"</content_balance>"]}function zv(r){return["<current_status>",...Kv(r),"",...Xv(r),"",...Vv(r),"",...Qv(r),"",...qv(r),"",...Zv(r),"",...Jv(r),"</current_status>"].filter(Boolean).join(`
`)}function Ov(r,n){const s=[];let o=r.nodes[n],a=r.nodes.length+1;for(;o&&a>0&&(s.unshift(o),o.previousNodeId!==null);)o=r.nodes[o.previousNodeId],a-=1;return s}function Fv(r){return`****: ${r||""}`}function Dv(r){const n=kv[r];return n?`**POV**: EE[${n.name}(${n.roman})],[${n.role}]E`:"**POV**: EE"}function $v(r,n){return`****: E[${r||""}],[${n||""}]`}function Bv(r,n){const s=sx(r,n),o=r?`clothes_id=\`${r}\``:'clothes_id=""';if(!s){const f=r??"E;return`**E*: E"${f}"(${o}).(EE ${f}EEEEEEEE failback EE EEid EE`}const a=s.name,u=s.description?s.description:"";return`**E*: E"${a}"(${o}).:${u}`}function Uv(r){const n=r.mapPosition?.mapId??"",s=r.mapPosition?.facilityId??"",o=fy(n,s);return`****: [${o.mapName}(id=${o.mapId})${o.facilityName}(id=${o.facilityId})]`}function No(r,n,s){const o=ds(n,0,100),{stageLabel:a}=ix(o,100,s);return`**${r}**: [${o}],[${a}]`}function qp(r){return r===void 0?0:Math.max(0,Math.min(10,Math.round(r)))}function Hv(r){return r<=2?0:r<=4?1:r<=6?2:r<=8?3:4}function Wv(r){return r?Math.max(1,Math.min(4,Math.round(r))):1}function Vv(r){return["## E,Vf("E,r.dashboardGauges?.addiction,Cv),Vf("E,r.dashboardGauges?.obedience,Iv),Gv(r.dashboardGauges?.moralScale),Yv(r.dashboardGauges?.corruption)]}function Vf(r,n,s){const o=qp(n),a=Hv(o),u=s[a],f=u.desc,p=a>=s.length-1?u.nextReq:s[a].nextReq;return`**${r}**: [${o}], [${f}]EE[${p}]`}function Gv(r){const n=qp(r);let s="E";n>=8?s="E (E)":n>=6?s="E:n<=2?s=" ()":n<=4&&(s="");const o=Wf.to_good,a=Wf.to_evil;return`**EE**: [${n}], [${s}]EE[${o}]EE[${a}]`}function Yv(r){const s=Wv(r)-1,o=Hf[s]??Hf[0],a=r??1,u=`${o.title}: ${o.desc}`,f=o.next;return`****: [${a}], [${u}], E[${f}]EE\`<dynamic_corruption_system>\``}function Kv(r){const n=Zp(r);return["## ",Fv(r.currentTime),Dv(r.gamePOV),Bv(r.portraitFrame?.bodyId,r.gamePOV),Uv(r),$v(n.displayTitle,n.trueTitle)].filter(Boolean)}function Xv(r){const n=Zp(r);return["## E,No("",n.fatigue,Sv),No("E",n.desire,Nv),No("E,n.will,_v),No("E",n.san,Ev)]}function Qv(r){const n=Object.entries(r.detailPanel?.nodes??{});return n.length===0?["## E,"* "]:["## E,...n.slice(0,5).map(([o,a])=>{const u=ds(a?.useCount,0,Number.MAX_SAFE_INTEGER),f=ds(a?.sensitivity??a?.wear,0,Number.MAX_SAFE_INTEGER),c=a?.description?`EEE{a.description}`:"";return`* ${o}:  ${u} E ${f}${c}`})]}function qv(r){const n=r.logPanel?.amount??0,s=r.logPanel?.todoList??[],o=tx(s,r.currentTime);return["## E,`EE**[${n}]** `,"EEEE,...o]}function Zv(r){return["## E",ex(r)]}function Jv(r){const n=(r.currentEventState?.eventName??"").trim(),s=(r.currentEventState?.step??"").trim();if(n&&s){const o=ds(r.currentEventState?.shot??0,0,Number.MAX_SAFE_INTEGER),a=o>0?o:1;return["## ",`E[${n}],E[${s}]EE${a}]`]}return["## ","EE"]}function Zp(r){return r.statusCard??{mood:"",location:"",displayTitle:"",trueTitle:"",fatigue:0,desire:0,will:0,san:0}}function ex(r){const n=r.mapPosition?.mapId,s=n?r.societyPanel?.regions?.[n]:void 0,o=n??"E,a=r.mapPosition?.facilityId??"";if(!s)return`****:  ${o} , E[]E[]E[]E[]`;const u=ds(s.fame,0,5),f=ds(s.reputation,0,5),c=Gf(jv,u||1),p=Gf(Mv,f||1);return`****:  ${o} (${a}), E[${u}/5 - ${c.title}]E[${c.desc}]]E[${f}/5 - ${p.title}]E[${p.desc}]]`}function Gf(r,n){const s=Math.max(1,Math.min(r.length,Math.round(n)));return r[Math.min(r.length-1,s-1)]}function tx(r,n){const s=dr(n),o=(r??[]).map(nx).filter(a=>!!a).filter(a=>{const u=Jp(a);return!Wy(u,s)});return o.length===0?["* EEEE]:o.map(a=>{const u=rx(a);return u?`* ${a.title}E ${u}E`:`* ${a.title}`})}function nx(r){if(!r)return;if(typeof r=="string"){const s=r.trim();return s?{title:s}:void 0}if(typeof r.title!="string")return;const n=r.title.trim();if(n)return{...r,title:n}}function Jp(r){return Number.isFinite(r.expiresAtMs)?r.expiresAtMs:dr(r.expiresAt)}function rx(r){if(r.expiresAt&&r.expiresAt.trim())return r.expiresAt;const n=Jp(r);if(n===void 0)return;const s=new Date(n);if(!Number.isNaN(s.getTime()))return s.toLocaleString("zh-CN")}function sx(r,n){if(r)return vc.find(s=>s.id===r&&s.pov===n)}function ds(r,n,s){const o=typeof r=="number"?r:Number(r);return!Number.isFinite(o)||o<n?n:o>s?s:o}function ix(r,n,s){const o=n/s.length,a=Math.min(s.length-1,Math.floor(o===0?0:r/o));return{stage:a+1,stageLabel:s[a]??""}}class ox{format(n,s){return n}}const ec=new fv,Yf=new vv(ec),ft=new yv({storage:bv,parser:ec,nodeFactory:Yf,formatter:new ox,promptBuilder:new Pv,initializer:new gv(Yf,ec),configProvider:mv});function ax(r){ft.setAppActions(r)}const lx=r=>`<user_input>
The user's latest choice is: ->[${r}]<-, please proceed with the story according to this choice or instruction</user_input>`,cx=()=>`story-gen-${Date.now().toString(36)}-${Math.random().toString(16).slice(2)}`;async function eh(r,n){const s=n?.targetNodeId??null,o=lx(r),u={selectedAction:(n?.selectedAction??r).trim()||void 0,selectedAreaId:n?.selectedAreaId?.trim()||void 0},f=await ft.buildPrompt({nodeId:s??void 0,userInputMessage:o,selectedAction:u.selectedAction,selectedAreaId:u.selectedAreaId,requestFeatures:n?.requestFeatures}),c=window.TavernHelper?.getPreset?.("in_use")?.settings?.should_stream??!1,p=c?cx():void 0,g=c&&p?new xy({generationId:p,onStart:()=>ft.previewStreamingStory(""),onUpdate:v=>ft.previewStreamingStory(v)}):null;g?.attach(),console.log(`[Rii-DEBUG]: stream is ${c}`);let y;try{y=await window.TavernHelper.generate({user_input:"\nRead the xml tag `<user_input>`.\n",should_stream:c,generation_id:p,injects:[{role:"system",content:f.userInput,position:"in_chat",depth:0,should_scan:!1}],overrides:{chat_history:f.chatHistory?{prompts:[{role:"user",content:f.chatHistory}]}:void 0}})}finally{g?.dispose()}return ft.processTurn(r,y,{targetNodeId:s,shouldNavigateToTarget:n?.shouldNavigateToTarget,formatterContext:n?.formatterContext??{target:"display",source:"ai"},requestContext:u})}async function ux(r){const n=ft.getCurrentNode(),s=n?.previousNodeId??null,o=(n?.userChoice??"").trim();if(!n||!o||s===null)return!1;const{newNode:a}=await eh(o,{targetNodeId:s,shouldNavigateToTarget:!1,formatterContext:r,selectedAction:n.requestContext?.selectedAction,selectedAreaId:n.requestContext?.selectedAreaId});if(await ft.deleteNodeAndDescendants(n.id)){const f=ft.getFullHistory(),c=[...f.nodes].reverse().find(y=>y.userChoice===o&&y.storyContent===a.storyContent),p=f.nodes.length>0?f.nodes[f.nodes.length-1].id:null,g=c?.id??p;g!==null&&await ft.navigateToNode(g)}else await ft.navigateToNode(a.id);return!0}function dx(){const r=ft.getCurrentNode();return r?{id:r.id,userChoice:r.userChoice??"",storyContent:r.storyContent??"",options:(r.nextAction??[]).map(n=>(n?.action??"").trim()).filter(Boolean)}:null}const fx=r=>r.map(n=>n.trim()).filter(Boolean).map((n,s)=>({action:n,areaId:`edited_area_${s+1}`}));async function px(r,n){return ft.updateNodeContent(r,{userChoice:n.userChoice,storyContent:n.storyContent,nextAction:fx(n.options)})}function hx({typingSpeed:r=25,onComplete:n,className:s}){const u=N.useRef([]),f=N.useRef(null),[c,p]=N.useState(6e4),[g,y]=N.useState(null),{selectedFont:v,typingEnabled:w,textOpacity:S,storyFontSize:k,storyPadding:E}=ps(),C=pt("mainTextBox"),I=pt("basic"),b=pt("requestFeatures"),{layoutVariant:M}=si(),{statusCardProps:D,gaugesValues:L,woodenSignTime:F,characterName:H}=wc(),q=cc(),te=uc("requestFeatures"),[K,z]=N.useState(!1),[W,ae]=N.useState(!1),[ee,he]=N.useState(!1),[Z,ce]=N.useState(""),[O,V]=N.useState(""),[Y,P]=N.useState(""),[_,B]=N.useState([]),[X,J]=N.useState(null),ne=N.useRef(Promise.resolve()),se=N.useRef(null),pe=N.useRef(null),ge=N.useRef(null),[_e,A]=N.useState(null),ue=N.useRef(!1),oe=N.useMemo(()=>(C.options??[]).map(Te=>Te.trim()).filter(Boolean).slice(0,4),[C.options]),me=N.useMemo(()=>(C.content??"").replace(/\r\n/g,`
`),[C.content]),Q=!!C.parseFailed,fe=window.TavernHelper?.getPreset?.("in_use")?.settings?.should_stream??!1;N.useEffect(()=>{ue.current=!1},[I.nodeID]),N.useEffect(()=>{if(!me){ue.current=!1;return}if(ue.current)return;const Ee=se.current?.closest(".app-scroll");Ee&&(Ee.scrollTop=0,ue.current=!0)},[me]);const we=Ee=>{if(!Number.isFinite(Ee)||Ee<=0)return;const Te=Math.min(Math.max(Ee,6e4*.25),6e4*3),Me=[...u.current,Te];Me.length>8&&Me.splice(0,Me.length-8),u.current=Me},Ce=()=>{const Ee=u.current;if(Ee.length===0)return 6e4;const Te=Ee.slice(-8).sort((At,_t)=>At-_t),Me=Te[Math.floor(Te.length/2)],We=Te.reduce((At,_t)=>At+_t,0)/Te.length,Be=Me*.6+We*.4,ot=6e4*.5+Be*.5,bt=6e4*.55,hn=6e4*1.6;return Math.min(Math.max(ot,bt),hn)},Re=oe.join("||");N.useEffect(()=>{K||y(null)},[Re,K]);const Fe=Ee=>Ee.replace(/<br\s*\/?>/gi,`
`),it=Ee=>Ee.replace(/\r?\n/g,"<br/>"),Ze=Ee=>{Ee&&(Ee.style.height="auto",Ee.style.height=`${Ee.scrollHeight}px`)};N.useEffect(()=>{ee&&Ze(pe.current)},[ee,Y,Z]);const ze=()=>{const Ee=dx();Ee&&(J(Ee.id),V(Ee.userChoice??""),ce(Fe(Ee.userChoice)),P(Fe(Ee.storyContent)),B(Ee.options.slice(0,4)),he(!0),requestAnimationFrame(()=>{Ze(pe.current)}))},Je=()=>{he(!1),J(null),V(""),ce(""),P(""),B([])},Ye=(Ee,Te)=>{const Me=Ee.trim();if(!Me||K||ee)return Promise.resolve();const We=Ce();Te?.optionKey&&y(Te.optionKey),p(We);const Be={...b},ot=ne.current.then(async()=>{ue.current=!1,z(!0),f.current=performance.now();try{await eh(Me,{formatterContext:{target:"display",source:"ai"},selectedAreaId:Te?.selectedAreaId,requestFeatures:Be})}catch(bt){console.error("[MainTextBox] Failed to process story request",bt)}finally{const bt=f.current;bt&&we(performance.now()-bt),f.current=null,z(!1),y(null),te($p)}});return ne.current=ot.catch(()=>{}),ot},Mt=()=>{if(K||W||ee)return;const Ee=Ce();p(Ee);const Te=ne.current.then(async()=>{ue.current=!1,z(!0),ae(!0),f.current=performance.now();try{await ux({target:"display",source:"ai"})||console.warn("[MainTextBox] Regenerate skipped: no eligible node")}catch(Me){console.error("[MainTextBox] Failed to regenerate node",Me)}finally{const Me=f.current;Me&&we(performance.now()-Me),f.current=null,ae(!1),z(!1),y(null)}});ne.current=Te.catch(()=>{})},gt=()=>{if(!ee||X===null)return;const Ee=O,Te=it(Y.trim()),Me=_.map(Be=>Be.trim()).filter(Boolean),We=ne.current.then(async()=>{z(!0);try{await px(X,{userChoice:Ee,storyContent:Te,options:Me})&&Je()}catch(Be){console.error("[MainTextBox] Failed to save edits",Be)}finally{z(!1)}});ne.current=We.catch(()=>{})},ut=(Ee,Te)=>{Ee&&(K||ee||Ye(Ee,{optionKey:Te,source:"option"}))},nt=(Ee,Te)=>Ee?Ye(Ee,{source:"map",selectedAreaId:Te}):Promise.resolve(),Ke={naikai:"font-naikai",fzyousong:"font-fzyousong",system:"font-sans"},et=!!H,Sn=Nt.resolvePath(`/images/${I.currPOV}/speak.webp`),yt="font-naikai text-charcoal-800 text-base leading-relaxed text-center",pr=`${Ke[v]||"font-naikai"} text-charcoal-800 leading-relaxed whitespace-pre-line text-left`,pn=C.mapPosition??{mapId:null,facilityId:null},Ht=M==="mobile-inline";return N.useEffect(()=>{if(!Ht){A(null);return}const Ee=ge.current?.querySelector(".character-frame");if(!Ee||typeof ResizeObserver>"u")return;const Te=new ResizeObserver(We=>{const Be=We[0];if(!Be?.contentRect)return;const ot=Math.round(Be.contentRect.height);A(ot>0?ot:null)});Te.observe(Ee);const Me=Ee.getBoundingClientRect().height;return A(Me>0?Math.round(Me):null),()=>Te.disconnect()},[Ht]),h.jsxs("div",{ref:se,className:xe("main-text-box",s),children:[h.jsx("div",{className:"absolute inset-0 border-3 border-sakura-300 rounded-lg pointer-events-none"}),h.jsx("div",{className:"absolute inset-2 border-1 border-sakura-100 rounded-md pointer-events-none"}),h.jsx("div",{className:"washi-tape washi-tape--lt pointer-events-none"}),h.jsx("div",{className:"washi-tape washi-tape--rt pointer-events-none"}),h.jsx("div",{className:"corner-sticker corner-sticker--rb pointer-events-none","aria-hidden":!0}),h.jsx("div",{className:"absolute top-2 left-2 w-1 h-1 bg-sakura-500 rounded-full pointer-events-none"}),h.jsx("div",{className:"absolute top-2 right-2 w-1 h-1 bg-sakura-500 rounded-full pointer-events-none"}),h.jsx("div",{className:"absolute bottom-2 left-2 w-1 h-1 bg-sakura-500 rounded-full pointer-events-none"}),h.jsx("div",{className:"absolute bottom-2 right-2 w-1 h-1 bg-sakura-500 rounded-full pointer-events-none"}),h.jsxs("div",{className:"main-text-box-content paper-noise",style:{paddingLeft:`${E}px`,paddingRight:`${E}px`},children:[et&&h.jsxs("div",{className:"mb-6",children:[h.jsxs("div",{className:"mb-2 flex flex-wrap items-center gap-3",children:[h.jsx("h3",{className:"font-cpTitle font-semibold text-sakura-500 text-2xl leading-tight",children:H}),Q&&h.jsx("span",{className:"inline-flex items-center gap-1 rounded-full border-2 border-dashed border-lavender-300 bg-paper-cream px-3 py-1 text-sm font-cpTitle text-lavender-600",children:"EEE"}),Q&&fe&&h.jsx("span",{className:"inline-flex items-center gap-1 rounded-full border-2 border-dashed border-red-300 bg-paper-cream px-3 py-1 text-sm font-cpTitle text-red-600",children:"EEE"}),h.jsxs("div",{className:"main-text-actions ml-auto",children:[h.jsx("button",{type:"button",className:"main-text-action-button main-text-action-button--regen","data-active":W,title:"E","aria-label":"E",onClick:Mt,disabled:K||W,children:h.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"main-text-action-icon",children:h.jsx("path",{d:"M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"})})}),h.jsx("button",{type:"button",className:"main-text-action-button main-text-action-button--edit","data-active":ee,title:ee?"E:"E,"aria-label":ee?"E:"EE,onClick:()=>{ee?gt():ze()},disabled:K||W,children:h.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"main-text-action-icon",children:[h.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),h.jsx("path",{d:"m18.5 2.5 3 3L12 15l-4 1 1-4z"})]})})]})]}),h.jsx("div",{className:"w-8 h-0.5 bg-sakura-300"})]}),h.jsx("div",{className:"w-full mb-8",children:ee?h.jsx("div",{className:"relative rounded-2xl border-2 border-dashed border-matcha-300 bg-paper-cream px-6 py-5 space-y-4",children:h.jsx("div",{children:h.jsx("textarea",{className:"w-full rounded-lg border border-matcha-200 bg-white/80 px-3 py-2 text-base leading-relaxed focus:outline-none focus:ring-2 focus:ring-matcha-300",value:Y,onChange:Ee=>P(Ee.target.value),rows:6,ref:pe,style:{overflow:"hidden"},placeholder:"EAI E"})})}):me?h.jsx("div",{className:"relative rounded-2xl border-2 border-dashed border-sakura-300 bg-paper-cream px-6 py-5",style:{backgroundColor:`rgba(255, 252, 248, ${S})`},children:h.jsx(ny,{content:me,typingEnabled:w,typingSpeed:r,className:pr,style:{fontSize:`${k}em`},onComplete:n})}):h.jsx("div",{className:"text-charcoal-400 text-base leading-relaxed italic text-center",children:"EE...E"})}),Ht&&h.jsxs("div",{className:"mb-6 space-y-3",children:[h.jsx("div",{className:"w-full flex justify-center",children:h.jsx(bc,{currentTime:F,className:"w-full"})}),h.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 items-start",children:[h.jsx("div",{className:"col-span-1 flex justify-center items-stretch",ref:ge,children:h.jsx(xc,{})}),h.jsx("div",{className:"col-span-1 flex justify-center items-stretch min-w-0",children:h.jsx(mc,{...D,className:"w-full max-w-[360px] min-h-[320px] min-w-0 h-full",style:_e?{minHeight:_e}:void 0})}),h.jsx("div",{className:"col-span-2 sm:col-span-1 flex justify-center",children:h.jsx(pc,{className:"w-full max-w-[360px]",variant:"rowCompact",values:L})})]})]}),h.jsx(yy,{optionTexts:ee?_:oe,optionTextClass:yt,isSending:K||W,editMode:ee,editableOptions:_,onEditableOptionsChange:Ee=>B(Ee.slice(0,4)),expectedDurationMs:c,selectedOptionKey:g,onOptionClick:ut,onMapTravelPrompt:nt,mapPosition:pn,onMapPositionChange:({mapId:Ee,facilityId:Te})=>{q({type:"PATCH_SLICE",slice:"mainTextBox",patch:{mapPosition:{mapId:Ee,facilityId:Te}}})},characterImageSrc:Sn}),Ht&&h.jsx("div",{className:"mt-4 w-full flex justify-center",children:h.jsx(yc,{className:"w-full max-w-[360px]"})})]}),h.jsx("div",{className:"doodle-floating doodle-floating--lt",children:"E}),h.jsx("div",{className:"doodle-floating doodle-floating--lb",children:"E}),h.jsx("div",{className:"doodle-floating doodle-floating--rt",children:""}),h.jsx("div",{className:"doodle-floating doodle-floating--rb",children:"EE})]})}const th={sakura:"bg-sakura-100 text-sakura-700/80 border-sakura-300 hover:bg-sakura-300 active:bg-sakura-300",matcha:"bg-matcha-100 text-matcha-700/80 border-matcha-300 hover:bg-matcha-300 active:bg-matcha-300",mist:"bg-mist-100 text-mist-700/80 border-mist-300 hover:bg-mist-300 active:bg-mist-300",lavender:"bg-lavender-100 text-lavender-700/80 border-lavender-300 hover:bg-lavender-300 active:bg-lavender-300"},nh={sakura:"bg-sakura-300",matcha:"bg-matcha-300",mist:"bg-mist-300",lavender:"bg-lavender-300"},mx=[{id:"mouth",position:{x:.2,y:.3},triggerPosition:{x:-.01,y:-.15},img:"",title:""},{id:"vagina",position:{x:.2,y:.7},triggerPosition:{x:.02,y:.25},img:"",title:""},{id:"anus",position:{x:.8,y:.75},triggerPosition:{x:-.04,y:.32},img:"",title:""},{id:"uterus",position:{x:.85,y:.5},triggerPosition:{x:-.015,y:.15},img:"",title:""},{id:"breasts",position:{x:.8,y:.2},triggerPosition:{x:-.08,y:-.01},img:"",title:""}],tc=4,gx={mouth:[{img:"/images/part/1.webp",description:"EEEEEEEEEEEEEEE},{img:"/images/part/2.webp",description:"EEEEEEEEEEE},{img:"/images/part/3.webp",description:"EEEEEEEEEEEEE},{img:"/images/part/4.webp",description:"EEEEEEEEEEEEEE"}],vagina:[{img:"/images/part/1.webp",description:"EEEEEEEE},{img:"/images/part/2.webp",description:"EEEEEEEEEE"},{img:"/images/part/3.webp",description:"EEEEEEEEEEEEEEEEEE},{img:"/images/part/4.webp",description:"EEEEEEEEEEEEEEEEEEE"}],anus:[{img:"/images/part/E.webp",description:"EEEEEEEEEEEEE},{img:"/images/part/E.webp",description:"EEEEEEEEEEEEE},{img:"/images/part/E.webp",description:"EEEEEEEEEEEEEEEEEEE"},{img:"/images/part/E.webp",description:"EEEEEEEEEEEEEEE}],uterus:[{img:"/images/part/1_2.webp",description:"EEEEEEEE},{img:"/images/part/1_2.webp",description:"EEEEEEEEEEEEEEEEEEEEE},{img:"/images/part/3.webp",description:"EEEEEEEEEEE"},{img:"/images/part/4.webp",description:"EEEEEEEEEEEEEEEE}],breasts:[{img:"/images/part/1.webp",description:"EEEEEEEEEEEEE},{img:"/images/part/2.webp",description:"EEEEEEEEEEEE},{img:"/images/part/3.webp",description:"EEEEEEEEEEEEEEEEE},{img:"/images/part/4.webp",description:"EEEEEEEEEEEEEEE"}]},rh=r=>Number.isFinite(r)?Math.max(1,Math.min(tc,Math.round(r??1))):1,yx=r=>Number.isFinite(Number(r))?Number(r):0,vx=r=>yx(r?.sensitivity??r?.wear),xx={mouth:[50,250,1500],vagina:[60,300,2e3],anus:[40,200,1200],uterus:[30,150,1e3],breasts:[30,150,800]},wx={mouth:r=>qs("mouth",r),vagina:r=>qs("vagina",r),anus:r=>qs("anus",r),uterus:r=>qs("uterus",r),breasts:r=>qs("breasts",r)},qs=(r,n)=>{const s=Number.isFinite(Number(n?.useCount))?Number(n.useCount):0,[o,a,u]=xx[r];return s<o?1:s<a?2:s<u?3:4},bx=(r,n)=>{const s=wx[r];return s?s(n):1},kx=(r,n)=>{const s=gx[r];if(!s?.length)return;const o=rh(n),a=Math.min(o,s.length)-1;return s[a]};function Sx(){const r=pt("detailPanel"),n=pt("basic"),s=N.useMemo(()=>mx.map(_=>{const B=r.nodes[_.id],X=bx(_.id,B),J=kx(_.id,X),ne=vx(B);return{..._,description:J?.description??B?.description??"",img:J?Nt.resolvePath(J.img):_.img,magicLevel:X,useCount:B?.useCount??0,sensitivity:ne}}),[r.nodes]),o=Nt.resolvePath(`/images/${n.currPOV}/status.webp`),a=Wo(),u=N.useRef(null),f=N.useRef(null),[c,p]=N.useState({width:0,height:0}),[g,y]=N.useState(null),[v,w]=N.useState(null),[S,k]=N.useState(null),[E,C]=N.useState(!1),[I,b]=N.useState(null),[M,D]=N.useState({width:0,height:0}),L=N.useRef(null),F=N.useRef(null),H=N.useRef(new Map),q=N.useRef(!1),[te,K]=N.useState(!1),z=N.useRef(null),W=N.useRef(null);N.useEffect(()=>{const _=()=>{if(f.current){const B=f.current.getBoundingClientRect();p({width:B.width,height:B.height})}};return _(),window.addEventListener("resize",_),()=>window.removeEventListener("resize",_)},[]),N.useEffect(()=>{if(!o){L.current=null,F.current=null,K(!1);return}K(!1);const _=new Image;_.crossOrigin="anonymous";const B=()=>{L.current=_;const J=document.createElement("canvas");J.width=_.width,J.height=_.height;const ne=J.getContext("2d");ne&&(ne.imageSmoothingEnabled=!0,ne.imageSmoothingQuality="high",ne.filter="blur(12px)",ne.drawImage(_,0,0,_.width,_.height),ne.filter="none",ne.globalCompositeOperation="source-in",ne.fillStyle="rgba(92, 18, 83, 0.9)",ne.fillRect(0,0,_.width,_.height)),F.current=J,K(!0)},X=()=>{console.warn("Failed to load tree image:",o),L.current=null,F.current=null,K(!1)};return _.addEventListener("load",B),_.addEventListener("error",X),_.src=o,()=>{_.removeEventListener("load",B),_.removeEventListener("error",X)}},[o]);const ae=(_,B,X,J,ne,se,pe)=>{let ge=0,_e=0,A="bottom";if(pe){ge=_-ne/2;const Q=B+50+se<=J,fe=B-50-se>=0;Q?(_e=B+50,A="bottom"):fe?(_e=B-50-se,A="top"):(_e=B+50,A="bottom")}else{let fe=!0;_-16-ne<0?fe=!1:_+16+ne>X&&(fe=!0);let we=!0;B-12-se<0?we=!1:B+12+se>J&&(we=!0),ge=fe?_-16-ne:_+16,_e=we?B-12-se:B+12,A=we?"top":"bottom"}ne>0&&se>0&&X>0&&J>0&&(ge=Math.max(0,Math.min(ge,X-ne)),_e=Math.max(0,Math.min(_e,J-se)));const ue=_e,oe=J-(_e+se);return A=ue>oe?"bottom":"top",{left:ge,top:_e,placedSide:A}},ee=N.useMemo(()=>!I||!S||!c.width||!c.height?null:ae(I.x,I.y,c.width,c.height,M.width,M.height,a),[I,S,c,M,a]);N.useEffect(()=>{if(!u.current||c.width===0)return;const _=u.current,B=_.getContext("2d");if(!B)return;const X=window.devicePixelRatio||1;_.width=c.width*X,_.height=c.height*X,B.scale(X,X);let J;const ne=se=>{q.current=!1,B.clearRect(0,0,c.width,c.height),he(B,c.width,c.height),te&&L.current&&Z(B,L.current,F.current,c.width,c.height),s.forEach(pe=>{const ge=pe.id===g,_e=pe.id===v;ce(B,pe,c.width,c.height,{isHovered:ge,hoverTime:ge?se:0,isActive:_e,isMobileMode:a,panelRect:_e&&ee?{x:ee.left,y:ee.top,width:M.width,height:M.height,placedSide:ee.placedSide}:void 0})}),(a||g||q.current)&&(J=window.requestAnimationFrame(ne))};return ne(performance.now()),()=>{J&&window.cancelAnimationFrame(J)}},[c,s,g,v,te,a,ee,M]),N.useEffect(()=>{if(!s.length){k(null),C(!1),z.current!==null&&(window.clearTimeout(z.current),z.current=null);return}const _=a?v:g,B=_?s.find(X=>X.id===_)??null:null;if(B){z.current!==null&&(window.clearTimeout(z.current),z.current=null),k(B),C(!0);return}if(!S){C(!1);return}C(!1),z.current!==null&&window.clearTimeout(z.current),z.current=window.setTimeout(()=>{z.current=null,k(null)},120)},[g,v,s,S,a]),N.useEffect(()=>()=>{z.current!==null&&window.clearTimeout(z.current)},[]),N.useEffect(()=>{if(!W.current)return;const _=W.current.getBoundingClientRect();D({width:_.width,height:_.height})},[S,E,c.width,c.height]);const he=(_,B,X)=>{_.fillStyle="#05030a",_.fillRect(0,0,B,X);const J=B/2,ne=X/2,se=Math.sqrt(B*B+X*X)/2,pe=_.createRadialGradient(J,ne,0,J,ne,se);pe.addColorStop(0,"#5c1235"),pe.addColorStop(.35,"#3b145e"),pe.addColorStop(.75,"#12091f"),pe.addColorStop(1,"#000000"),_.fillStyle=pe,_.fillRect(0,0,B,X)},Z=(_,B,X,J,ne)=>{const se=ne/B.height,pe=B.width*se,ge=ne,_e=(J-pe)/2,A=0;_.imageSmoothingEnabled=!0,_.imageSmoothingQuality="high",X&&_.drawImage(X,0,0,X.width,X.height,_e,A,pe,ge),_.drawImage(B,0,0,B.width,B.height,_e,A,pe,ge)},ce=(_,B,X,J,ne)=>{const{isHovered:se=!1,hoverTime:pe=0,isActive:ge=!1,isMobileMode:_e=!1,panelRect:A}=ne??{};if(_e&&!ge){const Te=X/2,Me=J/2;let We=X;if(L.current){const mr=J/L.current.height;We=L.current.width*mr}const Be=Te+B.triggerPosition.x*We,ot=Me+B.triggerPosition.y*J,bt="#f06ba5",hn="#ff8ec5";_.save(),_.translate(Be,ot);const At=10,_t=performance.now(),ai=se?1.18:1+Math.sin(_t*.003)*.1,Lr=(At+8)*ai,Dn=_.createRadialGradient(0,0,0,0,0,Lr);Dn.addColorStop(0,"rgba(240, 107, 165, 0.95)"),Dn.addColorStop(.45,"rgba(240, 107, 165, 0.6)"),Dn.addColorStop(.8,"rgba(240, 107, 165, 0.25)"),Dn.addColorStop(1,"rgba(240, 107, 165, 0)"),_.fillStyle=Dn,_.beginPath(),_.arc(0,0,Lr,0,Math.PI*2),_.fill();const $n=2600,Rr=_t%$n/$n,hr=At+10+Rr*6,Ko=(1-Rr)*.45;_.strokeStyle=`rgba(248, 187, 217, ${Ko.toFixed(2)})`,_.lineWidth=2,_.beginPath(),_.arc(0,0,hr,0,Math.PI*2),_.stroke(),_.strokeStyle=se?hn:bt,_.lineWidth=2,_.beginPath(),_.arc(0,0,At,0,Math.PI*2),_.stroke(),se&&(_.save(),_.setLineDash([4,3]),_.strokeStyle="rgba(255, 255, 255, 0.6)",_.lineWidth=1.5,_.lineDashOffset=-_t*.05,_.beginPath(),_.arc(0,0,At+6,0,Math.PI*2),_.stroke(),_.restore()),_.restore();return}let ue=B.position.x*X,oe=B.position.y*J;if(_e){const Te=X/2,Me=J/2;let We=X;if(L.current){const Be=J/L.current.height;We=L.current.width*Be}ue=Te+B.triggerPosition.x*We,oe=Me+B.triggerPosition.y*J,ge&&A&&(A.placedSide==="bottom"?oe=A.y-12-38:oe=A.y+A.height+12+38)}const me="#f06ba5",Q="#ff8ec5",fe="rgba(5, 3, 16, 0.92)",we="rgba(18, 6, 29, 0.98)",Ce="#4a1036",Re="#f5f5ff",Fe="#cbc7ff",it=200,Ze=76,ze=Ze/2;_.save(),_.translate(ue,oe);const Je=-it/2,Ye=-Ze/2,Mt=0,gt=Je+it,ut=Ye+Ze,nt=ze,Ke=Je+Ze/2,et=0,Sn=rh(B.magicLevel);_.fillStyle=se||ge?we:fe,_.strokeStyle=se||ge?Q:me,_.lineWidth=2;const yt=new Path2D;if(yt.moveTo(Je+ze,Ye),yt.lineTo(gt-ze,Ye),yt.arc(gt-ze,Mt,ze,-Math.PI/2,Math.PI/2,!1),yt.lineTo(Je+ze,ut),yt.arc(Je+ze,Mt,ze,Math.PI/2,-Math.PI/2,!1),yt.closePath(),_.fill(yt),_.stroke(yt),(se||ge)&&(_.save(),_.setLineDash([4,3]),_.strokeStyle="rgba(248, 187, 217, 0.85)",_.lineWidth=1.5,_.stroke(yt),_.restore()),_.save(),_.fillStyle=Ce,_.beginPath(),_.arc(Ke,et,nt,0,Math.PI*2),_.closePath(),_.fill(),B.img){const Te=H.current.get(B.img);if(Te)if(!Te.complete)q.current=!0;else{_.save(),_.beginPath(),_.arc(Ke,et,nt,0,Math.PI*2),_.closePath(),_.clip();const Me=nt*2;_.drawImage(Te,Ke-Me/2,et-Me/2,Me,Me),_.restore()}else{const Me=new Image;Me.crossOrigin="anonymous",Me.onload=()=>{q.current=!0},Me.src=B.img,H.current.set(B.img,Me),q.current=!0}}else{const Te=B.title?.[0]??"";_.fillStyle=Re,_.font='600 20px "NaikaiFont-SemiBold"',_.textAlign="center",_.textBaseline="middle",_.fillText(Te,Ke,et)}if((()=>{const Te=Math.PI*2/tc,Me=Math.PI/12,We=nt-2,Be=We-3,ot=me;for(let bt=0;bt<tc;bt+=1){const hn=-Math.PI/2+bt*Te+Me/2,At=hn+Te-Me,_t=new Path2D;_t.arc(Ke,et,We,hn,At),_t.arc(Ke,et,Be,At,hn,!0),_t.closePath(),bt<Sn&&(_.fillStyle=ot,_.fill(_t)),_.strokeStyle=ot,_.lineWidth=1,_.lineJoin="round",_.stroke(_t)}})(),se||ge){const Te=nt+6,Me=[2,3];_.save(),_.strokeStyle="rgba(248, 187, 217, 0.7)",_.lineWidth=1.2,_.setLineDash(Me);const We=.06;_.lineDashOffset=-((pe??0)*We)%(Me[0]+Me[1]),_.beginPath(),_.arc(Ke,et,Te,0,Math.PI*2),_.closePath(),_.stroke(),_.restore()}_.restore();const pn=Je+Ze+8,Ht=Ye+20,Ee=Ye+46;_.fillStyle=se||ge?"#fdf2ff":Fe,_.font='14px "NaikaiFont-SemiBold"',_.textAlign="left",_.textBaseline="top",_.fillText(":",pn,Ht),_.fillText(":",pn,Ee),_.fillStyle=se||ge?Q:me,_.font='700 18px "NaikaiFont-SemiBold"',_.fillText(String(B.useCount),pn+72,Ht-2),_.fillText(`${B.sensitivity}%`,pn+72,Ee-2),_.restore()},O=(_,B)=>{const{width:X,height:J}=c;if(!X||!J)return null;if(a){const se=X/2,pe=J/2;let ge=X;if(L.current){const _e=J/L.current.height;ge=L.current.width*_e}for(let _e=s.length-1;_e>=0;_e-=1){const A=s[_e],ue=se+A.triggerPosition.x*ge,oe=pe+A.triggerPosition.y*J,me=_-ue,Q=B-oe;if(me*me+Q*Q<=576)return A}}else for(let ge=s.length-1;ge>=0;ge-=1){const _e=s[ge],A=_e.position.x*X,ue=_e.position.y*J,oe=A-200/2+76/2,me=ue,Q=_-oe,fe=B-me;if(Q*Q+fe*fe<=1444)return _e}return null},V=_=>{if(!u.current)return;const B=u.current.getBoundingClientRect(),X=_.clientX-B.left,J=_.clientY-B.top,ne=O(X,J);ne&&b({x:X,y:J}),y(se=>{const pe=ne?.id??null;return se===pe?se:pe})},Y=()=>{y(null)},P=_=>{if(!u.current)return;const B=u.current.getBoundingClientRect(),X=_.clientX-B.left,J=_.clientY-B.top,ne=O(X,J);if(ne)if(a){w(me=>me===ne.id?null:ne.id);const{width:se,height:pe}=c,ge=se/2,_e=pe/2;let A=se;if(L.current){const me=pe/L.current.height;A=L.current.width*me}const ue=ge+ne.triggerPosition.x*A,oe=_e+ne.triggerPosition.y*pe;b({x:ue,y:oe})}else w(ne.id),b({x:X,y:J});else a&&w(null)};return s.length===0?h.jsx("div",{className:"top-panel__content paper-noise",children:h.jsx("div",{className:"detail-panel__empty",children:""})}):h.jsx("div",{className:"top-panel__content paper-noise",children:h.jsxs("div",{ref:f,className:"detail-panel",children:[h.jsx("canvas",{ref:u,className:"detail-panel__canvas",style:{width:"100%",height:"100%"},onMouseMove:V,onMouseLeave:Y,onClick:P}),S&&I&&(()=>{const{width:_,height:B}=c,{width:X,height:J}=M,ne=I.x,se=I.y;let pe=0,ge=0;if(a){pe=ne-X/2;const A=se+50+J<=B,ue=se-50-J>=0;A?ge=se+50:ue?ge=se-50-J:ge=se+50}else{let ue=!0;ne-16-X<0?ue=!1:ne+16+X>_&&(ue=!0);let oe=!0;se-12-J<0?oe=!1:se+12+J>B&&(oe=!0),pe=ue?ne-16-X:ne+16,ge=oe?se-12-J:se+12}return X>0&&J>0&&_>0&&B>0&&(pe=Math.max(0,Math.min(pe,_-X)),ge=Math.max(0,Math.min(ge,B-J))),h.jsx("div",{ref:W,className:"detail-panel__node-panel",style:{left:pe,top:ge,opacity:E?1:0,pointerEvents:E?"auto":"none",...a?{minWidth:"unset",width:"220px",padding:"10px"}:{}},children:h.jsxs("div",{className:"detail-panel__node-panel-body",style:a?{flexDirection:"column",gap:"8px"}:void 0,children:[h.jsx("div",{className:"detail-panel__node-figure",style:a?{width:"100%",height:"160px"}:void 0,children:S.img?h.jsx("img",{src:S.img,alt:S.title,className:"detail-panel__node-figure-img"}):h.jsx("span",{className:"detail-panel__node-figure-initial",children:S.title?.[0]??""})}),h.jsxs("div",{className:"detail-panel__node-info",style:a?{width:"100%",height:"auto",minHeight:"120px"}:void 0,children:[h.jsx("div",{className:"detail-panel__node-info-title",children:S.title}),h.jsx("div",{className:"detail-panel__node-info-desc",children:S.description})]})]})})})()]})})}function Ol(r,n,s){if(r&&r.length){const[o,a]=n,u=Math.PI/180*s,f=Math.cos(u),c=Math.sin(u);for(const p of r){const[g,y]=p;p[0]=(g-o)*f-(y-a)*c+o,p[1]=(g-o)*c+(y-a)*f+a}}}function Nx(r,n){return r[0]===n[0]&&r[1]===n[1]}function _x(r,n,s,o=1){const a=s,u=Math.max(n,.1),f=r[0]&&r[0][0]&&typeof r[0][0]=="number"?[r]:r,c=[0,0];if(a)for(const g of f)Ol(g,c,a);const p=(function(g,y,v){const w=[];for(const b of g){const M=[...b];Nx(M[0],M[M.length-1])||M.push([M[0][0],M[0][1]]),M.length>2&&w.push(M)}const S=[];y=Math.max(y,.1);const k=[];for(const b of w)for(let M=0;M<b.length-1;M++){const D=b[M],L=b[M+1];if(D[1]!==L[1]){const F=Math.min(D[1],L[1]);k.push({ymin:F,ymax:Math.max(D[1],L[1]),x:F===D[1]?D[0]:L[0],islope:(L[0]-D[0])/(L[1]-D[1])})}}if(k.sort(((b,M)=>b.ymin<M.ymin?-1:b.ymin>M.ymin?1:b.x<M.x?-1:b.x>M.x?1:b.ymax===M.ymax?0:(b.ymax-M.ymax)/Math.abs(b.ymax-M.ymax))),!k.length)return S;let E=[],C=k[0].ymin,I=0;for(;E.length||k.length;){if(k.length){let b=-1;for(let M=0;M<k.length&&!(k[M].ymin>C);M++)b=M;k.splice(0,b+1).forEach((M=>{E.push({s:C,edge:M})}))}if(E=E.filter((b=>!(b.edge.ymax<=C))),E.sort(((b,M)=>b.edge.x===M.edge.x?0:(b.edge.x-M.edge.x)/Math.abs(b.edge.x-M.edge.x))),(v!==1||I%y==0)&&E.length>1)for(let b=0;b<E.length;b+=2){const M=b+1;if(M>=E.length)break;const D=E[b].edge,L=E[M].edge;S.push([[Math.round(D.x),C],[Math.round(L.x),C]])}C+=v,E.forEach((b=>{b.edge.x=b.edge.x+v*b.edge.islope})),I++}return S})(f,u,o);if(a){for(const g of f)Ol(g,c,-a);(function(g,y,v){const w=[];g.forEach((S=>w.push(...S))),Ol(w,y,v)})(p,c,-a)}return p}function ii(r,n){var s;const o=n.hachureAngle+90;let a=n.hachureGap;a<0&&(a=4*n.strokeWidth),a=Math.round(Math.max(a,.1));let u=1;return n.roughness>=1&&(((s=n.randomizer)===null||s===void 0?void 0:s.next())||Math.random())>.7&&(u=a),_x(r,a,o,u||1)}class Nc{constructor(n){this.helper=n}fillPolygons(n,s){return this._fillPolygons(n,s)}_fillPolygons(n,s){const o=ii(n,s);return{type:"fillSketch",ops:this.renderLines(o,s)}}renderLines(n,s){const o=[];for(const a of n)o.push(...this.helper.doubleLineOps(a[0][0],a[0][1],a[1][0],a[1][1],s));return o}}function Vo(r){const n=r[0],s=r[1];return Math.sqrt(Math.pow(n[0]-s[0],2)+Math.pow(n[1]-s[1],2))}class Ex extends Nc{fillPolygons(n,s){let o=s.hachureGap;o<0&&(o=4*s.strokeWidth),o=Math.max(o,.1);const a=ii(n,Object.assign({},s,{hachureGap:o})),u=Math.PI/180*s.hachureAngle,f=[],c=.5*o*Math.cos(u),p=.5*o*Math.sin(u);for(const[g,y]of a)Vo([g,y])&&f.push([[g[0]-c,g[1]+p],[...y]],[[g[0]+c,g[1]-p],[...y]]);return{type:"fillSketch",ops:this.renderLines(f,s)}}}class Cx extends Nc{fillPolygons(n,s){const o=this._fillPolygons(n,s),a=Object.assign({},s,{hachureAngle:s.hachureAngle+90}),u=this._fillPolygons(n,a);return o.ops=o.ops.concat(u.ops),o}}class Ix{constructor(n){this.helper=n}fillPolygons(n,s){const o=ii(n,s=Object.assign({},s,{hachureAngle:0}));return this.dotsOnLines(o,s)}dotsOnLines(n,s){const o=[];let a=s.hachureGap;a<0&&(a=4*s.strokeWidth),a=Math.max(a,.1);let u=s.fillWeight;u<0&&(u=s.strokeWidth/2);const f=a/4;for(const c of n){const p=Vo(c),g=p/a,y=Math.ceil(g)-1,v=p-y*a,w=(c[0][0]+c[1][0])/2-a/4,S=Math.min(c[0][1],c[1][1]);for(let k=0;k<y;k++){const E=S+v+k*a,C=w-f+2*Math.random()*f,I=E-f+2*Math.random()*f,b=this.helper.ellipse(C,I,u,u,s);o.push(...b.ops)}}return{type:"fillSketch",ops:o}}}class jx{constructor(n){this.helper=n}fillPolygons(n,s){const o=ii(n,s);return{type:"fillSketch",ops:this.dashedLine(o,s)}}dashedLine(n,s){const o=s.dashOffset<0?s.hachureGap<0?4*s.strokeWidth:s.hachureGap:s.dashOffset,a=s.dashGap<0?s.hachureGap<0?4*s.strokeWidth:s.hachureGap:s.dashGap,u=[];return n.forEach((f=>{const c=Vo(f),p=Math.floor(c/(o+a)),g=(c+a-p*(o+a))/2;let y=f[0],v=f[1];y[0]>v[0]&&(y=f[1],v=f[0]);const w=Math.atan((v[1]-y[1])/(v[0]-y[0]));for(let S=0;S<p;S++){const k=S*(o+a),E=k+o,C=[y[0]+k*Math.cos(w)+g*Math.cos(w),y[1]+k*Math.sin(w)+g*Math.sin(w)],I=[y[0]+E*Math.cos(w)+g*Math.cos(w),y[1]+E*Math.sin(w)+g*Math.sin(w)];u.push(...this.helper.doubleLineOps(C[0],C[1],I[0],I[1],s))}})),u}}class Mx{constructor(n){this.helper=n}fillPolygons(n,s){const o=s.hachureGap<0?4*s.strokeWidth:s.hachureGap,a=s.zigzagOffset<0?o:s.zigzagOffset,u=ii(n,s=Object.assign({},s,{hachureGap:o+a}));return{type:"fillSketch",ops:this.zigzagLines(u,a,s)}}zigzagLines(n,s,o){const a=[];return n.forEach((u=>{const f=Vo(u),c=Math.round(f/(2*s));let p=u[0],g=u[1];p[0]>g[0]&&(p=u[1],g=u[0]);const y=Math.atan((g[1]-p[1])/(g[0]-p[0]));for(let v=0;v<c;v++){const w=2*v*s,S=2*(v+1)*s,k=Math.sqrt(2*Math.pow(s,2)),E=[p[0]+w*Math.cos(y),p[1]+w*Math.sin(y)],C=[p[0]+S*Math.cos(y),p[1]+S*Math.sin(y)],I=[E[0]+k*Math.cos(y+Math.PI/4),E[1]+k*Math.sin(y+Math.PI/4)];a.push(...this.helper.doubleLineOps(E[0],E[1],I[0],I[1],o),...this.helper.doubleLineOps(I[0],I[1],C[0],C[1],o))}})),a}}const $t={};class Px{constructor(n){this.seed=n}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const Tx=0,Fl=1,Kf=2,_o={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function Dl(r,n){return r.type===n}function _c(r){const n=[],s=(function(f){const c=new Array;for(;f!=="";)if(f.match(/^([ \t\r\n,]+)/))f=f.substr(RegExp.$1.length);else if(f.match(/^([aAcChHlLmMqQsStTvVzZ])/))c[c.length]={type:Tx,text:RegExp.$1},f=f.substr(RegExp.$1.length);else{if(!f.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];c[c.length]={type:Fl,text:`${parseFloat(RegExp.$1)}`},f=f.substr(RegExp.$1.length)}return c[c.length]={type:Kf,text:""},c})(r);let o="BOD",a=0,u=s[a];for(;!Dl(u,Kf);){let f=0;const c=[];if(o==="BOD"){if(u.text!=="M"&&u.text!=="m")return _c("M0,0"+r);a++,f=_o[u.text],o=u.text}else Dl(u,Fl)?f=_o[o]:(a++,f=_o[u.text],o=u.text);if(!(a+f<s.length))throw new Error("Path data ended short");for(let p=a;p<a+f;p++){const g=s[p];if(!Dl(g,Fl))throw new Error("Param not a number: "+o+","+g.text);c[c.length]=+g.text}if(typeof _o[o]!="number")throw new Error("Bad segment: "+o);{const p={key:o,data:c};n.push(p),a+=f,u=s[a],o==="M"&&(o="L"),o==="m"&&(o="l")}}return n}function sh(r){let n=0,s=0,o=0,a=0;const u=[];for(const{key:f,data:c}of r)switch(f){case"M":u.push({key:"M",data:[...c]}),[n,s]=c,[o,a]=c;break;case"m":n+=c[0],s+=c[1],u.push({key:"M",data:[n,s]}),o=n,a=s;break;case"L":u.push({key:"L",data:[...c]}),[n,s]=c;break;case"l":n+=c[0],s+=c[1],u.push({key:"L",data:[n,s]});break;case"C":u.push({key:"C",data:[...c]}),n=c[4],s=c[5];break;case"c":{const p=c.map(((g,y)=>y%2?g+s:g+n));u.push({key:"C",data:p}),n=p[4],s=p[5];break}case"Q":u.push({key:"Q",data:[...c]}),n=c[2],s=c[3];break;case"q":{const p=c.map(((g,y)=>y%2?g+s:g+n));u.push({key:"Q",data:p}),n=p[2],s=p[3];break}case"A":u.push({key:"A",data:[...c]}),n=c[5],s=c[6];break;case"a":n+=c[5],s+=c[6],u.push({key:"A",data:[c[0],c[1],c[2],c[3],c[4],n,s]});break;case"H":u.push({key:"H",data:[...c]}),n=c[0];break;case"h":n+=c[0],u.push({key:"H",data:[n]});break;case"V":u.push({key:"V",data:[...c]}),s=c[0];break;case"v":s+=c[0],u.push({key:"V",data:[s]});break;case"S":u.push({key:"S",data:[...c]}),n=c[2],s=c[3];break;case"s":{const p=c.map(((g,y)=>y%2?g+s:g+n));u.push({key:"S",data:p}),n=p[2],s=p[3];break}case"T":u.push({key:"T",data:[...c]}),n=c[0],s=c[1];break;case"t":n+=c[0],s+=c[1],u.push({key:"T",data:[n,s]});break;case"Z":case"z":u.push({key:"Z",data:[]}),n=o,s=a}return u}function ih(r){const n=[];let s="",o=0,a=0,u=0,f=0,c=0,p=0;for(const{key:g,data:y}of r){switch(g){case"M":n.push({key:"M",data:[...y]}),[o,a]=y,[u,f]=y;break;case"C":n.push({key:"C",data:[...y]}),o=y[4],a=y[5],c=y[2],p=y[3];break;case"L":n.push({key:"L",data:[...y]}),[o,a]=y;break;case"H":o=y[0],n.push({key:"L",data:[o,a]});break;case"V":a=y[0],n.push({key:"L",data:[o,a]});break;case"S":{let v=0,w=0;s==="C"||s==="S"?(v=o+(o-c),w=a+(a-p)):(v=o,w=a),n.push({key:"C",data:[v,w,...y]}),c=y[0],p=y[1],o=y[2],a=y[3];break}case"T":{const[v,w]=y;let S=0,k=0;s==="Q"||s==="T"?(S=o+(o-c),k=a+(a-p)):(S=o,k=a);const E=o+2*(S-o)/3,C=a+2*(k-a)/3,I=v+2*(S-v)/3,b=w+2*(k-w)/3;n.push({key:"C",data:[E,C,I,b,v,w]}),c=S,p=k,o=v,a=w;break}case"Q":{const[v,w,S,k]=y,E=o+2*(v-o)/3,C=a+2*(w-a)/3,I=S+2*(v-S)/3,b=k+2*(w-k)/3;n.push({key:"C",data:[E,C,I,b,S,k]}),c=v,p=w,o=S,a=k;break}case"A":{const v=Math.abs(y[0]),w=Math.abs(y[1]),S=y[2],k=y[3],E=y[4],C=y[5],I=y[6];v===0||w===0?(n.push({key:"C",data:[o,a,C,I,C,I]}),o=C,a=I):(o!==C||a!==I)&&(oh(o,a,C,I,v,w,S,k,E).forEach((function(b){n.push({key:"C",data:b})})),o=C,a=I);break}case"Z":n.push({key:"Z",data:[]}),o=u,a=f}s=g}return n}function Zs(r,n,s){return[r*Math.cos(s)-n*Math.sin(s),r*Math.sin(s)+n*Math.cos(s)]}function oh(r,n,s,o,a,u,f,c,p,g){const y=(v=f,Math.PI*v/180);var v;let w=[],S=0,k=0,E=0,C=0;if(g)[S,k,E,C]=g;else{[r,n]=Zs(r,n,-y),[s,o]=Zs(s,o,-y);const ae=(r-s)/2,ee=(n-o)/2;let he=ae*ae/(a*a)+ee*ee/(u*u);he>1&&(he=Math.sqrt(he),a*=he,u*=he);const Z=a*a,ce=u*u,O=Z*ce-Z*ee*ee-ce*ae*ae,V=Z*ee*ee+ce*ae*ae,Y=(c===p?-1:1)*Math.sqrt(Math.abs(O/V));E=Y*a*ee/u+(r+s)/2,C=Y*-u*ae/a+(n+o)/2,S=Math.asin(parseFloat(((n-C)/u).toFixed(9))),k=Math.asin(parseFloat(((o-C)/u).toFixed(9))),r<E&&(S=Math.PI-S),s<E&&(k=Math.PI-k),S<0&&(S=2*Math.PI+S),k<0&&(k=2*Math.PI+k),p&&S>k&&(S-=2*Math.PI),!p&&k>S&&(k-=2*Math.PI)}let I=k-S;if(Math.abs(I)>120*Math.PI/180){const ae=k,ee=s,he=o;k=p&&k>S?S+120*Math.PI/180*1:S+120*Math.PI/180*-1,w=oh(s=E+a*Math.cos(k),o=C+u*Math.sin(k),ee,he,a,u,f,0,p,[k,ae,E,C])}I=k-S;const b=Math.cos(S),M=Math.sin(S),D=Math.cos(k),L=Math.sin(k),F=Math.tan(I/4),H=4/3*a*F,q=4/3*u*F,te=[r,n],K=[r+H*M,n-q*b],z=[s+H*L,o-q*D],W=[s,o];if(K[0]=2*te[0]-K[0],K[1]=2*te[1]-K[1],g)return[K,z,W].concat(w);{w=[K,z,W].concat(w);const ae=[];for(let ee=0;ee<w.length;ee+=3){const he=Zs(w[ee][0],w[ee][1],y),Z=Zs(w[ee+1][0],w[ee+1][1],y),ce=Zs(w[ee+2][0],w[ee+2][1],y);ae.push([he[0],he[1],Z[0],Z[1],ce[0],ce[1]])}return ae}}const Ax={randOffset:function(r,n){return Pe(r,n)},randOffsetWithRange:function(r,n,s){return zo(r,n,s)},ellipse:function(r,n,s,o,a){const u=lh(s,o,a);return nc(r,n,a,u).opset},doubleLineOps:function(r,n,s,o,a){return fr(r,n,s,o,a,!0)}};function ah(r,n,s,o,a){return{type:"path",ops:fr(r,n,s,o,a)}}function Ao(r,n,s){const o=(r||[]).length;if(o>2){const a=[];for(let u=0;u<o-1;u++)a.push(...fr(r[u][0],r[u][1],r[u+1][0],r[u+1][1],s));return n&&a.push(...fr(r[o-1][0],r[o-1][1],r[0][0],r[0][1],s)),{type:"path",ops:a}}return o===2?ah(r[0][0],r[0][1],r[1][0],r[1][1],s):{type:"path",ops:[]}}function Lx(r,n,s,o,a){return(function(u,f){return Ao(u,!0,f)})([[r,n],[r+s,n],[r+s,n+o],[r,n+o]],a)}function Xf(r,n){if(r.length){const s=typeof r[0][0]=="number"?[r]:r,o=Eo(s[0],1*(1+.2*n.roughness),n),a=n.disableMultiStroke?[]:Eo(s[0],1.5*(1+.22*n.roughness),Zf(n));for(let u=1;u<s.length;u++){const f=s[u];if(f.length){const c=Eo(f,1*(1+.2*n.roughness),n),p=n.disableMultiStroke?[]:Eo(f,1.5*(1+.22*n.roughness),Zf(n));for(const g of c)g.op!=="move"&&o.push(g);for(const g of p)g.op!=="move"&&a.push(g)}}return{type:"path",ops:o.concat(a)}}return{type:"path",ops:[]}}function lh(r,n,s){const o=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(r/2,2)+Math.pow(n/2,2))/2)),a=Math.ceil(Math.max(s.curveStepCount,s.curveStepCount/Math.sqrt(200)*o)),u=2*Math.PI/a;let f=Math.abs(r/2),c=Math.abs(n/2);const p=1-s.curveFitting;return f+=Pe(f*p,s),c+=Pe(c*p,s),{increment:u,rx:f,ry:c}}function nc(r,n,s,o){const[a,u]=Jf(o.increment,r,n,o.rx,o.ry,1,o.increment*zo(.1,zo(.4,1,s),s),s);let f=Oo(a,null,s);if(!s.disableMultiStroke&&s.roughness!==0){const[c]=Jf(o.increment,r,n,o.rx,o.ry,1.5,0,s),p=Oo(c,null,s);f=f.concat(p)}return{estimatedPoints:u,opset:{type:"path",ops:f}}}function Qf(r,n,s,o,a,u,f,c,p){const g=r,y=n;let v=Math.abs(s/2),w=Math.abs(o/2);v+=Pe(.01*v,p),w+=Pe(.01*w,p);let S=a,k=u;for(;S<0;)S+=2*Math.PI,k+=2*Math.PI;k-S>2*Math.PI&&(S=0,k=2*Math.PI);const E=2*Math.PI/p.curveStepCount,C=Math.min(E/2,(k-S)/2),I=ep(C,g,y,v,w,S,k,1,p);if(!p.disableMultiStroke){const b=ep(C,g,y,v,w,S,k,1.5,p);I.push(...b)}return f&&(c?I.push(...fr(g,y,g+v*Math.cos(S),y+w*Math.sin(S),p),...fr(g,y,g+v*Math.cos(k),y+w*Math.sin(k),p)):I.push({op:"lineTo",data:[g,y]},{op:"lineTo",data:[g+v*Math.cos(S),y+w*Math.sin(S)]})),{type:"path",ops:I}}function qf(r,n){const s=ih(sh(_c(r))),o=[];let a=[0,0],u=[0,0];for(const{key:f,data:c}of s)switch(f){case"M":u=[c[0],c[1]],a=[c[0],c[1]];break;case"L":o.push(...fr(u[0],u[1],c[0],c[1],n)),u=[c[0],c[1]];break;case"C":{const[p,g,y,v,w,S]=c;o.push(...Rx(p,g,y,v,w,S,u,n)),u=[w,S];break}case"Z":o.push(...fr(u[0],u[1],a[0],a[1],n)),u=[a[0],a[1]]}return{type:"path",ops:o}}function $l(r,n){const s=[];for(const o of r)if(o.length){const a=n.maxRandomnessOffset||0,u=o.length;if(u>2){s.push({op:"move",data:[o[0][0]+Pe(a,n),o[0][1]+Pe(a,n)]});for(let f=1;f<u;f++)s.push({op:"lineTo",data:[o[f][0]+Pe(a,n),o[f][1]+Pe(a,n)]})}}return{type:"fillPath",ops:s}}function os(r,n){return(function(s,o){let a=s.fillStyle||"hachure";if(!$t[a])switch(a){case"zigzag":$t[a]||($t[a]=new Ex(o));break;case"cross-hatch":$t[a]||($t[a]=new Cx(o));break;case"dots":$t[a]||($t[a]=new Ix(o));break;case"dashed":$t[a]||($t[a]=new jx(o));break;case"zigzag-line":$t[a]||($t[a]=new Mx(o));break;default:a="hachure",$t[a]||($t[a]=new Nc(o))}return $t[a]})(n,Ax).fillPolygons(r,n)}function Zf(r){const n=Object.assign({},r);return n.randomizer=void 0,r.seed&&(n.seed=r.seed+1),n}function ch(r){return r.randomizer||(r.randomizer=new Px(r.seed||0)),r.randomizer.next()}function zo(r,n,s,o=1){return s.roughness*o*(ch(s)*(n-r)+r)}function Pe(r,n,s=1){return zo(-r,r,n,s)}function fr(r,n,s,o,a,u=!1){const f=u?a.disableMultiStrokeFill:a.disableMultiStroke,c=rc(r,n,s,o,a,!0,!1);if(f)return c;const p=rc(r,n,s,o,a,!0,!0);return c.concat(p)}function rc(r,n,s,o,a,u,f){const c=Math.pow(r-s,2)+Math.pow(n-o,2),p=Math.sqrt(c);let g=1;g=p<200?1:p>500?.4:-.0016668*p+1.233334;let y=a.maxRandomnessOffset||0;y*y*100>c&&(y=p/10);const v=y/2,w=.2+.2*ch(a);let S=a.bowing*a.maxRandomnessOffset*(o-n)/200,k=a.bowing*a.maxRandomnessOffset*(r-s)/200;S=Pe(S,a,g),k=Pe(k,a,g);const E=[],C=()=>Pe(v,a,g),I=()=>Pe(y,a,g),b=a.preserveVertices;return f?E.push({op:"move",data:[r+(b?0:C()),n+(b?0:C())]}):E.push({op:"move",data:[r+(b?0:Pe(y,a,g)),n+(b?0:Pe(y,a,g))]}),f?E.push({op:"bcurveTo",data:[S+r+(s-r)*w+C(),k+n+(o-n)*w+C(),S+r+2*(s-r)*w+C(),k+n+2*(o-n)*w+C(),s+(b?0:C()),o+(b?0:C())]}):E.push({op:"bcurveTo",data:[S+r+(s-r)*w+I(),k+n+(o-n)*w+I(),S+r+2*(s-r)*w+I(),k+n+2*(o-n)*w+I(),s+(b?0:I()),o+(b?0:I())]}),E}function Eo(r,n,s){if(!r.length)return[];const o=[];o.push([r[0][0]+Pe(n,s),r[0][1]+Pe(n,s)]),o.push([r[0][0]+Pe(n,s),r[0][1]+Pe(n,s)]);for(let a=1;a<r.length;a++)o.push([r[a][0]+Pe(n,s),r[a][1]+Pe(n,s)]),a===r.length-1&&o.push([r[a][0]+Pe(n,s),r[a][1]+Pe(n,s)]);return Oo(o,null,s)}function Oo(r,n,s){const o=r.length,a=[];if(o>3){const u=[],f=1-s.curveTightness;a.push({op:"move",data:[r[1][0],r[1][1]]});for(let c=1;c+2<o;c++){const p=r[c];u[0]=[p[0],p[1]],u[1]=[p[0]+(f*r[c+1][0]-f*r[c-1][0])/6,p[1]+(f*r[c+1][1]-f*r[c-1][1])/6],u[2]=[r[c+1][0]+(f*r[c][0]-f*r[c+2][0])/6,r[c+1][1]+(f*r[c][1]-f*r[c+2][1])/6],u[3]=[r[c+1][0],r[c+1][1]],a.push({op:"bcurveTo",data:[u[1][0],u[1][1],u[2][0],u[2][1],u[3][0],u[3][1]]})}}else o===3?(a.push({op:"move",data:[r[1][0],r[1][1]]}),a.push({op:"bcurveTo",data:[r[1][0],r[1][1],r[2][0],r[2][1],r[2][0],r[2][1]]})):o===2&&a.push(...rc(r[0][0],r[0][1],r[1][0],r[1][1],s,!0,!0));return a}function Jf(r,n,s,o,a,u,f,c){const p=[],g=[];if(c.roughness===0){r/=4,g.push([n+o*Math.cos(-r),s+a*Math.sin(-r)]);for(let y=0;y<=2*Math.PI;y+=r){const v=[n+o*Math.cos(y),s+a*Math.sin(y)];p.push(v),g.push(v)}g.push([n+o*Math.cos(0),s+a*Math.sin(0)]),g.push([n+o*Math.cos(r),s+a*Math.sin(r)])}else{const y=Pe(.5,c)-Math.PI/2;g.push([Pe(u,c)+n+.9*o*Math.cos(y-r),Pe(u,c)+s+.9*a*Math.sin(y-r)]);const v=2*Math.PI+y-.01;for(let w=y;w<v;w+=r){const S=[Pe(u,c)+n+o*Math.cos(w),Pe(u,c)+s+a*Math.sin(w)];p.push(S),g.push(S)}g.push([Pe(u,c)+n+o*Math.cos(y+2*Math.PI+.5*f),Pe(u,c)+s+a*Math.sin(y+2*Math.PI+.5*f)]),g.push([Pe(u,c)+n+.98*o*Math.cos(y+f),Pe(u,c)+s+.98*a*Math.sin(y+f)]),g.push([Pe(u,c)+n+.9*o*Math.cos(y+.5*f),Pe(u,c)+s+.9*a*Math.sin(y+.5*f)])}return[g,p]}function ep(r,n,s,o,a,u,f,c,p){const g=u+Pe(.1,p),y=[];y.push([Pe(c,p)+n+.9*o*Math.cos(g-r),Pe(c,p)+s+.9*a*Math.sin(g-r)]);for(let v=g;v<=f;v+=r)y.push([Pe(c,p)+n+o*Math.cos(v),Pe(c,p)+s+a*Math.sin(v)]);return y.push([n+o*Math.cos(f),s+a*Math.sin(f)]),y.push([n+o*Math.cos(f),s+a*Math.sin(f)]),Oo(y,null,p)}function Rx(r,n,s,o,a,u,f,c){const p=[],g=[c.maxRandomnessOffset||1,(c.maxRandomnessOffset||1)+.3];let y=[0,0];const v=c.disableMultiStroke?1:2,w=c.preserveVertices;for(let S=0;S<v;S++)S===0?p.push({op:"move",data:[f[0],f[1]]}):p.push({op:"move",data:[f[0]+(w?0:Pe(g[0],c)),f[1]+(w?0:Pe(g[0],c))]}),y=w?[a,u]:[a+Pe(g[S],c),u+Pe(g[S],c)],p.push({op:"bcurveTo",data:[r+Pe(g[S],c),n+Pe(g[S],c),s+Pe(g[S],c),o+Pe(g[S],c),y[0],y[1]]});return p}function Js(r){return[...r]}function tp(r,n=0){const s=r.length;if(s<3)throw new Error("A curve must have at least three points.");const o=[];if(s===3)o.push(Js(r[0]),Js(r[1]),Js(r[2]),Js(r[2]));else{const a=[];a.push(r[0],r[0]);for(let c=1;c<r.length;c++)a.push(r[c]),c===r.length-1&&a.push(r[c]);const u=[],f=1-n;o.push(Js(a[0]));for(let c=1;c+2<a.length;c++){const p=a[c];u[0]=[p[0],p[1]],u[1]=[p[0]+(f*a[c+1][0]-f*a[c-1][0])/6,p[1]+(f*a[c+1][1]-f*a[c-1][1])/6],u[2]=[a[c+1][0]+(f*a[c][0]-f*a[c+2][0])/6,a[c+1][1]+(f*a[c][1]-f*a[c+2][1])/6],u[3]=[a[c+1][0],a[c+1][1]],o.push(u[1],u[2],u[3])}}return o}function Lo(r,n){return Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2)}function zx(r,n,s){const o=Lo(n,s);if(o===0)return Lo(r,n);let a=((r[0]-n[0])*(s[0]-n[0])+(r[1]-n[1])*(s[1]-n[1]))/o;return a=Math.max(0,Math.min(1,a)),Lo(r,Mr(n,s,a))}function Mr(r,n,s){return[r[0]+(n[0]-r[0])*s,r[1]+(n[1]-r[1])*s]}function sc(r,n,s,o){const a=o||[];if((function(c,p){const g=c[p+0],y=c[p+1],v=c[p+2],w=c[p+3];let S=3*y[0]-2*g[0]-w[0];S*=S;let k=3*y[1]-2*g[1]-w[1];k*=k;let E=3*v[0]-2*w[0]-g[0];E*=E;let C=3*v[1]-2*w[1]-g[1];return C*=C,S<E&&(S=E),k<C&&(k=C),S+k})(r,n)<s){const c=r[n+0];a.length?(u=a[a.length-1],f=c,Math.sqrt(Lo(u,f))>1&&a.push(c)):a.push(c),a.push(r[n+3])}else{const p=r[n+0],g=r[n+1],y=r[n+2],v=r[n+3],w=Mr(p,g,.5),S=Mr(g,y,.5),k=Mr(y,v,.5),E=Mr(w,S,.5),C=Mr(S,k,.5),I=Mr(E,C,.5);sc([p,w,E,I],0,s,a),sc([I,C,k,v],0,s,a)}var u,f;return a}function Ox(r,n){return Fo(r,0,r.length,n)}function Fo(r,n,s,o,a){const u=a||[],f=r[n],c=r[s-1];let p=0,g=1;for(let y=n+1;y<s-1;++y){const v=zx(r[y],f,c);v>p&&(p=v,g=y)}return Math.sqrt(p)>o?(Fo(r,n,g+1,o,u),Fo(r,g,s,o,u)):(u.length||u.push(f),u.push(c)),u}function Bl(r,n=.15,s){const o=[],a=(r.length-1)/3;for(let u=0;u<a;u++)sc(r,3*u,n,o);return s&&s>0?Fo(o,0,o.length,s):o}const Kt="none";class Do{constructor(n){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=n||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(n){return n?Object.assign({},this.defaultOptions,n):this.defaultOptions}_d(n,s,o){return{shape:n,sets:s||[],options:o||this.defaultOptions}}line(n,s,o,a,u){const f=this._o(u);return this._d("line",[ah(n,s,o,a,f)],f)}rectangle(n,s,o,a,u){const f=this._o(u),c=[],p=Lx(n,s,o,a,f);if(f.fill){const g=[[n,s],[n+o,s],[n+o,s+a],[n,s+a]];f.fillStyle==="solid"?c.push($l([g],f)):c.push(os([g],f))}return f.stroke!==Kt&&c.push(p),this._d("rectangle",c,f)}ellipse(n,s,o,a,u){const f=this._o(u),c=[],p=lh(o,a,f),g=nc(n,s,f,p);if(f.fill)if(f.fillStyle==="solid"){const y=nc(n,s,f,p).opset;y.type="fillPath",c.push(y)}else c.push(os([g.estimatedPoints],f));return f.stroke!==Kt&&c.push(g.opset),this._d("ellipse",c,f)}circle(n,s,o,a){const u=this.ellipse(n,s,o,o,a);return u.shape="circle",u}linearPath(n,s){const o=this._o(s);return this._d("linearPath",[Ao(n,!1,o)],o)}arc(n,s,o,a,u,f,c=!1,p){const g=this._o(p),y=[],v=Qf(n,s,o,a,u,f,c,!0,g);if(c&&g.fill)if(g.fillStyle==="solid"){const w=Object.assign({},g);w.disableMultiStroke=!0;const S=Qf(n,s,o,a,u,f,!0,!1,w);S.type="fillPath",y.push(S)}else y.push((function(w,S,k,E,C,I,b){const M=w,D=S;let L=Math.abs(k/2),F=Math.abs(E/2);L+=Pe(.01*L,b),F+=Pe(.01*F,b);let H=C,q=I;for(;H<0;)H+=2*Math.PI,q+=2*Math.PI;q-H>2*Math.PI&&(H=0,q=2*Math.PI);const te=(q-H)/b.curveStepCount,K=[];for(let z=H;z<=q;z+=te)K.push([M+L*Math.cos(z),D+F*Math.sin(z)]);return K.push([M+L*Math.cos(q),D+F*Math.sin(q)]),K.push([M,D]),os([K],b)})(n,s,o,a,u,f,g));return g.stroke!==Kt&&y.push(v),this._d("arc",y,g)}curve(n,s){const o=this._o(s),a=[],u=Xf(n,o);if(o.fill&&o.fill!==Kt)if(o.fillStyle==="solid"){const f=Xf(n,Object.assign(Object.assign({},o),{disableMultiStroke:!0,roughness:o.roughness?o.roughness+o.fillShapeRoughnessGain:0}));a.push({type:"fillPath",ops:this._mergedShape(f.ops)})}else{const f=[],c=n;if(c.length){const p=typeof c[0][0]=="number"?[c]:c;for(const g of p)g.length<3?f.push(...g):g.length===3?f.push(...Bl(tp([g[0],g[0],g[1],g[2]]),10,(1+o.roughness)/2)):f.push(...Bl(tp(g),10,(1+o.roughness)/2))}f.length&&a.push(os([f],o))}return o.stroke!==Kt&&a.push(u),this._d("curve",a,o)}polygon(n,s){const o=this._o(s),a=[],u=Ao(n,!0,o);return o.fill&&(o.fillStyle==="solid"?a.push($l([n],o)):a.push(os([n],o))),o.stroke!==Kt&&a.push(u),this._d("polygon",a,o)}path(n,s){const o=this._o(s),a=[];if(!n)return this._d("path",a,o);n=(n||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const u=o.fill&&o.fill!=="transparent"&&o.fill!==Kt,f=o.stroke!==Kt,c=!!(o.simplification&&o.simplification<1),p=(function(y,v,w){const S=ih(sh(_c(y))),k=[];let E=[],C=[0,0],I=[];const b=()=>{I.length>=4&&E.push(...Bl(I,v)),I=[]},M=()=>{b(),E.length&&(k.push(E),E=[])};for(const{key:L,data:F}of S)switch(L){case"M":M(),C=[F[0],F[1]],E.push(C);break;case"L":b(),E.push([F[0],F[1]]);break;case"C":if(!I.length){const H=E.length?E[E.length-1]:C;I.push([H[0],H[1]])}I.push([F[0],F[1]]),I.push([F[2],F[3]]),I.push([F[4],F[5]]);break;case"Z":b(),E.push([C[0],C[1]])}if(M(),!w)return k;const D=[];for(const L of k){const F=Ox(L,w);F.length&&D.push(F)}return D})(n,1,c?4-4*(o.simplification||1):(1+o.roughness)/2),g=qf(n,o);if(u)if(o.fillStyle==="solid")if(p.length===1){const y=qf(n,Object.assign(Object.assign({},o),{disableMultiStroke:!0,roughness:o.roughness?o.roughness+o.fillShapeRoughnessGain:0}));a.push({type:"fillPath",ops:this._mergedShape(y.ops)})}else a.push($l(p,o));else a.push(os(p,o));return f&&(c?p.forEach((y=>{a.push(Ao(y,!1,o))})):a.push(g)),this._d("path",a,o)}opsToPath(n,s){let o="";for(const a of n.ops){const u=typeof s=="number"&&s>=0?a.data.map((f=>+f.toFixed(s))):a.data;switch(a.op){case"move":o+=`M${u[0]} ${u[1]} `;break;case"bcurveTo":o+=`C${u[0]} ${u[1]}, ${u[2]} ${u[3]}, ${u[4]} ${u[5]} `;break;case"lineTo":o+=`L${u[0]} ${u[1]} `}}return o.trim()}toPaths(n){const s=n.sets||[],o=n.options||this.defaultOptions,a=[];for(const u of s){let f=null;switch(u.type){case"path":f={d:this.opsToPath(u),stroke:o.stroke,strokeWidth:o.strokeWidth,fill:Kt};break;case"fillPath":f={d:this.opsToPath(u),stroke:Kt,strokeWidth:0,fill:o.fill||Kt};break;case"fillSketch":f=this.fillSketch(u,o)}f&&a.push(f)}return a}fillSketch(n,s){let o=s.fillWeight;return o<0&&(o=s.strokeWidth/2),{d:this.opsToPath(n),stroke:s.fill||Kt,strokeWidth:o,fill:Kt}}_mergedShape(n){return n.filter(((s,o)=>o===0||s.op!=="move"))}}class Fx{constructor(n,s){this.canvas=n,this.ctx=this.canvas.getContext("2d"),this.gen=new Do(s)}draw(n){const s=n.sets||[],o=n.options||this.getDefaultOptions(),a=this.ctx,u=n.options.fixedDecimalPlaceDigits;for(const f of s)switch(f.type){case"path":a.save(),a.strokeStyle=o.stroke==="none"?"transparent":o.stroke,a.lineWidth=o.strokeWidth,o.strokeLineDash&&a.setLineDash(o.strokeLineDash),o.strokeLineDashOffset&&(a.lineDashOffset=o.strokeLineDashOffset),this._drawToContext(a,f,u),a.restore();break;case"fillPath":{a.save(),a.fillStyle=o.fill||"";const c=n.shape==="curve"||n.shape==="polygon"||n.shape==="path"?"evenodd":"nonzero";this._drawToContext(a,f,u,c),a.restore();break}case"fillSketch":this.fillSketch(a,f,o)}}fillSketch(n,s,o){let a=o.fillWeight;a<0&&(a=o.strokeWidth/2),n.save(),o.fillLineDash&&n.setLineDash(o.fillLineDash),o.fillLineDashOffset&&(n.lineDashOffset=o.fillLineDashOffset),n.strokeStyle=o.fill||"",n.lineWidth=a,this._drawToContext(n,s,o.fixedDecimalPlaceDigits),n.restore()}_drawToContext(n,s,o,a="nonzero"){n.beginPath();for(const u of s.ops){const f=typeof o=="number"&&o>=0?u.data.map((c=>+c.toFixed(o))):u.data;switch(u.op){case"move":n.moveTo(f[0],f[1]);break;case"bcurveTo":n.bezierCurveTo(f[0],f[1],f[2],f[3],f[4],f[5]);break;case"lineTo":n.lineTo(f[0],f[1])}}s.type==="fillPath"?n.fill(a):n.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(n,s,o,a,u){const f=this.gen.line(n,s,o,a,u);return this.draw(f),f}rectangle(n,s,o,a,u){const f=this.gen.rectangle(n,s,o,a,u);return this.draw(f),f}ellipse(n,s,o,a,u){const f=this.gen.ellipse(n,s,o,a,u);return this.draw(f),f}circle(n,s,o,a){const u=this.gen.circle(n,s,o,a);return this.draw(u),u}linearPath(n,s){const o=this.gen.linearPath(n,s);return this.draw(o),o}polygon(n,s){const o=this.gen.polygon(n,s);return this.draw(o),o}arc(n,s,o,a,u,f,c=!1,p){const g=this.gen.arc(n,s,o,a,u,f,c,p);return this.draw(g),g}curve(n,s){const o=this.gen.curve(n,s);return this.draw(o),o}path(n,s){const o=this.gen.path(n,s);return this.draw(o),o}}const Co="http://www.w3.org/2000/svg";class Dx{constructor(n,s){this.svg=n,this.gen=new Do(s)}draw(n){const s=n.sets||[],o=n.options||this.getDefaultOptions(),a=this.svg.ownerDocument||window.document,u=a.createElementNS(Co,"g"),f=n.options.fixedDecimalPlaceDigits;for(const c of s){let p=null;switch(c.type){case"path":p=a.createElementNS(Co,"path"),p.setAttribute("d",this.opsToPath(c,f)),p.setAttribute("stroke",o.stroke),p.setAttribute("stroke-width",o.strokeWidth+""),p.setAttribute("fill","none"),o.strokeLineDash&&p.setAttribute("stroke-dasharray",o.strokeLineDash.join(" ").trim()),o.strokeLineDashOffset&&p.setAttribute("stroke-dashoffset",`${o.strokeLineDashOffset}`);break;case"fillPath":p=a.createElementNS(Co,"path"),p.setAttribute("d",this.opsToPath(c,f)),p.setAttribute("stroke","none"),p.setAttribute("stroke-width","0"),p.setAttribute("fill",o.fill||""),n.shape!=="curve"&&n.shape!=="polygon"||p.setAttribute("fill-rule","evenodd");break;case"fillSketch":p=this.fillSketch(a,c,o)}p&&u.appendChild(p)}return u}fillSketch(n,s,o){let a=o.fillWeight;a<0&&(a=o.strokeWidth/2);const u=n.createElementNS(Co,"path");return u.setAttribute("d",this.opsToPath(s,o.fixedDecimalPlaceDigits)),u.setAttribute("stroke",o.fill||""),u.setAttribute("stroke-width",a+""),u.setAttribute("fill","none"),o.fillLineDash&&u.setAttribute("stroke-dasharray",o.fillLineDash.join(" ").trim()),o.fillLineDashOffset&&u.setAttribute("stroke-dashoffset",`${o.fillLineDashOffset}`),u}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(n,s){return this.gen.opsToPath(n,s)}line(n,s,o,a,u){const f=this.gen.line(n,s,o,a,u);return this.draw(f)}rectangle(n,s,o,a,u){const f=this.gen.rectangle(n,s,o,a,u);return this.draw(f)}ellipse(n,s,o,a,u){const f=this.gen.ellipse(n,s,o,a,u);return this.draw(f)}circle(n,s,o,a){const u=this.gen.circle(n,s,o,a);return this.draw(u)}linearPath(n,s){const o=this.gen.linearPath(n,s);return this.draw(o)}polygon(n,s){const o=this.gen.polygon(n,s);return this.draw(o)}arc(n,s,o,a,u,f,c=!1,p){const g=this.gen.arc(n,s,o,a,u,f,c,p);return this.draw(g)}curve(n,s){const o=this.gen.curve(n,s);return this.draw(o)}path(n,s){const o=this.gen.path(n,s);return this.draw(o)}}var Go={canvas:(r,n)=>new Fx(r,n),svg:(r,n)=>new Dx(r,n),generator:r=>new Do(r),newSeed:()=>Do.newSeed()};const $x=({children:r})=>{const n=Ge.useRef(null),s=Ge.useRef(!1),[o,a]=Ge.useState(null),[u,f]=Ge.useState(30),[c,p]=Ge.useState(1);Ge.useEffect(()=>{const b=()=>{const M=n.current;if(!M)return;const D=M.clientHeight,L=M.clientWidth;if(!D||!L)return;const F=14,q=F*1.9,te=16,K=4,z=Math.floor((D-te)/q),W=Math.floor((L-K)/F);z>0&&a(z),W>0&&f(W)};return b(),window.addEventListener("resize",b),()=>{window.removeEventListener("resize",b)}},[]);const g=Ge.useMemo(()=>{const b=u,D=typeof o=="number"&&o>0?o:10,F=Ge.Children.toArray(r).map(z=>typeof z=="string"||typeof z=="number"?String(z):Ge.isValidElement(z)&&z.type==="br"?`
`:"").join("").replace(/\r\n/g,`
`),H=[];let q="",te=0;for(const z of F){if(z===`
`){H.push(q),q="",te=0;continue}q+=z,te+=1,te>=b&&(H.push(q),q="",te=0)}(q||H.length===0)&&H.push(q);const K=[];for(let z=0;z<H.length;z+=D)K.push(H.slice(z,z+D));return K.length>0?K:[[""]]},[r,o]),y=g.length;Ge.useEffect(()=>{s.current=!1},[r]),Ge.useEffect(()=>{p(b=>s.current?Math.min(b,y):y)},[y]);const v=c>1,w=c<y,S=()=>{v&&(s.current=!0,p(b=>Math.max(1,b-1)))},k=()=>{w&&(s.current=!0,p(b=>Math.min(y,b+1)))},E=c>=1&&c<=y?c:y,I=(g[E-1]??[]).join(`
`);return h.jsx("div",{className:"flex h-full items-center justify-center",children:h.jsx("div",{className:"diary-notebook",children:h.jsxs("div",{className:"diary-stack",children:[h.jsx("div",{className:"diary-page-layer diary-page-layer--back"}),h.jsx("div",{className:"diary-page-layer diary-page-layer--mid"}),h.jsx("div",{className:"diary-page",children:h.jsxs("div",{className:"diary-page-inner",children:[h.jsxs("div",{className:"diary-icon-windchime",children:[h.jsx("div",{className:"diary-wc-top"}),h.jsx("div",{className:"diary-wc-string"}),h.jsx("div",{className:"diary-wc-tag"})]}),h.jsxs("div",{className:"diary-icon-icepop",children:[h.jsx("div",{className:"diary-ice-body"}),h.jsx("div",{className:"diary-ice-stick"})]}),h.jsx("div",{className:"diary-writing-area",ref:n,children:h.jsx("div",{className:"diary-text",children:I})}),h.jsxs("div",{className:"diary-pagination",children:[h.jsx("button",{type:"button",className:"diary-page-arrow",onClick:S,disabled:!v,"aria-label":"",children:h.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:h.jsx("path",{d:"M15 18l-6-6 6-6"})})}),h.jsxs("div",{className:"diary-page-indicator",children:[c,"/",y," "]}),h.jsx("button",{type:"button",className:"diary-page-arrow",onClick:k,disabled:!w,"aria-label":"",children:h.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:h.jsx("path",{d:"M9 18l6-6-6-6"})})})]}),h.jsx("div",{className:"diary-icon-crab",children:h.jsx("div",{className:"diary-crab-body"})}),h.jsxs("div",{className:"diary-icon-fishes",children:[h.jsx("span",{className:"diary-fish"}),h.jsx("span",{className:"diary-fish diary-fish-sm"}),h.jsx("span",{className:"diary-fish diary-fish-xs"})]})]})})]})})})},ei=5,Ul=5,Bx=10,Ux=r=>{const n=[],s=a=>{if(typeof a=="string"||typeof a=="number"){n.push(String(a));return}if(Ge.isValidElement(a)){if(a.type==="br"){n.push(`
`);return}a.props&&a.props.children&&Ge.Children.forEach(a.props.children,s)}};return Ge.Children.forEach(r,s),n.join("").replace(/\r\n/g,`
`)},Hx=(r,n)=>{if(!r)return[{text:""}];const o=r.replace(/\r\n/g,`
`).split(`
`),a=[],u=g=>{const y=g.replace(/\s+/g," ");if(!y.trim()){a.push("");return}let v="";for(let w=0;w<y.length;w+=1){const S=y[w],k=v+S;k.length<=Bx?v=k:(a.push(v.trim()),v=S)}v.trim()&&a.push(v.trim())};if(o.forEach(u),!a.length)return[{text:""}];const f=[];let c=0;for(;c<a.length&&f.length<n;){const g=a.slice(c,c+Ul);f.push({text:g.join(`
`),isOverflowLast:!1}),c+=Ul}if(c<a.length&&f.length>0){const g=f.length-1,v=f[g].text.split(`
`),w=Math.max(0,Ul-1),S=v.slice(0,w);f[g]={text:S.join(`
`),isOverflowLast:!0}}return f},Wx=(r,n)=>{const s=r.split(`
`),o=s.length===1&&s[0]?.trim().length===0&&n?[]:s,a=[];return o.forEach((u,f)=>{a.push(h.jsxs("span",{children:[u,h.jsx("br",{})]},f))}),n&&a.push(h.jsx("span",{className:"text-red-500",children:"(...)"},"overflow")),a},uh=({title:r,children:n,customContent:s,customPages:o,color:a="sakura",className:u,size:f})=>{const c=Array.isArray(o)&&o.length>0,p=!c&&s!==void 0,g=Ge.useMemo(()=>c||p?"":Ux(n),[n,p,c]),y=Ge.useMemo(()=>c?o.map(te=>({text:"",node:te,isOverflowLast:!1})):p?[{text:"",node:s,isOverflowLast:!1}]:Hx(g,ei).map(te=>({...te,node:void 0})),[s,o,g,p,c]),v=y.length,[w,S]=Ge.useState(0),[k,E]=Ge.useState(!1);Ge.useEffect(()=>{S(0),E(!1)},[s,o,g,p,c]);const C=["sticky-note-root inline-block",`sticky-note--${a}`,u].filter(Boolean).join(" "),I=f?{width:f,height:f}:void 0,b=ei-1-w,D=b+1===1,L=w>=v-1,F=!D&&!L,H=()=>{k||!F||E(!0)},q=te=>{te.animationName==="sticky-note-tear"&&(E(!1),S(K=>Math.min(K+1,ei-1,v-1)))};return h.jsx("div",{className:C,children:h.jsxs("div",{className:"sticky-note-container",style:I,children:[h.jsx("div",{className:"sticky-note-layer sticky-note-layer--back"}),h.jsx("div",{className:"sticky-note-layer sticky-note-layer--mid"}),h.jsx("div",{className:"sticky-note-paper",children:Array.from({length:ei},(te,K)=>{if(K>b)return null;const z=K===b,W=z&&F,ae=b-K,ee=ae===1,he=!z&&k?Math.max(0,ae-1):ae,Z=`sticky-note-sheet--depth-${Math.min(he,ei-1)}`,ce=w+ae,O=ce>=0&&ce<v?y[ce]:void 0,V=O?.text??"",Y=!!O?.isOverflowLast,P=O?.node,_=["sticky-note-sheet",Z,z&&!k&&F?"sticky-note-sheet--top-idle":"",z&&k?"sticky-note-sheet--tearing":"",z&&!F?"sticky-note-sheet--top-final":"",ee&&k&&F?"sticky-note-sheet--next-reveal":""].filter(Boolean).join(" ");return h.jsxs("div",{className:_,onClick:W?H:void 0,onAnimationEnd:z?q:void 0,children:[h.jsxs("div",{className:"sticky-note-inner paper-noise px-6 pt-8 pb-5",children:[r?h.jsx("div",{className:"sticky-note-title mb-2 text-base font-semibold tracking-[0.08em] text-slate-700",children:r}):null,h.jsx("div",{className:"sticky-note-content text-sm leading-relaxed text-slate-700/90",children:P??Wx(V,Y)})]}),h.jsx("div",{className:"sticky-note-curl"})]},K)})})]})})},Vx=({size:r,amount:n})=>{const s=N.useRef(null),o=N.useRef(null);return N.useLayoutEffect(()=>{const a=s.current,u=o.current;if(!a||!u)return;const f=()=>{if(!a||!u)return;const c=a.querySelectorAll(".sticky-note-content span");if(!c.length)return;const p=Array.from(c),g=p.find(b=>b.textContent?.includes("E))??p[p.length-1]??p[0],y=a.getBoundingClientRect(),v=g.getBoundingClientRect();if(!y.width||!y.height)return;const w=v.width+24,S=v.height+12,k=v.left-y.left+v.width/2,E=v.top-y.top+v.height/2;for(;u.firstChild;)u.removeChild(u.firstChild);u.setAttribute("viewBox",`0 0 ${y.width} ${y.height}`),u.setAttribute("preserveAspectRatio","xMidYMid meet");const I=Go.svg(u).ellipse(k,E,w,S,{stroke:"#f8bbd9",strokeWidth:2,roughness:1.2});u.appendChild(I)};return f(),window.addEventListener("resize",f),()=>{window.removeEventListener("resize",f)}},[r]),h.jsxs("div",{className:"save-panel-income-note",ref:s,children:[h.jsxs(uh,{title:"",color:"mist",size:r,children:["E,`
`,n," E]}),h.jsx("svg",{ref:o,className:"save-panel-income-note-svg","aria-hidden":"true"})]})};function Gx(){const r=Wo(),n=pt("logPanel"),s=pt("topFlagState"),o=N.useRef(null),[a,u]=N.useState(void 0);N.useLayoutEffect(()=>{const c=o.current;if(!c)return;const p=24,g=()=>{if(typeof window>"u")return;if(window.innerWidth<768){u(void 0);return}const v=c.clientHeight,w=c.clientWidth;if(!v||!w)return;const S=48,k=28,E=Math.max(0,v-p-S),C=Math.max(0,w-k),I=E/2,b=Math.max(0,Math.min(C,I));u(b||void 0)},y=new ResizeObserver(g);return y.observe(c),g(),()=>{y.disconnect()}},[]);const f=N.useMemo(()=>{const c=dr(s.currentTime)??Date.now(),g=(n.todoList??[]).map(Yx).filter(H=>!!H).filter(H=>!Qp(dh(H),c));if(g.length===0)return[h.jsx("div",{className:"text-slate-500",children:"EEEE},"empty")];const y=g.map(H=>Kx(H,c)),v=[],w=85,S=20,k=16,E=14,C=10,b=Math.max(100,(a||260)-w);let M=[],D=0;const L=()=>{M.length&&v.push(h.jsx("div",{className:"flex flex-col gap-2 pb-1",children:M.map((H,q)=>h.jsxs("div",{className:["flex flex-col rounded-sm px-2 py-1",H.showRed?"text-red-500 bg-red-50/70":"text-slate-700/90"].join(" "),children:[h.jsx("span",{className:"font-semibold leading-tight break-words",children:H.title}),H.label?h.jsx("span",{className:"text-xs leading-snug opacity-80 break-words",children:H.label}):null]},`${H.key}-${q}`))},`page-${v.length}`))},F=(H,q)=>Math.max(1,Math.ceil(H.length/C))*S+(q?k:0)+E;return y.forEach(H=>{const q=F(H.title,H.label);M.length>0&&D+q>b&&(L(),M=[],D=0),M.push(H),D+=q}),L(),v},[n.todoList,s.currentTime,a]);return h.jsx("div",{className:"top-panel__content paper-noise",children:h.jsxs("div",{className:`save-panel-layout ${r?"!flex-col !h-auto":""}`,children:[h.jsx("div",{className:`save-panel-main ${r?"!flex-none w-full !h-[500px]":""}`,children:h.jsx($x,{children:n.diaryText})}),h.jsxs("div",{className:`save-panel-notes ${r?"!flex-col !w-full !max-w-none !gap-6 !px-4 pb-8 !items-center":""}`,ref:o,children:[h.jsx(uh,{title:"E",color:"sakura",size:a,customPages:f}),h.jsx(Vx,{size:a,amount:n.amount})]})]})})}function Yx(r){if(!r)return;if(typeof r=="string"){const s=r.trim();return s?{title:s}:void 0}if(typeof r.title!="string")return;const n=r.title.trim();if(n)return{...r,title:n}}function dh(r){return Number.isFinite(r.expiresAtMs)?r.expiresAtMs:dr(r.expiresAt)}function Kx(r,n){const s=dh(r),o=Vy(s,n),a=s!==void 0&&n>s,f=typeof o=="number"&&o>=0&&o<=1||a,c=a&&!Qp(s,n)?"E:Gy(s,n,{suffix:"E});return{title:r.title,label:c,showRed:f,key:`${r.title}-${s??n}`}}const Xx=871,Qx=472,np=[{id:"seaside",name:"",icon:"E,color:"#b7d3c6",highlightColor:"#cde3d6",seed:11,label:[140,280],points:[[190,160],[200,240],[210,300],[190,360],[160,410],[110,400],[70,370],[50,320],[60,250],[100,180],[140,150]]},{id:"central_district",name:"E",icon:"E,color:"#f7d794",highlightColor:"#fbe4ae",seed:12,label:[360,260],points:[[190,160],[280,140],[360,150],[460,160],[490,220],[480,300],[400,320],[300,310],[210,300],[200,240]]},{id:"residential_area",name:"E",icon:"EE,color:"#f8c9a9",highlightColor:"#fbd8bd",seed:13,label:[340,360],points:[[210,300],[300,310],[400,320],[480,300],[500,350],[480,400],[400,420],[300,410],[220,400],[160,410],[190,360]]},{id:"rich_district",name:"",icon:"",color:"#d7bde2",highlightColor:"#e8daef",seed:17,label:[370,110],points:[[280,140],[320,90],[390,80],[460,90],[500,130],[460,160],[360,150]]},{id:"elite_academy",name:"",icon:"",color:"#a9cce3",highlightColor:"#d4e6f1",seed:18,label:[390,50],points:[[320,90],[340,40],[390,20],[440,40],[460,90],[390,80]]},{id:"commercial_district",name:"E",icon:"EE,color:"#f5a26f",highlightColor:"#f7b68d",seed:14,label:[570,240],points:[[460,160],[500,130],[590,140],[660,170],[660,240],[630,290],[550,310],[500,350],[480,300],[490,220]]},{id:"entertainment_district",name:"E,icon:"",color:"#f4a6a6",highlightColor:"#f7bcbc",seed:15,label:[720,220],points:[[660,170],[740,180],[780,220],[760,280],[700,300],[660,280],[660,240]]},{id:"slums",name:"",icon:"EE,color:"#7f8c8d",highlightColor:"#95a5a6",seed:16,label:[750,340],points:[[700,300],[760,280],[800,320],[780,380],[720,390],[680,350]]}];function rp({count:r,seed:n}){const s=N.useRef(null);return N.useLayoutEffect(()=>{const o=s.current;if(!o)return;const a=80,u=18;for(;o.firstChild;)o.removeChild(o.firstChild);o.setAttribute("width",String(a)),o.setAttribute("height",String(u)),o.setAttribute("viewBox",`0 0 ${a} ${u}`),o.setAttribute("preserveAspectRatio","xMidYMid meet");const f=Go.svg(o),c=Math.max(0,Math.min(5,Math.round(r))),p=5,g=6,y=3.2,v=4,w=g*2,S=p*w+(p-1)*v,k=(a-S)/2+g,E=u/2,C=(I,b,M,D)=>{const L=[],H=Math.PI/5;for(let q=0;q<10;q+=1){const te=q%2===0?M:D,K=q*H-Math.PI/2,z=I+Math.cos(K)*te,W=b+Math.sin(K)*te;L.push([z,W])}return L};for(let I=0;I<p;I+=1){const b=k+I*(w+v),M=C(b,E,g,y),D=I<c,L=f.polygon(M,{stroke:"#f8bbd9",strokeWidth:1.4,roughness:1.8,fill:D?"#f8bbd9":"#ffffff",fillStyle:"solid",seed:n+I});o.appendChild(L)}},[r,n]),h.jsx("svg",{ref:s,className:"society-panel__region-popup-star-svg","aria-hidden":"true"})}function qx({region:r,anchor:n,onClose:s}){const o=N.useRef(null),a=N.useRef(null),[u,f]=N.useState({left:0,top:0});N.useLayoutEffect(()=>{const C=o.current,I=a.current;if(!C||!I)return;const b=C.offsetParent;if(!b)return;const M=()=>{if(!C||!I||!b)return;const L=b.getBoundingClientRect(),F=C.offsetWidth,H=C.offsetHeight;if(!F||!H||!L.width||!L.height)return;for(;I.firstChild;)I.removeChild(I.firstChild);I.setAttribute("width",String(F)),I.setAttribute("height",String(H)),I.setAttribute("viewBox",`0 0 ${F} ${H}`),I.setAttribute("preserveAspectRatio","none");const q=Go.svg(I),te=6,K=Math.max(0,F-te*2),z=Math.max(0,H-te*2),W=q.rectangle(te,te,K,z,{stroke:"#4a4a4a",strokeWidth:2,roughness:1.6,fill:"#fefefe",fillStyle:"solid",seed:r.seed+100});I.appendChild(W);const ae=L.width*n.xPct,ee=L.height*n.yPct,he=12,Z=4,ce=[{placement:"top",left:ae-F/2,top:ee-H-he},{placement:"bottom",left:ae-F/2,top:ee+he},{placement:"right",left:ae+he,top:ee-H/2},{placement:"left",left:ae-F-he,top:ee-H/2}],O=_=>{const B=_.left>=Z&&_.left+F<=L.width-Z,X=_.top>=Z&&_.top+H<=L.height-Z;return B&&X};let V=ce[0];for(let _=0;_<ce.length;_+=1)if(O(ce[_])){V=ce[_];break}const Y=Math.min(Math.max(V.left,Z),Math.max(Z,L.width-F-Z)),P=Math.min(Math.max(V.top,Z),Math.max(Z,L.height-H-Z));f({left:Y,top:P})};M();const D=new ResizeObserver(()=>{M()});return D.observe(C),()=>{D.disconnect()}},[n.xPct,n.yPct,r.seed]);const p=pt("societyPanel").regions[r.id],g=p?.desc??"EE,y=C=>typeof C!="number"||Number.isNaN(C)?0:Math.max(0,Math.min(5,Math.round(C))),v=y(p?.fame),w=y(p?.reputation),k=(p?.gossip??[]).map(C=>C.replace(/["]/g,"")).filter(C=>C.trim().length>0),E=k.length>0?k:["E"];return h.jsxs("div",{ref:o,className:"society-panel__region-popup",style:{left:`${u.left}px`,top:`${u.top}px`},children:[h.jsx("svg",{ref:a,className:"society-panel__region-popup-svg","aria-hidden":"true"}),h.jsxs("div",{className:"society-panel__region-popup-inner paper-noise",children:[h.jsx("div",{className:"society-panel__region-popup-header",children:h.jsxs("div",{className:"society-panel__region-popup-title",children:[h.jsx("span",{className:"society-panel__region-popup-icon",children:r.icon}),h.jsx("span",{className:"society-panel__region-popup-name",children:r.name})]})}),h.jsxs("div",{className:"society-panel__region-popup-section",children:[h.jsx("div",{className:"society-panel__region-popup-label",children:"E}),h.jsx("div",{className:"society-panel__region-popup-text",children:g})]}),h.jsxs("div",{className:"society-panel__region-popup-metrics",children:[h.jsxs("div",{className:"society-panel__region-popup-metric",children:[h.jsx("span",{className:"society-panel__region-popup-label",children:""}),h.jsx("div",{className:"society-panel__region-popup-stars","aria-label":`EE{v} `,children:h.jsx(rp,{count:v,seed:r.seed+200})})]}),h.jsxs("div",{className:"society-panel__region-popup-metric",children:[h.jsx("span",{className:"society-panel__region-popup-label",children:""}),h.jsx("div",{className:"society-panel__region-popup-stars","aria-label":`EE{w} `,children:h.jsx(rp,{count:w,seed:r.seed+250})})]})]}),h.jsxs("div",{className:"society-panel__region-popup-section",children:[h.jsx("div",{className:"society-panel__region-popup-label",children:"E"}),h.jsx("ul",{className:"society-panel__region-popup-comments",children:E.map((C,I)=>h.jsx("li",{className:"society-panel__region-popup-comment",children:C},`${r.id}-comment-${I}`))})]})]})]})}function Zx(){const r=N.useRef(null),n=N.useRef(null),[s,o]=N.useState(null),[a,u]=N.useState(null);N.useEffect(()=>{const c=r.current,p=n.current;if(!c||!p)return;let g=null;const y=(S,k)=>{if(!S||!k)return;g&&(g(),g=null),c.width=S,c.height=k;const E=c.getContext("2d");if(!E)return;const C=Go.canvas(c),I=c.width/Xx,b=c.height/Qx,M=np.map(K=>{const z=new Path2D,W=K.points.map(([ee,he])=>[ee*I,he*b]);z.moveTo(W[0][0],W[0][1]);for(let ee=1;ee<W.length;ee+=1)z.lineTo(W[ee][0],W[ee][1]);z.closePath();const ae=[K.label[0]*I,K.label[1]*b];return{...K,path:z,scaledPoints:W,scaledLabel:ae}});let D=null;const L=()=>{E.fillStyle="#f7ebdc",E.fillRect(0,0,c.width,c.height)},F=()=>{L(),M.forEach(K=>{const z=K.id===D,W={fill:z?K.highlightColor:K.color,fillStyle:"solid",roughness:2.1,stroke:"#4a4a4a",strokeWidth:z?4:3,seed:K.seed,hachureGap:10};C.polygon(K.scaledPoints,W)}),E.textAlign="center",E.textBaseline="middle",M.forEach(K=>{const[z,W]=K.scaledLabel;E.fillStyle="#4a4a4a",E.font="24px 'Segoe UI Symbol', 'Apple Color Emoji', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif",E.fillText(K.icon,z,W-24),E.font="600 18px 'NaikaiFont-SemiBold', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif",E.fillText(K.name,z,W+4)})},H=K=>{const z=c.getBoundingClientRect(),W=K.clientX-z.left,ae=K.clientY-z.top;return{x:W,y:ae}},q=K=>{const{x:z,y:W}=H(K);let ae=null,ee=null;for(let he=M.length-1;he>=0;he-=1){const Z=M[he];if(E.isPointInPath(Z.path,z,W)){ae=Z.id,ee=Z;break}}if(ae!==D&&(D=ae,o(ae),F()),ee&&c.width>0&&c.height>0){const he=z/c.width,Z=W/c.height;u({xPct:Math.min(.95,Math.max(.05,he)),yPct:Math.min(.95,Math.max(.05,Z))})}else ee||u(null)},te=()=>{D=null,o(null),c.style.cursor="default",F(),u(null)};c.addEventListener("mousemove",q),c.addEventListener("mouseleave",te),F(),g=()=>{c.removeEventListener("mousemove",q),c.removeEventListener("mouseleave",te)}},v=p.getBoundingClientRect();y(v.width,v.height);const w=new ResizeObserver(S=>{for(const k of S)if(k.target===p){const{width:E,height:C}=k.contentRect;y(E,C)}});return w.observe(p),()=>{w.disconnect(),g&&g()}},[]);const f=()=>{u(null),o(null)};return h.jsx("div",{className:"top-panel__content paper-noise",children:h.jsx("div",{className:"society-panel",children:h.jsx("div",{className:"society-panel__map-shell",children:h.jsxs("div",{className:"society-panel__map-frame",ref:n,children:[h.jsx("canvas",{ref:r,className:"society-panel__canvas"}),s&&a&&(()=>{const c=np.find(p=>p.id===s)??null;return c?h.jsx(qx,{region:c,anchor:a,onClose:f}):null})()]})})})})}const sp=6,Hl=sp*sp,Ec=r=>{const n=new Map;for(const s of r)s.previousNodeId!==null&&(n.has(s.previousNodeId)||n.set(s.previousNodeId,[]),n.get(s.previousNodeId).push(s.id));return n},Jx=r=>{const n=new Map,s=[];for(const u of r)u.previousNodeId===null&&s.push(u.id);const o=Ec(r),a=[];for(const u of s)a.push({id:u,d:0});for(;a.length;){const{id:u,d:f}=a.shift();n.set(u,f);const c=o.get(u)??[];for(const p of c)a.push({id:p,d:f+1})}return n},ip=(r,n=300,s=300)=>{const o=new Map;if(!r.length)return{pos:o,width:0,height:0};const a=Jx(r),u=Ec(r),f=r.filter(F=>F.previousNodeId===null).map(F=>F.id),c=new Map;let p=0;const g=F=>{const H=(u.get(F)??[]).sort((te,K)=>te-K);if(H.length===0)return c.set(F,p++),c.get(F);H.forEach(g);const q=H.reduce((te,K)=>te+(c.get(K)??0),0)/H.length;return c.set(F,q),q};f.sort((F,H)=>F-H).forEach(g);const y=260,v=140,w=40,S=24,k=Math.max(300,Math.floor(n)),E=Math.max(300,Math.floor(s)),C=240,I=112;let b=0,M=0,D=0,L=0;for(const F of r){const H=c.get(F.id)??0,q=a.get(F.id)??0;b=Math.max(b,H),M=Math.max(M,q);const te=k+w+H*y,K=E+S+q*v;o.set(F.id,{x:te,y:K}),D=Math.max(D,te+C),L=Math.max(L,K+I)}return{pos:o,width:Math.max(k*2+w*2+(b+1)*y,D+k),height:Math.max(E*2+S*2+(M+1)*v,L+E)}},ew=({text:r})=>{const n=N.useRef(null),s=N.useRef(null);return N.useEffect(()=>{const o=n.current,a=s.current;if(!o||!a)return;const u=18,f=10,c=()=>{let g=u;for(a.style.fontSize=`${g}px`;g>f&&!(a.scrollWidth<=o.clientWidth&&a.scrollHeight<=o.clientHeight);)g-=1,a.style.fontSize=`${g}px`};c();const p=new ResizeObserver(()=>c());return p.observe(o),p.observe(a),window.addEventListener("resize",c),()=>{p.disconnect(),window.removeEventListener("resize",c)}},[r]),h.jsx("div",{ref:n,className:"timeline-node__title","aria-label":r,title:r,children:h.jsx("div",{ref:s,className:"timeline-node__title-text",children:r})})};function tw(){const r=pt("basic"),n=pt("timelinePanel"),[s,o]=N.useState({w:0,h:0}),[a,u]=N.useState({x:0,y:0,zoom:1}),f=N.useRef(null),c=N.useRef(null),p=N.useRef(new Map),[g,y]=N.useState({show:!1,nodeId:null,isLocked:!1}),v=600,w=N.useCallback(()=>{const A=f.current;return A||null},[]),S=N.useMemo(()=>new Set(n.lockedNodeIds??[]),[n.lockedNodeIds]);N.useEffect(()=>{let A=null;const ue=()=>{const me=w();if(!me)return;const Q=me.clientWidth,fe=me.clientHeight;o(we=>we.w===Q&&we.h===fe?we:{w:Q,h:fe})};ue();const oe=w();return oe&&typeof ResizeObserver<"u"&&(A=new ResizeObserver(()=>ue()),A.observe(oe)),window.addEventListener("resize",ue),()=>{window.removeEventListener("resize",ue),A&&A.disconnect()}},[w]),N.useEffect(()=>{const A=f.current,ue=c.current;if(!A||!ue)return;const oe=me=>{me.preventDefault();const Q=ue.getBoundingClientRect(),fe=me.clientX-Q.left,we=me.clientY-Q.top,Ce=.4,Re=2.5,Fe=(it,Ze,ze)=>Math.min(ze,Math.max(Ze,it));u(it=>{const{x:Ze,y:ze,zoom:Je}=it;let Ye=me.deltaY;me.deltaMode===1?Ye*=15:me.deltaMode===2&&(Ye*=120);const Mt=Math.exp(-Ye*.001),gt=Je*Mt,ut=Fe(gt,Ce,Re),nt=Math.max(ut,1e-4)/Math.max(Je,1e-4),Ke=Ze+(nt-1)*fe,et=ze+(nt-1)*we;return{x:Ke,y:et,zoom:ut}})};return A.addEventListener("wheel",oe,{passive:!1}),()=>{A.removeEventListener("wheel",oe)}},[]);const k=N.useMemo(()=>{const A=s.w?s.w+200:800,ue=s.h?s.h+200:800;return ip(n.nodes,A,ue)},[n.nodes,s.w,s.h]),E=A=>{if(A==null)return;const oe=ip(n.nodes,s.w?s.w+200:800,s.h?s.h+200:800).pos.get(A),me=w();if(!oe||!me)return;const Q=240,fe=112,we=me.clientWidth,Ce=me.clientHeight,Re=getComputedStyle(me),Fe=parseFloat(Re.paddingLeft||"0")||0,it=parseFloat(Re.paddingTop||"0")||0,Ze=parseFloat(Re.paddingRight||"0")||0,ze=parseFloat(Re.paddingBottom||"0")||0,Je=oe.x+Q/2,Ye=oe.y+fe/2,Mt=Math.max(0,we-Fe-Ze),gt=Math.max(0,Ce-it-ze);u(ut=>{const nt=Math.max(ut.zoom,1e-4),Ke=Mt/2,et=gt/2,Sn=nt*Je-Ke,yt=nt*Ye-et;return{x:Sn,y:yt,zoom:ut.zoom}})},C=r.nodeID;N.useEffect(()=>{if(C==null)return;const A=requestAnimationFrame(()=>E(C));return()=>cancelAnimationFrame(A)},[C,s.w,s.h]);const I=A=>ue=>{ue&&p.current.set(A,ue)},b=A=>{ft.navigateToNode(A)},M=A=>{const ue=Ec(n.nodes),oe=[],me=[A];for(;me.length>0;){const Q=me.shift(),fe=ue.get(Q)||[];oe.push(...fe),me.push(...fe)}return oe},D=A=>S.has(A)?!0:M(A).some(oe=>S.has(oe)),L=A=>{const ue=D(A);y({show:!0,nodeId:A,isLocked:ue})},F=N.useCallback(A=>{ft.deleteNodeAndDescendants(A)},[]),H=N.useCallback(()=>{const A=g.nodeId;y({show:!1,nodeId:null,isLocked:!1}),!g.isLocked&&A!==null&&F(A)},[g.isLocked,g.nodeId,F]),q=N.useCallback(()=>{y({show:!1,nodeId:null,isLocked:!1})},[]),te=N.useMemo(()=>{const A=[];for(const ue of n.nodes)ue.previousNodeId!==null&&A.push({from:ue.previousNodeId,to:ue.id});return A},[n.nodes]),[K,z]=N.useState([]),W=N.useCallback(()=>{const A=[];for(const ue of te){const oe=p.current.get(ue.from),me=p.current.get(ue.to),Q=k.pos.get(ue.from),fe=k.pos.get(ue.to);if(!oe||!me||!Q||!fe)continue;const we=Q.x+(oe.offsetWidth||200)/2,Ce=Q.y+(oe.offsetHeight||100),Re=fe.x+(me.offsetWidth||200)/2,Fe=fe.y;A.push({x1:we,y1:Ce,x2:Re,y2:Fe})}z(A)},[te,k]);N.useEffect(()=>{W();const A=new ResizeObserver(()=>W());return p.current.forEach(ue=>A.observe(ue)),window.addEventListener("resize",W),()=>{A.disconnect(),window.removeEventListener("resize",W)}},[W,n.nodes.length]);const ae=N.useMemo(()=>({width:`${Math.max(k.width,s.w+v)}px`,height:`${Math.max(k.height,s.h+v)}px`,transform:`translate(${-a.x}px, ${-a.y}px) scale(${a.zoom})`,transformOrigin:"0 0"}),[k.width,k.height,s.w,s.h,a.x,a.y,a.zoom]),ee=N.useRef(!1),he=N.useRef(null),Z=N.useRef(!1),ce=N.useRef(new Map),O=N.useRef(null),V=N.useRef(null);N.useEffect(()=>{const A=oe=>{if(oe.code!=="Space")return;const me=oe.target;me&&(me.tagName==="INPUT"||me.tagName==="TEXTAREA"||me.getAttribute("contenteditable")==="true")||(Z.current=!0,f.current&&(f.current.dataset.spacepan="true"),oe.preventDefault())},ue=oe=>{oe.code==="Space"&&(Z.current=!1,f.current&&(f.current.dataset.spacepan="false"))};return window.addEventListener("keydown",A),window.addEventListener("keyup",ue),()=>{window.removeEventListener("keydown",A),window.removeEventListener("keyup",ue)}},[]);const Y=A=>{const ue=A.target,oe=A.currentTarget,Q=ue.closest(".timeline-node")?.dataset.nodeId,fe=Q?Number(Q):null,we=!!ue.closest(".timeline-node__menu-group");if(A.pointerType==="touch"){if(ce.current.set(A.pointerId,{x:A.clientX,y:A.clientY}),ce.current.size>=2){const Fe=Array.from(ce.current.values()),it=Fe[1].x-Fe[0].x,Ze=Fe[1].y-Fe[0].y,ze=Math.hypot(it,Ze);O.current={dist:ze,zoom:a.zoom},ee.current=!1,V.current=null,oe.dataset.panning="false",oe.dataset.pinching="true",oe.setPointerCapture?.(A.pointerId),A.preventDefault();return}if(we){V.current=null;return}const Re=fe!==null&&!Z.current&&!we;if(he.current={x:A.clientX,y:A.clientY,cameraX:a.x,cameraY:a.y},Re){V.current={pointerId:A.pointerId,nodeId:fe,startX:A.clientX,startY:A.clientY},oe.setPointerCapture?.(A.pointerId);return}V.current=null,ee.current=!0,oe.setPointerCapture?.(A.pointerId),oe.dataset.panning="true",A.preventDefault();return}if(A.pointerType==="mouse"&&!(A.button===0||A.button===1))return;if(we){V.current=null;return}const Ce=fe!==null&&!Z.current&&!we&&A.button===0;if(he.current={x:A.clientX,y:A.clientY,cameraX:a.x,cameraY:a.y},Ce){V.current={pointerId:A.pointerId,nodeId:fe,startX:A.clientX,startY:A.clientY},oe.setPointerCapture?.(A.pointerId);return}V.current=null,ee.current=!0,oe.setPointerCapture?.(A.pointerId),oe.dataset.panning="true",A.preventDefault()},P=A=>{const ue=A.currentTarget;if(A.pointerType==="touch"){if(ce.current.has(A.pointerId)&&ce.current.set(A.pointerId,{x:A.clientX,y:A.clientY}),ce.current.size>=2&&O.current){const ze=Array.from(ce.current.values()),Je=ze[1].x-ze[0].x,Ye=ze[1].y-ze[0].y,Mt=Math.hypot(Je,Ye),gt=(ze[0].x+ze[1].x)/2,ut=(ze[0].y+ze[1].y)/2,nt=c.current;if(!nt)return;const Ke=nt.getBoundingClientRect(),et=gt-Ke.left,Sn=ut-Ke.top,yt=.4,pr=2.5,pn=(Me,We,Be)=>Math.min(Be,Math.max(We,Me)),Ht=O.current.zoom,Ee=Math.max(8,O.current.dist),Te=pn(Ht*(Mt/Ee),yt,pr);u(Me=>{const We=Math.max(Te,1e-4)/Math.max(Me.zoom,1e-4),Be=Me.x+(We-1)*et,ot=Me.y+(We-1)*Sn;return{x:Be,y:ot,zoom:Te}}),ue.dataset.pinching="true",A.preventDefault();return}let Ce=he.current;if(!Ce)return;if(!ee.current){const ze=A.clientX-Ce.x,Je=A.clientY-Ce.y;if(ze*ze+Je*Je<Hl||(ee.current=!0,V.current=null,ue.dataset.panning="true",he.current={x:A.clientX,y:A.clientY,cameraX:a.x,cameraY:a.y},Ce=he.current,!Ce))return}const Re=A.clientX-Ce.x,Fe=A.clientY-Ce.y,it=Ce.cameraX-Re,Ze=Ce.cameraY-Fe;u(ze=>({x:it,y:Ze,zoom:ze.zoom})),W(),A.preventDefault();return}let oe=he.current;if(!oe)return;if(!ee.current){const Ce=A.clientX-oe.x,Re=A.clientY-oe.y;if(Ce*Ce+Re*Re<Hl||(ee.current=!0,V.current=null,ue.dataset.panning="true",he.current={x:A.clientX,y:A.clientY,cameraX:a.x,cameraY:a.y},oe=he.current,!oe))return}const me=A.clientX-oe.x,Q=A.clientY-oe.y,fe=oe.cameraX-me,we=oe.cameraY-Q;u(Ce=>({x:fe,y:we,zoom:Ce.zoom})),W(),A.preventDefault()},_=A=>{const ue=A.currentTarget,oe=V.current,me=oe?.pointerId===A.pointerId,Q=ee.current;if(A.pointerType==="touch"?(ce.current.delete(A.pointerId),ce.current.size<2&&(O.current=null,ue&&(ue.dataset.pinching="false")),ce.current.size===0&&(ee.current=!1,he.current=null,ue&&(ue.dataset.panning="false"))):Q&&(ee.current=!1,he.current=null,ue&&(ue.dataset.panning="false")),me&&oe){const fe=A.clientX-oe.startX,we=A.clientY-oe.startY;fe*fe+we*we>Hl||Q?A.preventDefault():(A.preventDefault(),b(oe.nodeId)),V.current=null}else Q&&A.preventDefault();A.pointerType!=="touch"&&(he.current=null),ue?.releasePointerCapture?.(A.pointerId)},[B,X]=N.useState(null),J=N.useRef(null),ne=N.useRef(null),se=N.useCallback(()=>{ne.current!==null&&(window.clearTimeout(ne.current),ne.current=null)},[]),pe=N.useCallback(()=>{se(),J.current=null,X(null)},[se]),ge=N.useCallback(()=>{se(),ne.current=window.setTimeout(()=>{pe()},160)},[se,pe]);N.useEffect(()=>{if(B===null)return;const A=ue=>{const oe=ue.target;oe&&J.current?.contains(oe)||pe()};return window.addEventListener("mousedown",A),()=>window.removeEventListener("mousedown",A)},[B,pe]),N.useEffect(()=>()=>{se()},[se]);const _e=A=>{ft.toggleNodeLock(A)};return h.jsxs("div",{className:"top-panel__content paper-noise",children:[g.show&&h.jsx("div",{className:"timeline-dialog-backdrop",children:h.jsxs("div",{className:"timeline-dialog",children:[h.jsxs("div",{className:"timeline-dialog__header",children:[h.jsx("div",{className:"timeline-dialog__tag",children:""}),h.jsx("div",{className:"timeline-dialog__title",children:g.isLocked?"":""})]}),h.jsx("div",{className:"timeline-dialog__body",children:g.isLocked?"EEE:"EEEE}),h.jsxs("div",{className:"timeline-dialog__footer",children:[h.jsx("button",{type:"button",className:"timeline-dialog__btn timeline-dialog__btn--ghost",onClick:q,children:"E}),h.jsx("button",{type:"button",className:"timeline-dialog__btn timeline-dialog__btn--primary",onClick:H,children:g.isLocked?"E:"E})]})]})}),h.jsxs("div",{className:"timeline-panel__canvas",ref:f,onPointerDown:Y,onPointerMove:P,onPointerUp:_,onPointerCancel:_,children:[h.jsx("div",{className:"timeline-panel__hint",children:"EEE EE}),h.jsxs("div",{className:"timeline-plane",style:ae,ref:c,children:[h.jsx("svg",{className:"timeline-edges","aria-hidden":"true",children:K.map((A,ue)=>{const oe=Math.min(80,Math.max(32,(A.y2-A.y1)*.5)),me=`M ${A.x1} ${A.y1} C ${A.x1} ${A.y1+oe}, ${A.x2} ${A.y2-oe}, ${A.x2} ${A.y2}`;return h.jsxs("g",{children:[h.jsx("path",{d:me,className:"timeline-edge timeline-edge--shadow"}),h.jsx("path",{d:me,className:"timeline-edge timeline-edge--main"})]},`edge-${ue}`)})}),n.nodes.map(A=>{const ue=k.pos.get(A.id)??{x:0,y:0},oe=C===A.id,me=n.currentNodeId===A.id,Q=S.has(A.id);return h.jsxs("div",{className:"timeline-node","data-selected":oe,"data-current":me,"data-locked":Q,"data-node-id":A.id,onClick:fe=>{fe.defaultPrevented||b(A.id)},ref:I(A.id),role:"button","aria-pressed":oe,"aria-label":` ${A.id}${Q?" (E":""}`,style:{left:ue.x,top:ue.y},children:[h.jsxs("span",{className:"timeline-node__id",children:["#",A.id]}),h.jsxs("div",{className:"timeline-node__menu-group",role:"group","data-open":B===A.id,onClick:fe=>fe.stopPropagation(),onMouseEnter:()=>{B===A.id&&se()},onMouseLeave:()=>{B===A.id&&ge()},ref:fe=>{B===A.id?J.current=fe:J.current===fe&&(J.current=null)},children:[B===A.id?h.jsxs(h.Fragment,{children:[h.jsx("button",{type:"button",className:"timeline-node__menu-action","aria-label":Q?"":"",title:Q?"":"",onClick:()=>_e(A.id),children:Q?"":""}),h.jsx("button",{type:"button",className:"timeline-node__menu-action","aria-label":"E",title:"E",onClick:()=>L(A.id),children:""})]}):null,h.jsx("button",{className:"timeline-node__menu-btn",type:"button","aria-label":B===A.id?"E:"E,title:B===A.id?"E:"E,"aria-expanded":B===A.id,onClick:()=>{if(B===A.id){pe();return}se(),X(A.id)},children:B===A.id?">":""})]}),h.jsx(ew,{text:A.title||A.summary||"(EE"})]},`node-${A.id}`)})]})]})]})}const op=[{id:"detail",label:"E,color:"sakura"},{id:"log",label:"EE,color:"matcha"},{id:"society",label:"",color:"mist"},{id:"timeline",label:"",color:"lavender"}];function nw({activeTab:r,onTabChange:n,className:s,scrollContainerRef:o}){const a=N.useRef(null),[u,f]=N.useState(null),c=Wo(),p=I=>{f(I.id)},g=()=>{f(null)},y=op.find(I=>I.id===u)??null,v=!!y;N.useEffect(()=>{let I=0,b=!1,M=0,D=0,L=!1;const F=24,H=F*3,q=a.current?.closest(".topbar"),te=o?.current,K=()=>{const ae=te?te.scrollTop:window.scrollY,ee=ae-I;if(I=ae,!!q){if(ae<=4){L&&(q.classList.remove("topbar--collapsed"),L=!1),M=0;return}ee>0&&(M+=ee,D=0,!L&&M>=F&&(q.classList.add("topbar--collapsed"),L=!0)),ee<0&&(D+=-ee,M=0,L&&D>=H&&(q.classList.remove("topbar--collapsed"),L=!1))}},z=()=>{b||(b=!0,requestAnimationFrame(()=>{K(),b=!1}))},W=te||window;return W.addEventListener("scroll",z,{passive:!0}),()=>W.removeEventListener("scroll",z)},[o]);const w={sakura:"top-panel--sakura",matcha:"top-panel--matcha",mist:"top-panel--mist",lavender:"top-panel--lavender"},S=nh,k=I=>xe("relative flex items-center justify-center","font-cpTitle font-medium transition-all duration-200","select-none cursor-pointer","h-7 min-w-[4.5rem] sm:min-w-[5.5rem] px-1.5 sm:px-3","border-none bg-transparent p-0 m-0 outline-none","rounded-b-md rounded-t-none border-r-2 border-b-2 border-l-2 border-dashed",th[I.color],"hover:border-white hover:text-white","active:border-white active:text-white",u===I.id&&["border-white text-white",S[I.color]]),E=()=>{if(!y)return null;switch(y.id){case"detail":return h.jsx(Sx,{});case"log":return h.jsx(Gx,{});case"society":return h.jsx(Zx,{});case"timeline":return h.jsx(tw,{});default:return null}},C=h.jsx("div",{className:xe("top-panel-overlay z-[300]",v&&"top-panel-overlay--visible"),onClick:g,"aria-hidden":!v,children:v&&h.jsx("div",{className:xe("top-panel z-[310]","top-panel--visible",y&&w[y.color],c?"top-panel--mobile":"top-panel--desktop"),style:c&&y?.id==="society"?{height:"auto",aspectRatio:.9}:void 0,role:"dialog","aria-modal":"true",onClick:I=>I.stopPropagation(),children:E()})});return h.jsxs(h.Fragment,{children:[h.jsx("div",{ref:a,className:xe("flex items-center justify-center gap-2 sm:gap-6 w-full max-w-4xl mx-auto",s),children:op.map(I=>h.jsx("button",{type:"button",className:k(I),onClick:()=>p(I),children:h.jsx("span",{className:"text-sm relative z-10 tracking-wide",children:I.label})},I.id))}),typeof document<"u"&&Ho.createPortal(C,document.body)]})}const fh=N.forwardRef(({className:r},n)=>{const s=pt("topFlagState");return h.jsxs("div",{ref:n,className:xe("flex flex-col items-center gap-6 pt-8",r),children:[h.jsx(bc,{currentTime:s.currentTime}),h.jsx(xc,{}),h.jsx(yc,{}),h.jsx("div",{className:"h-10"})]})});fh.displayName="LeftPanel";function rw(){const{layoutVariant:r}=si(),{woodenSignTime:n,statusCardProps:s,gaugesValues:o}=wc(),[a,u]=N.useState(null),f=N.useRef(null),c=N.useRef(null),p=N.useRef({}),g=N.useRef({}),[y,v]=N.useState(null),w=r==="mobile-drawer",S=N.useMemo(()=>[{id:"left-sign",label:"E,color:"sakura",side:"left",content:h.jsx(bc,{currentTime:n})},{id:"left-portrait",label:"E,color:"matcha",side:"left",content:h.jsx(xc,{})},{id:"left-settings",label:"",color:"lavender",side:"left",content:h.jsx(yc,{})},{id:"right-status",label:"E,color:"mist",side:"right",content:h.jsx(mc,{...s})},{id:"right-traits",label:"",color:"lavender",side:"right",content:h.jsx(pc,{values:o})}],[o,s,n]);N.useEffect(()=>{!w&&a&&u(null)},[w,a]),N.useEffect(()=>{if(!a)return;const b=M=>{M.key==="Escape"&&u(null)};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[a]);const k=N.useCallback(b=>{if(typeof window>"u")return;const M=g.current[b];if(!M)return;const D=M.getBoundingClientRect(),L=D.top+D.height/2,F=Math.min(Math.max(L,24),window.innerHeight-24);v(F)},[]);N.useEffect(()=>{if(!a)return;k(a);const b=()=>k(a);return window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[a,k]),N.useEffect(()=>{if(!a)return;const b=M=>{const D=M.target;D&&(a&&p.current[a]?.contains(D)||f.current?.contains(D)||c.current?.contains(D)||u(null))};return document.addEventListener("pointerdown",b,!0),()=>document.removeEventListener("pointerdown",b,!0)},[a]);const E=N.useMemo(()=>b=>xe("relative flex items-center justify-center","font-cpTitle font-medium text-sm tracking-wide","h-[5.5rem] w-7 rounded-2xl border-2 border-dashed","transition-all duration-200 select-none cursor-pointer","outline-none",b.side==="left"?"rounded-l-none rounded-tr-md rounded-br-md border-l-0":"rounded-r-none rounded-tl-md rounded-bl-md border-r-0",th[b.color],"hover:border-white hover:text-white","active:border-white active:text-white",a===b.id&&["border-white text-white",nh[b.color]]),[a]);if(!w)return null;const C=b=>{u(M=>{const D=M===b?null:b;return D?k(D):v(null),D})},I=b=>{const M=a===b.id,D=b.side==="left"?M?"translate-x-0":"-translate-x-full":M?"translate-x-0":"translate-x-full";return h.jsx("div",{ref:L=>{p.current[b.id]=L},className:xe("fixed z-[200] pointer-events-none",b.side==="left"?"left-0":"right-0"),style:{top:y??"50%",transform:"translateY(-50%)"},"aria-hidden":!M,children:h.jsx("div",{className:xe("transition-transform duration-250 ease-out",D,M?"pointer-events-auto":"pointer-events-none"),children:h.jsx("div",{className:"max-h-[80vh] max-w-[18rem] w-auto overflow-y-auto px-2 pb-3 pt-2 pointer-events-auto",role:M?"dialog":void 0,"aria-modal":M||void 0,children:b.content})})},b.id)};return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"fixed inset-y-0 left-0 z-[190] flex items-start pointer-events-none",children:h.jsx("div",{ref:f,className:"relative h-full w-[28px]",children:S.filter(b=>b.side==="left").map((b,M)=>{const L=["25%","50%","75%"][M]??"50%";return h.jsx("button",{type:"button","aria-expanded":a===b.id,style:{writingMode:"vertical-rl",top:L,transform:"translateY(-50%)"},className:xe(E(b),"absolute left-0 transition-transform duration-200 ease-out pointer-events-auto",a===b.id&&"-translate-x-full opacity-0 pointer-events-none"),ref:F=>{g.current[b.id]=F},onClick:()=>C(b.id),children:b.label},b.id)})})}),h.jsx("div",{className:"fixed inset-y-0 right-0 z-[190] flex items-start pointer-events-none",children:h.jsx("div",{ref:c,className:"relative h-full w-[28px]",children:S.filter(b=>b.side==="right").map((b,M)=>{const L=["40%","60%"][M]??"50%";return h.jsx("button",{type:"button","aria-expanded":a===b.id,style:{writingMode:"vertical-rl",top:L,transform:"translateY(-50%)"},className:xe(E(b),"absolute right-0 transition-transform duration-200 ease-out pointer-events-auto",a===b.id&&"translate-x-full opacity-0 pointer-events-none"),ref:F=>{g.current[b.id]=F},onClick:()=>C(b.id),children:b.label},b.id)})})}),S.map(b=>I(b))]})}const ph=N.forwardRef(({className:r},n)=>{const{statusCardProps:s,gaugesValues:o}=wc();return h.jsxs("div",{ref:n,className:xe("flex flex-col gap-6 pt-8",r),children:[h.jsx(mc,{...s}),h.jsx(pc,{values:o}),h.jsx("div",{className:"flex-1"})]})});ph.displayName="RightPanel";function sw(r,n,s,o=.08){const a=N.useRef(null),u=N.useRef({left:0,right:0}),f=N.useRef({left:0,right:0}),c=N.useCallback(()=>{const p=f.current.left-u.current.left,g=f.current.right-u.current.right;if(Math.abs(p)<.1&&Math.abs(g)<.1){u.current.left=f.current.left,u.current.right=f.current.right,n.current&&(n.current.style.transform=`translateY(${u.current.left}px)`),s.current&&(s.current.style.transform=`translateY(${u.current.right}px)`),a.current=null;return}const y=p*o,v=g*o;u.current.left+=y,u.current.right+=v,n.current&&(n.current.style.transform=`translateY(${u.current.left}px)`),s.current&&(s.current.style.transform=`translateY(${u.current.right}px)`),a.current=requestAnimationFrame(c)},[n,s,o]);N.useEffect(()=>{const p=r.current;if(!p)return;let g;const y=()=>{const v=p.scrollTop;f.current.left=v,f.current.right=v,g&&clearTimeout(g),g=setTimeout(()=>{a.current||(a.current=requestAnimationFrame(c))},16),a.current||(a.current=requestAnimationFrame(c))};return p.addEventListener("scroll",y,{passive:!0}),()=>{p.removeEventListener("scroll",y),g&&clearTimeout(g),a.current&&cancelAnimationFrame(a.current)}},[r,c]),N.useEffect(()=>{n.current&&(n.current.style.transform="translateY(0px)"),s.current&&(s.current.style.transform="translateY(0px)")},[n,s])}function iw({targetRef:r}){return N.useEffect(()=>{const n=r.current;if(!n)return;const s=f=>{const c=r.current;if(!c)return;const{scrollTop:p,scrollHeight:g,clientHeight:y}=c,v=p<=0,w=p+y>=g-1;(v&&f.deltaY<0||w&&f.deltaY>0||g<=y)&&f.preventDefault()};let o=0;const a=f=>{f.touches&&f.touches.length>0&&(o=f.touches[0].clientY)},u=f=>{const c=r.current;if(!c||!f.touches||f.touches.length===0)return;const g=f.touches[0].clientY-o,{scrollTop:y,scrollHeight:v,clientHeight:w}=c,S=y<=0,k=y+w>=v-1;(S&&g>0||k&&g<0||v<=w)&&f.preventDefault()};return n.addEventListener("wheel",s,{passive:!1}),n.addEventListener("touchstart",a,{passive:!0}),n.addEventListener("touchmove",u,{passive:!1}),()=>{n.removeEventListener("wheel",s),n.removeEventListener("touchstart",a),n.removeEventListener("touchmove",u)}},[r]),null}function ow({topBar:r,leftPanel:n,centerArea:s,rightPanel:o,backgroundRef:a}){const u=N.useRef(null),f=N.useRef(null),c=N.useRef(null);return sw(u,f,c),h.jsx("div",{ref:a,className:"app-canvas",children:h.jsxs("div",{ref:u,className:"app-scroll",children:[h.jsx(iw,{targetRef:u}),h.jsxs("div",{className:"game-layout",children:[h.jsx("div",{className:"topbar",children:r(u)}),h.jsx("div",{ref:f,className:"left-panel smooth-follow",children:n}),h.jsx("div",{className:"center-area",children:s}),h.jsx("div",{ref:c,className:"right-panel smooth-follow",children:o})]})]})})}function aw({mode:r,imageUrl:n,surfaceOpacity:s,targetRef:o}){return N.useEffect(()=>{const a=n,u=r??(a?"image":"pattern"),f=o?.current;if(f)return f.classList.remove("bg-pattern","bg-image"),u==="image"?(f.classList.add("bg-image"),a?f.style.setProperty("--global-bg-image",`url(${Nt.resolvePath(a)})`):f.style.removeProperty("--global-bg-image")):(f.classList.add("bg-pattern"),f.style.removeProperty("--global-bg-image")),s!==void 0?f.style.setProperty("--surface-opacity",s.toString()):f.style.removeProperty("--surface-opacity"),()=>{}},[r,n,s,o]),null}const lw={theme:"light",setTheme:()=>null},cw=N.createContext(lw);function hh({children:r,defaultTheme:n="light",storageKey:s="kawaii-game-ui-theme",...o}){const[a,u]=N.useState(()=>localStorage.getItem(s)||n);N.useEffect(()=>{const c=window.document.documentElement;if(c.classList.remove("light","dark"),a==="system"){const p=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";c.classList.add(p);return}c.classList.add(a)},[a]);const f={theme:a,setTheme:c=>{localStorage.setItem(s,c),u(c)}};return h.jsx(cw.Provider,{...o,value:f,children:r})}const as="https://files.yuzuki-rii.xyz/bby/v1.0.bin";function uw(r){return r.nodes.map(n=>({id:n.id,previousNodeId:n.previousNodeId,title:n.title,summary:n.summary}))}function dw(r){return Array.isArray(r)?r.map(n=>n&&typeof n.action=="string"?n.action.trim():"").filter(n=>!!n):[]}function fw(){const r=cc();N.useEffect(()=>{let n=!1;const s=(p,g)=>{n||r({type:"PATCH_SLICE",slice:p,patch:g})},o=p=>{n||(s("basic",{nodeID:p.id,currPOV:p.gamePOV}),s("topFlagState",{currentTime:p.currentTime??""}),s("currentEventState",{current:p.currentEventState??null}),s("portraitFrame",p.portraitFrame),s("statusCard",p.statusCard),s("dashboardGauges",p.dashboardGauges),s("mainTextBox",{content:p.storyContent,options:dw(p.nextAction),mapPosition:p.mapPosition,parseFailed:!!p.parseFailed}),s("detailPanel",p.detailPanel),s("logPanel",p.logPanel),s("societyPanel",p.societyPanel))},a=(p,g)=>{n||s("timelinePanel",{nodes:uw(p),currentNodeId:g,lockedNodeIds:p.lockedNodeIds??[]})},u=(p,g)=>{const y=g??p.currentNodeId??(p.nodes.length>0?p.nodes[p.nodes.length-1].id:null);if(a(p,y),y!==null){const v=p.nodes.find(w=>w.id===y);v&&o(v)}};return ax({setCurrentNodeData:p=>{const g=ft.getFullHistory();u(g,p?.id??g.currentNodeId)},setSelectedNodeId:p=>{n||(s("basic",{nodeID:p??0}),s("timelinePanel",{currentNodeId:p??null}))},updateHistoryMeta:p=>{const g=ft.getFullHistory();u(g,p.currentNodeId??g.currentNodeId)},setStreamingStoryContent:p=>{s("mainTextBox",{content:p})}}),(async()=>{try{await ft.initialize()}catch(y){console.error("[useHistoryHydration] Failed to initialize history manager",y);return}if(n)return;const p=ft.getCurrentNode(),g=ft.getFullHistory();u(g,p?.id??g.currentNodeId)})(),()=>{n=!0}},[r])}function pw(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function mh(r,n,s=""){const o=pw(r),a=r?.length;if(!o||n!==void 0){const f=s&&`"${s}" `,c="",p=o?`length=${a}`:`type=${typeof r}`;throw new Error(f+"expected Uint8Array"+c+", got "+p)}return r}function ap(r,n=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(n&&r.finished)throw new Error("Hash#digest() has already been called")}function hw(r,n){mh(r,void 0,"digestInto() output");const s=n.outputLen;if(r.length<s)throw new Error('"digestInto() output" expected to be of length >='+s)}function ic(...r){for(let n=0;n<r.length;n++)r[n].fill(0)}function Wl(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function wn(r,n){return r<<32-n|r>>>n}function mw(r,n={}){const s=(a,u)=>r(u).update(a).digest(),o=r(void 0);return s.outputLen=o.outputLen,s.blockLen=o.blockLen,s.create=a=>r(a),Object.assign(s,n),Object.freeze(s)}const gw=r=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,r])});function yw(r,n,s){return r&n^~r&s}function vw(r,n,s){return r&n^r&s^n&s}class xw{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(n,s,o,a){this.blockLen=n,this.outputLen=s,this.padOffset=o,this.isLE=a,this.buffer=new Uint8Array(n),this.view=Wl(this.buffer)}update(n){ap(this),mh(n);const{view:s,buffer:o,blockLen:a}=this,u=n.length;for(let f=0;f<u;){const c=Math.min(a-this.pos,u-f);if(c===a){const p=Wl(n);for(;a<=u-f;f+=a)this.process(p,f);continue}o.set(n.subarray(f,f+c),this.pos),this.pos+=c,f+=c,this.pos===a&&(this.process(s,0),this.pos=0)}return this.length+=n.length,this.roundClean(),this}digestInto(n){ap(this),hw(n,this),this.finished=!0;const{buffer:s,view:o,blockLen:a,isLE:u}=this;let{pos:f}=this;s[f++]=128,ic(this.buffer.subarray(f)),this.padOffset>a-f&&(this.process(o,0),f=0);for(let v=f;v<a;v++)s[v]=0;o.setBigUint64(a-8,BigInt(this.length*8),u),this.process(o,0);const c=Wl(n),p=this.outputLen;if(p%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const g=p/4,y=this.get();if(g>y.length)throw new Error("_sha2: outputLen bigger than state");for(let v=0;v<g;v++)c.setUint32(4*v,y[v],u)}digest(){const{buffer:n,outputLen:s}=this;this.digestInto(n);const o=n.slice(0,s);return this.destroy(),o}_cloneInto(n){n||=new this.constructor,n.set(...this.get());const{blockLen:s,buffer:o,length:a,finished:u,destroyed:f,pos:c}=this;return n.destroyed=f,n.finished=u,n.length=a,n.pos=c,a%s&&n.buffer.set(o),n}clone(){return this._cloneInto()}}const lr=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ww=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),cr=new Uint32Array(64);class bw extends xw{constructor(n){super(64,n,8,!1)}get(){const{A:n,B:s,C:o,D:a,E:u,F:f,G:c,H:p}=this;return[n,s,o,a,u,f,c,p]}set(n,s,o,a,u,f,c,p){this.A=n|0,this.B=s|0,this.C=o|0,this.D=a|0,this.E=u|0,this.F=f|0,this.G=c|0,this.H=p|0}process(n,s){for(let v=0;v<16;v++,s+=4)cr[v]=n.getUint32(s,!1);for(let v=16;v<64;v++){const w=cr[v-15],S=cr[v-2],k=wn(w,7)^wn(w,18)^w>>>3,E=wn(S,17)^wn(S,19)^S>>>10;cr[v]=E+cr[v-7]+k+cr[v-16]|0}let{A:o,B:a,C:u,D:f,E:c,F:p,G:g,H:y}=this;for(let v=0;v<64;v++){const w=wn(c,6)^wn(c,11)^wn(c,25),S=y+w+yw(c,p,g)+ww[v]+cr[v]|0,E=(wn(o,2)^wn(o,13)^wn(o,22))+vw(o,a,u)|0;y=g,g=p,p=c,c=f+S|0,f=u,u=a,a=o,o=S+E|0}o=o+this.A|0,a=a+this.B|0,u=u+this.C|0,f=f+this.D|0,c=c+this.E|0,p=p+this.F|0,g=g+this.G|0,y=y+this.H|0,this.set(o,a,u,f,c,p,g,y)}roundClean(){ic(cr)}destroy(){this.set(0,0,0,0,0,0,0,0),ic(this.buffer)}}class kw extends bw{A=lr[0]|0;B=lr[1]|0;C=lr[2]|0;D=lr[3]|0;E=lr[4]|0;F=lr[5]|0;G=lr[6]|0;H=lr[7]|0;constructor(){super(32)}}const Sw=mw(()=>new kw,gw(1));function Nw(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Bt(r,n,s=""){const o=Nw(r),a=r?.length,u=n!==void 0;if(!o||u&&a!==n){const f=s&&`"${s}" `,c=u?` of length ${n}`:"",p=o?`length=${a}`:`type=${typeof r}`;throw new Error(f+"expected Uint8Array"+c+", got "+p)}return r}function $o(r,n=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(n&&r.finished)throw new Error("Hash#digest() has already been called")}function gh(r,n){Bt(r,void 0,"output");const s=n.outputLen;if(r.length<s)throw new Error("digestInto() expects output buffer of length at least "+s)}function _w(r){return new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}function On(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function Fn(...r){for(let n=0;n<r.length;n++)r[n].fill(0)}function Yo(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}const Ew=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Cw(r,n){if(r.length!==n.length)return!1;let s=0;for(let o=0;o<r.length;o++)s|=r[o]^n[o];return s===0}const Iw=(r,n)=>{function s(o,...a){if(Bt(o,void 0,"key"),!Ew)throw new Error("Non little-endian hardware is not yet supported");if(r.nonceLength!==void 0){const y=a[0];Bt(y,r.varSizeNonce?void 0:r.nonceLength,"nonce")}const u=r.tagLength;u&&a[1]!==void 0&&Bt(a[1],void 0,"AAD");const f=n(o,...a),c=(y,v)=>{if(v!==void 0){if(y!==2)throw new Error("cipher output not supported");Bt(v,void 0,"output")}};let p=!1;return{encrypt(y,v){if(p)throw new Error("cannot encrypt() twice with same key + nonce");return p=!0,Bt(y),c(f.encrypt.length,v),f.encrypt(y,v)},decrypt(y,v){if(Bt(y),u&&y.length<u)throw new Error('"ciphertext" expected length bigger than tagLength='+u);return c(f.decrypt.length,v),f.decrypt(y,v)}}}return Object.assign(s,r),s};function jw(r,n,s=!0){if(n===void 0)return new Uint8Array(r);if(n.length!==r)throw new Error('"output" expected Uint8Array of length '+r+", got: "+n.length);if(s&&!Bo(n))throw new Error("invalid output, must be aligned");return n}function Mw(r,n,s){const o=new Uint8Array(16),a=Yo(o);return a.setBigUint64(0,BigInt(n),s),a.setBigUint64(8,BigInt(r),s),o}function Bo(r){return r.byteOffset%4===0}function Ar(r){return Uint8Array.from(r)}const zn=16,Cc=new Uint8Array(16),bn=On(Cc),Pw=225,Tw=(r,n,s,o)=>{const a=o&1;return{s3:s<<31|o>>>1,s2:n<<31|s>>>1,s1:r<<31|n>>>1,s0:r>>>1^Pw<<24&-(a&1)}},nn=r=>(r>>>0&255)<<24|(r>>>8&255)<<16|(r>>>16&255)<<8|r>>>24&255|0;function Aw(r){r.reverse();const n=r[15]&1;let s=0;for(let o=0;o<r.length;o++){const a=r[o];r[o]=a>>>1|s,s=(a&1)<<7}return r[0]^=-n&225,r}const Lw=r=>r>64*1024?8:r>1024?4:2;class yh{blockLen=zn;outputLen=zn;s0=0;s1=0;s2=0;s3=0;finished=!1;t;W;windowSize;constructor(n,s){Bt(n,16,"key"),n=Ar(n);const o=Yo(n);let a=o.getUint32(0,!1),u=o.getUint32(4,!1),f=o.getUint32(8,!1),c=o.getUint32(12,!1);const p=[];for(let k=0;k<128;k++)p.push({s0:nn(a),s1:nn(u),s2:nn(f),s3:nn(c)}),{s0:a,s1:u,s2:f,s3:c}=Tw(a,u,f,c);const g=Lw(s||1024);if(![1,2,4,8].includes(g))throw new Error("ghash: invalid window size, expected 2, 4 or 8");this.W=g;const v=128/g,w=this.windowSize=2**g,S=[];for(let k=0;k<v;k++)for(let E=0;E<w;E++){let C=0,I=0,b=0,M=0;for(let D=0;D<g;D++){if(!(E>>>g-D-1&1))continue;const{s0:F,s1:H,s2:q,s3:te}=p[g*k+D];C^=F,I^=H,b^=q,M^=te}S.push({s0:C,s1:I,s2:b,s3:M})}this.t=S}_updateBlock(n,s,o,a){n^=this.s0,s^=this.s1,o^=this.s2,a^=this.s3;const{W:u,t:f,windowSize:c}=this;let p=0,g=0,y=0,v=0;const w=(1<<u)-1;let S=0;for(const k of[n,s,o,a])for(let E=0;E<4;E++){const C=k>>>8*E&255;for(let I=8/u-1;I>=0;I--){const b=C>>>u*I&w,{s0:M,s1:D,s2:L,s3:F}=f[S*c+b];p^=M,g^=D,y^=L,v^=F,S+=1}}this.s0=p,this.s1=g,this.s2=y,this.s3=v}update(n){$o(this),Bt(n),n=Ar(n);const s=On(n),o=Math.floor(n.length/zn),a=n.length%zn;for(let u=0;u<o;u++)this._updateBlock(s[u*4+0],s[u*4+1],s[u*4+2],s[u*4+3]);return a&&(Cc.set(n.subarray(o*zn)),this._updateBlock(bn[0],bn[1],bn[2],bn[3]),Fn(bn)),this}destroy(){const{t:n}=this;for(const s of n)s.s0=0,s.s1=0,s.s2=0,s.s3=0}digestInto(n){$o(this),gh(n,this),this.finished=!0;const{s0:s,s1:o,s2:a,s3:u}=this,f=On(n);return f[0]=s,f[1]=o,f[2]=a,f[3]=u,n}digest(){const n=new Uint8Array(zn);return this.digestInto(n),this.destroy(),n}}class Rw extends yh{constructor(n,s){Bt(n);const o=Aw(Ar(n));super(o,s),Fn(o)}update(n){$o(this),Bt(n),n=Ar(n);const s=On(n),o=n.length%zn,a=Math.floor(n.length/zn);for(let u=0;u<a;u++)this._updateBlock(nn(s[u*4+3]),nn(s[u*4+2]),nn(s[u*4+1]),nn(s[u*4+0]));return o&&(Cc.set(n.subarray(a*zn)),this._updateBlock(nn(bn[3]),nn(bn[2]),nn(bn[1]),nn(bn[0])),Fn(bn)),this}digestInto(n){$o(this),gh(n,this),this.finished=!0;const{s0:s,s1:o,s2:a,s3:u}=this,f=On(n);return f[0]=s,f[1]=o,f[2]=a,f[3]=u,n.reverse()}}function vh(r){const n=(o,a)=>r(a,o.length).update(o).digest(),s=r(new Uint8Array(16),0);return n.outputLen=s.outputLen,n.blockLen=s.blockLen,n.create=(o,a)=>r(o,a),n}const lp=vh((r,n)=>new yh(r,n));vh((r,n)=>new Rw(r,n));const oc=16,zw=4,Io=new Uint8Array(oc),Ow=283;function Fw(r){if(![16,24,32].includes(r.length))throw new Error('"aes key" expected Uint8Array of length 16/24/32, got length='+r.length)}function Ic(r){return r<<1^Ow&-(r>>7)}function cp(r,n){let s=0;for(;n>0;n>>=1)s^=r&-(n&1),r=Ic(r);return s}const Dw=(()=>{const r=new Uint8Array(256);for(let s=0,o=1;s<256;s++,o^=Ic(o))r[s]=o;const n=new Uint8Array(256);n[0]=99;for(let s=0;s<255;s++){let o=r[255-s];o|=o<<8,n[r[s]]=(o^o>>4^o>>5^o>>6^o>>7^99)&255}return Fn(r),n})(),$w=r=>r<<24|r>>>8,Vl=r=>r<<8|r>>>24;function Bw(r,n){if(r.length!==256)throw new Error("Wrong sbox length");const s=new Uint32Array(256).map((g,y)=>n(r[y])),o=s.map(Vl),a=o.map(Vl),u=a.map(Vl),f=new Uint32Array(256*256),c=new Uint32Array(256*256),p=new Uint16Array(256*256);for(let g=0;g<256;g++)for(let y=0;y<256;y++){const v=g*256+y;f[v]=s[g]^o[y],c[v]=a[g]^u[y],p[v]=r[g]<<8|r[y]}return{sbox:r,sbox2:p,T0:s,T1:o,T2:a,T3:u,T01:f,T23:c}}const xh=Bw(Dw,r=>cp(r,3)<<24|r<<16|r<<8|cp(r,2)),Uw=(()=>{const r=new Uint8Array(16);for(let n=0,s=1;n<16;n++,s=Ic(s))r[n]=s;return r})();function Hw(r){Bt(r);const n=r.length;Fw(r);const{sbox2:s}=xh,o=[];Bo(r)||o.push(r=Ar(r));const a=On(r),u=a.length,f=p=>ri(s,p,p,p,p),c=new Uint32Array(n+28);c.set(a);for(let p=u;p<c.length;p++){let g=c[p-1];p%u===0?g=f($w(g))^Uw[p/u-1]:u>6&&p%u===4&&(g=f(g)),c[p]=c[p-u]^g}return Fn(...o),c}function jo(r,n,s,o,a,u){return r[s<<8&65280|o>>>8&255]^n[a>>>8&65280|u>>>24&255]}function ri(r,n,s,o,a){return r[n&255|s&65280]|r[o>>>16&255|a>>>16&65280]<<16}function up(r,n,s,o,a){const{sbox2:u,T01:f,T23:c}=xh;let p=0;n^=r[p++],s^=r[p++],o^=r[p++],a^=r[p++];const g=r.length/4-2;for(let k=0;k<g;k++){const E=r[p++]^jo(f,c,n,s,o,a),C=r[p++]^jo(f,c,s,o,a,n),I=r[p++]^jo(f,c,o,a,n,s),b=r[p++]^jo(f,c,a,n,s,o);n=E,s=C,o=I,a=b}const y=r[p++]^ri(u,n,s,o,a),v=r[p++]^ri(u,s,o,a,n),w=r[p++]^ri(u,o,a,n,s),S=r[p++]^ri(u,a,n,s,o);return{s0:y,s1:v,s2:w,s3:S}}function Mo(r,n,s,o,a){Bt(s,oc,"nonce"),Bt(o),a=jw(o.length,a);const u=s,f=On(u),c=Yo(u),p=On(o),g=On(a),y=n?0:12,v=o.length;let w=c.getUint32(y,n),{s0:S,s1:k,s2:E,s3:C}=up(r,f[0],f[1],f[2],f[3]);for(let b=0;b+4<=p.length;b+=4)g[b+0]=p[b+0]^S,g[b+1]=p[b+1]^k,g[b+2]=p[b+2]^E,g[b+3]=p[b+3]^C,w=w+1>>>0,c.setUint32(y,w,n),{s0:S,s1:k,s2:E,s3:C}=up(r,f[0],f[1],f[2],f[3]);const I=oc*Math.floor(p.length/zw);if(I<v){const b=new Uint32Array([S,k,E,C]),M=_w(b);for(let D=I,L=0;D<v;D++,L++)a[D]=o[D]^M[L];Fn(b)}return a}function Ww(r,n,s,o,a){const u=a?a.length:0,f=r.create(s,o.length+u);a&&f.update(a);const c=Mw(8*o.length,8*u,n);f.update(o),f.update(c);const p=f.digest();return Fn(c),p}const Vw=Iw({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},function(n,s,o){if(s.length<8)throw new Error("aes/gcm: invalid nonce length");const a=16;function u(c,p,g){const y=Ww(lp,!1,c,g,o);for(let v=0;v<p.length;v++)y[v]^=p[v];return y}function f(){const c=Hw(n),p=Io.slice(),g=Io.slice();if(Mo(c,!1,g,g,p),s.length===12)g.set(s);else{const v=Io.slice();Yo(v).setBigUint64(8,BigInt(s.length*8),!1);const S=lp.create(p).update(s).update(v);S.digestInto(g),S.destroy()}const y=Mo(c,!1,g,Io);return{xk:c,authKey:p,counter:g,tagMask:y}}return{encrypt(c){const{xk:p,authKey:g,counter:y,tagMask:v}=f(),w=new Uint8Array(c.length+a),S=[p,g,y,v];Bo(c)||S.push(c=Ar(c)),Mo(p,!1,y,c,w.subarray(0,c.length));const k=u(g,v,w.subarray(0,w.length-a));return S.push(k),w.set(k,c.length),Fn(...S),w},decrypt(c){const{xk:p,authKey:g,counter:y,tagMask:v}=f(),w=[p,g,v,y];Bo(c)||w.push(c=Ar(c));const S=c.subarray(0,-a),k=c.subarray(-a),E=u(g,v,S);if(w.push(E),!Cw(E,k))throw new Error("aes/gcm: invalid ghash tag");const C=Mo(p,!1,y,S);return Fn(...w),C}}}),Gw="shino";let oi="";function Yw(r){typeof r=="string"&&r.length>0&&(oi=r)}function wh(){try{return globalThis.crypto?.subtle}catch{return}}function Kw(r){return Sw(r)}async function bh(r=oi){const n=new TextEncoder,s=wh(),o=n.encode(r);if(s){const a=await s.digest("SHA-256",o);return s.importKey("raw",a,{name:"AES-GCM"},!1,["decrypt"])}else return Kw(o)}function Xw(r){const n=new DataView(r);if(n.getUint8(0)!==83||n.getUint8(1)!==73||n.getUint8(2)!==78||n.getUint8(3)!==79)throw new Error("Emagic E);const s=n.getUint8(4),o=n.getUint8(5),a=n.getUint8(6);if(s!==1)throw new Error("");if(o!==1)throw new Error("EEE);const u=a===3,f=new Uint8Array(r.slice(8,20)),c=n.getUint32(20),p=24;if(p+c>n.byteLength)throw new Error("E");const g=new Uint8Array(r.slice(p,p+c));return{iv:f,cipher:g,compressed:u}}function Qw(r,n,s){if(r.byteLength<16)throw new Error("EE: EGCM tag");const a=Vw(n,s).decrypt(r);return a.byteOffset===0&&a.byteLength===a.buffer.byteLength?a.buffer:a.slice().buffer}async function kh(r,n){const{iv:s,cipher:o,compressed:a}=Xw(r),u=wh();let f;if(u&&n instanceof CryptoKey?f=await u.decrypt({name:"AES-GCM",iv:s,tagLength:128},n,o):f=Qw(o,n,s),a)try{const c=globalThis.DecompressionStream;if(typeof c!="function")throw new Error("EEDecompressionStream(gzip)");const p=new c("gzip"),y=new Response(f).body;if(!y)throw new Error("Response body ");const v=y.pipeThrough(p);return await new Response(v).arrayBuffer()}catch(c){throw new Error(`: ${c}`)}else return f}function qw(r){const n=new DataView(r);if(n.getUint8(0)!==82||n.getUint8(1)!==80||n.getUint8(2)!==75||n.getUint8(3)!==49)throw new Error("Epayload magic E);const s=n.getUint32(4),o=8,a=o+s;if(a>n.byteLength)throw new Error("manifest ");const u=new Uint8Array(r,o,s),f=new TextDecoder().decode(u),c=JSON.parse(f),p=a,g=n.byteLength-p;let y=0;for(const v of c.files){const w=(v.offset>>>0)+(v.size>>>0);w>y&&(y=w)}if(y!==g)throw new Error(`[RiiPack] E expected=${y} actual=${g}`);return{meta:c,dataStart:p}}function Sh(r){const{meta:n,dataStart:s}=qw(r),o=new Map(n.files.map(g=>[g.path,g])),a=new Map,u=g=>{const y=o.get(g);if(!y)return;const v=s+y.offset;return new Uint8Array(r,v,y.size)},f=g=>{const y=o.get(g);if(!y)return;const v=u(g);if(v)return new Blob([v],{type:y.mime||"application/octet-stream"})};return{listPaths:()=>Array.from(o.keys()),has:g=>o.has(g),getEntry:g=>o.get(g),getBytes:u,getBlob:f,getUrl:g=>{if(a.has(g))return a.get(g);const y=f(g);if(!y)return;const v=URL.createObjectURL(y);return a.set(g,v),v},revokeUrl:g=>{const y=a.get(g);y&&(URL.revokeObjectURL(y),a.delete(g))}}}async function Zw(r,n=oi,s){const o=await bh(n),a=await fetch(r,{cache:"no-store"});if(!a.ok)throw new Error(`: ${a.status}`);const u=Number(a.headers.get("content-length")||0);let f;if(a.body&&u>0&&typeof a.body.getReader=="function"){const p=a.body.getReader(),g=[];let y=0;const v=90;for(;;){const{done:k,value:E}=await p.read();if(k)break;if(E&&(g.push(E),y+=E.byteLength,s&&u>0)){const C=Math.floor(y/u*v);s(Math.max(1,Math.min(C,v)))}}const w=new Uint8Array(y);let S=0;for(const k of g)w.set(k,S),S+=k.byteLength;f=w.buffer}else f=await a.arrayBuffer(),s&&s(90);const c=await kh(f,o);return s&&s(100),Sh(c)}async function dp(r,n=oi,s){const o=await bh(n),a=await fetch(r,{cache:"no-store"});if(!a.ok)throw new Error(`: ${a.status}`);const u=Number(a.headers.get("content-length")||0);let f;if(a.body&&u>0&&typeof a.body.getReader=="function"){const p=a.body.getReader(),g=[];let y=0;const v=90;for(;;){const{done:k,value:E}=await p.read();if(k)break;if(E&&(g.push(E),y+=E.byteLength,s&&u>0)){const C=Math.floor(y/u*v);s(Math.max(1,Math.min(C,v)))}}const w=new Uint8Array(y);let S=0;for(const k of g)w.set(k,S),S+=k.byteLength;f=w.buffer}else f=await a.arrayBuffer(),s&&s(90);const c=await kh(f,o);return s&&s(100),c}function ur(r){return Sh(r)}const Jw="rii-asset-pack-v1",Uo="packs";function Nh(){try{return typeof globalThis.indexedDB<"u"}catch{return!1}}function e1(){return new Promise((r,n)=>{if(!Nh()){n(new Error("IndexedDB "));return}const s=indexedDB.open(Jw,1);s.onupgradeneeded=()=>{const o=s.result;o.objectStoreNames.contains(Uo)||o.createObjectStore(Uo,{keyPath:"key"})},s.onsuccess=()=>r(s.result),s.onerror=()=>n(s.error||new Error("IndexedDB "))})}function jc(r,n){return e1().then(s=>new Promise((o,a)=>{const u=s.transaction(Uo,r),f=u.objectStore(Uo);let c;u.oncomplete=()=>{try{s.close()}catch{}o(c)},u.onerror=()=>{try{s.close()}catch{}a(u.error||new Error("IndexedDB "))},u.onabort=()=>{try{s.close()}catch{}a(u.error||new Error("IndexedDB "))};try{const p=n(f);if(p){const g=p;g.onsuccess=()=>{c=g.result},g.onerror=()=>{}}}catch(p){try{s.close()}catch{}a(p)}}))}async function fp(r){try{return await jc("readonly",s=>s.get(r))||null}catch{return null}}async function t1(r,n,s,o){const a={key:r,plain:n,sha256:s,expiresAt:o};await jc("readwrite",u=>u.put(a))}async function pp(r){try{await jc("readwrite",n=>n.delete(r))}catch{}}function hp(){return Nh()}const mp=[{family:"NaikaiFont-SemiBold",sources:["fonts/NaikaiFont-SemiBold.woff2"],weight:600},{family:"azuki",sources:["fonts/azuki.woff2"]},{family:"FZYouSongJ",sources:["fonts/FZYouSongJ.woff2"]}];let Gl=!1,ti=null;async function n1(){if(!Gl)return ti||(ti=(async()=>{if(typeof document>"u"||typeof FontFace!="function"||!document.fonts){console.warn("[VirtualFonts] FontFace API unavailable, skip registering pack fonts"),Gl=!0;return}Nt.ensureInit(),(await Promise.allSettled(mp.map(async n=>{const s=n.sources.map(u=>u.startsWith("/")?u.slice(1):u).find(u=>Nt.has(u));if(!s){console.warn(`[VirtualFonts] Missing font in pack: ${n.family}`);return}const o=await Nt.getDataUrl(s),a=new FontFace(n.family,`url(${o})`,{weight:n.weight!=null?String(n.weight):"normal",style:n.style??"normal",display:"swap"});await a.load(),document.fonts.add(a)}))).forEach((n,s)=>{n.status==="rejected"&&console.warn(`[VirtualFonts] Failed to load ${mp[s].family}: ${String(n.reason)}`)}),Gl=!0})().finally(()=>{ti=null}),ti)}async function An(r,n){Nt.setPack(r);try{await n1()}catch(s){console.warn(`[ExternalAssets] : ${String(s)}`)}n&&n(100)}async function r1(r){console.log("[ExternalAssets] E...");const n="rii-asset-pack-v1",s=`https://cache.rii/pack?src=${encodeURIComponent(as)}`,o=as.replace(/\.bin(\?.*)?$/i,".sha256");let a=null;try{const f=await fetch(o,{cache:"no-store"});f.ok?a=(await f.text()).trim().toLowerCase():console.warn(`[ExternalAssets] ESHA256 : ${f.status}`)}catch(f){console.warn(`[ExternalAssets] ESHA256 : ${String(f)}`)}if(globalThis.caches){const f=await globalThis.caches.open(n),c=new Request(s,{method:"GET"}),p=await f.match(c);if(p){const g=(p.headers.get("x-sha256")||"").trim().toLowerCase(),y=p.headers.get("x-expires-at")||"",v=Number(y),w=Number.isFinite(v)&&Date.now()<v;if(a&&g&&a===g&&w)try{const S=await p.arrayBuffer(),k=ur(S);await An(k,r),console.log("[ExternalAssets] Hit Cache");return}catch(S){console.warn(`[ExternalAssets] Cache Missed, rollback: ${String(S)}`)}if(!a&&w)try{const S=await p.arrayBuffer(),k=ur(S);await An(k,r),console.log("[ExternalAssets] EHA EE");return}catch(S){console.warn(`[ExternalAssets] E: ${String(S)}`)}}try{const g=await dp(as,void 0,r),y=ur(g),v=new Headers;v.set("content-type","application/octet-stream"),a&&v.set("x-sha256",a);const w=10080*60*1e3;v.set("x-expires-at",String(Date.now()+w)),await f.put(c,new Response(g,{headers:v})),await An(y,r),console.log("[ExternalAssets] EEEE);return}catch(g){console.error(`[ExternalAssets] : ${String(g)}`);const y=await f.match(c);if(y)try{const v=await y.arrayBuffer(),w=ur(v);await An(w,r),console.warn("[ExternalAssets] E);return}catch{}if(hp())console.warn("[ExternalAssets] Cache Storage EEIndexedDB E);else throw g}}if(hp()){const c=await fp(s);if(c){const p=Date.now()<c.expiresAt,g=(c.sha256||"").trim().toLowerCase();if(a&&g&&a===g&&p)try{const y=ur(c.plain);await An(y,r),console.log("[ExternalAssets]  IndexedDB EE);return}catch(y){console.warn(`[ExternalAssets]  IndexedDB E: ${String(y)}`),await pp(s)}if(!a&&p)try{const y=ur(c.plain);await An(y,r),console.log("[ExternalAssets]  IndexedDB EHA EE");return}catch(y){console.warn(`[ExternalAssets] IndexedDB E: ${String(y)}`),await pp(s)}}try{const p=await dp(as,void 0,r),g=ur(p);await t1(s,p,a||void 0,Date.now()+6048e5),await An(g,r),console.log("[ExternalAssets] EEEEndexedDB E);return}catch(p){console.error(`[ExternalAssets] IndexedDB /E: ${String(p)}`);const g=await fp(s);if(g)try{const y=ur(g.plain);await An(y,r),console.warn("[ExternalAssets] IndexedDB EESHA EE);return}catch{}}}console.warn("[ExternalAssets] E");const u=await Zw(as,void 0,r);await An(u,r),console.log("[ExternalAssets] EE(E")}function s1(r={}){const{hideSelectors:n=[],extraCSS:s=""}=r,o=N.useMemo(()=>{const C=window.frameElement,I=C?.id||"",b=C?`__wide_anti_clip_for_${C.id||"this_iframe"}`:"";return{iframeId:I,styleId:b}},[]),[a,u]=N.useState(()=>{try{const C=window.parent?.document;return!!(C&&C.getElementById(o.styleId))}catch{return!1}}),f=N.useRef(null),c=N.useCallback(()=>{try{const I=window.parent.document.documentElement.style,b=()=>{const F=window.parent.innerWidth/100;I.setProperty("--vwfix",F+"px");const q=(window.parent.visualViewport?.height??window.parent.innerHeight)/100;Number.isFinite(q)&&I.setProperty("--vhfix",q+"px")};b();const M=()=>b();window.parent.addEventListener("resize",M);const D=window.parent.visualViewport,L=D?()=>b():null;return D&&L&&D.addEventListener("resize",L),f.current=window.setInterval(b,500),()=>{try{window.parent.removeEventListener("resize",M),D&&L&&D.removeEventListener("resize",L),f.current!=null&&(clearInterval(f.current),f.current=null),I.removeProperty("--vwfix"),I.removeProperty("--vhfix")}catch{}}}catch{return()=>{}}},[]),p=N.useCallback(()=>{try{const C=window.parent.document;let I=C.getElementById(o.styleId);return I||(I=C.createElement("style"),I.id=o.styleId,C.head.appendChild(I)),I}catch{return null}},[o.styleId]),[g,y]=N.useState(!0),v=N.useCallback(C=>{const I=o.iframeId;if(!I)return"";const b=CSS?.escape?CSS.escape(I):I.replace(/([^\w-])/g,"\\$1"),M=`body:has(#${b})`,D=n.length?n.map(F=>`${M} ${F} { display:none !important; }`).join(`
`):"",L=C??g?`${M} #top-bar, ${M} #top-settings-holder { display: none !important; }`:"";return`
*:has(#${b}):not(html):not(body) {
  overflow: visible !important;
  clip-path: none !important;
  mask: none !important;
  -webkit-mask: none !important;
  contain: none !important;
  padding: 0 !important;
  margin: 0 auto !important;
}
html:has(#${b}), body:has(#${b}) {
  clip-path: none !important;
  mask: none !important;
  -webkit-mask: none !important;
  contain: none !important;
  min-block-size: calc(var(--vhfix, 1vh) * 100) !important;
  block-size: calc(var(--vhfix, 1vh) * 100) !important;
}

*:has(> #${b}):not(html):not(body) {
  position: relative !important;
  z-index: 2147483646 !important;
  inline-size: calc(var(--vwfix, 1vw) * 100) !important;             /* width */
  max-inline-size: none !important;
  margin-left:  calc(50% - (var(--vwfix, 1vw) * 50)) !important;     /* E*/
  margin-right: calc(50% - (var(--vwfix, 1vw) * 50)) !important;
  block-size: calc(var(--vhfix, 1vh) * 100) !important;
  min-block-size: calc(var(--vhfix, 1vh) * 100) !important;
  max-block-size: none !important;
}

#${b} {
  display: block !important;
  inline-size: 100% !important;
  max-inline-size: none !important;
  margin: 0 !important;
  padding: 0 !important;
  border: none !important;
  block-size: calc(var(--vhfix, 1vh) * 100) !important;
  min-block-size: calc(var(--vhfix, 1vh) * 100) !important;
  max-block-size: none !important;
}

.mes_text:has(#${b}), .mes_block:has(#${b}) {
  overflow: visible !important;
  max-inline-size: none !important;
}

${D}
${L}
html, body { overflow-x: clip !important; }
body:has(#${b}) #sheld { top: 0 !important; }

/* EE */
${s}
`.trim()},[o.iframeId,n,s,g]),w=N.useCallback(()=>{const C=p();if(!C)return alert("EEE),!1;const I=c();return C.textContent=v(),C.__uninstallVwFix__=I,u(!0),!0},[p,v,c]),S=N.useCallback(()=>{try{const I=window.parent.document.getElementById(o.styleId);if(I?.__uninstallVwFix__)try{I.__uninstallVwFix__()}catch{}I?.parentNode?.removeChild(I)}catch{}return u(!1),!0},[o.styleId]),k=N.useCallback(()=>{const C=!g;y(C);try{const I=p();I&&(I.textContent=v(C))}catch{}},[g,p,v]),E=N.useCallback(C=>{y(C);try{const I=p();I&&(I.textContent=v(C))}catch{}},[p,v]);return{isWide:a,enter:w,exit:S,iframeId:o.iframeId,styleId:o.styleId,topBarsHidden:g,toggleTopBars:k,setTopBars:E}}const i1=({className:r,style:n,enterLabel:s="EE,applyLocalFullscreenCss:o=!0,localExtraCss:a="",children:u,hideSelectors:f,extraCSS:c})=>{const{isWide:p,enter:g,exit:y}=s1({hideSelectors:f,extraCSS:c}),[v,w]=N.useState(!1),[S,k]=N.useState(0),[E,C]=N.useState(null);N.useEffect(()=>{let M=!1;return(async()=>{try{try{const L=window.TavernHelper?.getCharData?.("current",!1)?.data,F=L?.creator,H=L?.character_version,q=L?.creator_notes;let te=oi;F!=null&&H!=null&&q!=null&&(te=Gw+`
`+F+`
`+H+`
`+q),Yw(te)}catch{}await r1(L=>{if(M)return;const F=Math.max(0,Math.min(100,Math.floor(L)));k(F)}),M||(w(!0),k(100),C(null))}catch(L){console.error(`[WideModeGate] E ${L}`,"WideModeGate"),M||C(L instanceof Error?L.message:String(L))}})(),()=>{M=!0}},[]);const I=()=>{g()};N.useEffect(()=>{if(!p)return;const M=document.documentElement.style,D=()=>{try{const H=window.parent,q=(H?.visualViewport?.height??H?.innerHeight??window.innerHeight)/100;q&&isFinite(q)&&M.setProperty("--vhfix",q+"px")}catch{const H=(window.visualViewport?.height??window.innerHeight)/100;H&&isFinite(H)&&M.setProperty("--vhfix",H+"px")}};D();const L=[];try{const H=window.parent,q=()=>D();H.addEventListener?.("resize",q),L.push(()=>H.removeEventListener?.("resize",q)),H.visualViewport?.addEventListener&&(H.visualViewport.addEventListener("resize",q),L.push(()=>H.visualViewport.removeEventListener("resize",q)))}catch{}const F=()=>D();return window.addEventListener("resize",F),()=>{try{M.removeProperty("--vhfix")}catch{}window.removeEventListener("resize",F),L.forEach(H=>{try{H()}catch{}})}},[p]);const b=N.useMemo(()=>"__local_wide_fullscreen_css__",[]);return N.useEffect(()=>{if(!o)return;const M=b,D=()=>{let F=document.getElementById(M);return F||(F=document.createElement("style"),F.id=M,document.head.appendChild(F)),F},L=`
:root { --stage-padding: 0 !important; }
html, body { overflow: hidden !important; overflow-x: clip !important; }
#app, #root { min-height: calc(var(--vhfix, 1svh) * 100) !important; height: calc(var(--vhfix, 1svh) * 100) !important; }
.app-shell { min-height: calc(var(--vhfix, 1svh) * 100) !important; height: calc(var(--vhfix, 1svh) * 100) !important; overflow: hidden !important; }
.app-stage { padding: 0 !important; height: 100% !important; overflow: hidden !important; min-height: 0 !important; }
.workspace { height: 100% !important; min-height: 0 !important; overflow: hidden !important; }
.workspace__stage { overflow-y: auto !important; overflow-x: clip !important; }

.st-phone-wrap { width: 100vw !important; height: 100svh !important; }
.phone {
  position: fixed !important;
  inset: 0 !important;
  width: 100vw !important;
  height: 100svh !important;
  border: none !important;
  border-radius: 0 !important;
  box-shadow: none !important;
  background: #0f0f10 !important;
  z-index: 2147483646 !important;
}

body:has(#<id>) { overflow-x: clip !important; }

.screen {
  position: absolute !important;
  inset: 0 !important;
  border-radius: 0 !important;
  padding: 0 !important;
}

.pane.chat-pane { display: flex !important; flex-direction: column !important; }
.msgs { flex: 1 1 auto !important; max-height: none !important; }

${a}
`.trim();if(p){const F=D();F&&(F.textContent=L)}else{const F=document.getElementById(M);F?.parentNode?.removeChild(F)}return()=>{const F=document.getElementById(M);F?.parentNode?.removeChild(F)}},[p,o,a,b]),p?h.jsx(Op.Provider,{value:{isWide:p,enter:g,exit:y},children:h.jsx("div",{className:r,style:n,children:u})}):h.jsxs("div",{className:r,style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"12px",...n},children:[h.jsx("button",{type:"button",onClick:I,disabled:!v,style:{padding:"10px 14px",fontSize:14,lineHeight:1,borderRadius:10,border:"1px solid #2a3339",background:v?"linear-gradient(180deg,#4f46e5,#2563eb)":"#6b7280",color:"#fff",cursor:v?"pointer":"not-allowed",opacity:v?1:.6,minWidth:140},children:s}),h.jsx("div",{style:{marginTop:10,minWidth:220,fontSize:12,lineHeight:1.4,padding:"8px 10px",borderRadius:8,border:"1px solid #2a3339",background:"#0b0f14",color:E?"#ef4444":"#cbd5e1",whiteSpace:"nowrap",textAlign:"center"},children:E?`EEE{E}`:v?`EEE{S}%`:`EEE{S}%`})]})};function o1({targetRef:r}){const{backgroundKey:n,surfaceOpacity:s}=ps(),o=Pp(n),a=o?"image":"pattern";return h.jsx(aw,{targetRef:r,mode:a,imageUrl:o,surfaceOpacity:s})}function a1({activeTab:r,setActiveTab:n,bgRef:s}){const{layoutVariant:o}=si(),{mobileLayoutStyle:a}=ps(),u=o!=="desktop";return h.jsxs(h.Fragment,{children:[h.jsx(ow,{backgroundRef:s,topBar:f=>h.jsx(nw,{activeTab:r,onTabChange:n,scrollContainerRef:f}),leftPanel:u?null:h.jsx("div",{className:"relative",children:h.jsx(fh,{})}),centerArea:h.jsx(hx,{typingSpeed:25,onComplete:()=>{console.log("EE")}}),rightPanel:u?null:h.jsx(ph,{})}),o==="mobile-drawer"&&a==="style1"&&h.jsx(rw,{})]})}function l1(){const[r,n]=N.useState(null),[s,o]=N.useState(null),[a,u]=N.useState(null);if(N.useEffect(()=>{let w=!1;const S=()=>{try{const C=window.TavernHelper?.getCharData?.("current",!1)?.data?.character_version;!w&&C&&n(C)}catch(E){console.warn("[VersionBadge] Failed to read version from TavernHelper",E)}},k=async()=>{let E=null;try{const C=new URL(as,window.location.href);E=new URL("version.json",C).toString()}catch(C){console.warn("[VersionBadge] Invalid assetPackUrl, skip version.json",C);return}try{const C=await fetch(E,{cache:"no-cache"});if(!C.ok)return;const I=await C.json();if(w)return;const b=typeof I.version=="string"&&I.version.trim().length>0?I.version.trim():null,M=typeof I.url=="string"&&I.url.trim().length>0?I.url:null;o(b),u(M)}catch(C){console.warn("[VersionBadge] Failed to load version.json",C)}};return S(),k(),()=>{w=!0}},[]),!r)return null;const f=!!(s&&s!==r),c=f&&s?`${r} -> ${s}`:r,p=f&&!!a,g=f?"text-red-500 font-semibold":"text-gray-400",y=()=>{p&&a&&window.open(a,"_blank","noopener,noreferrer")},v=w=>{p&&(w.key==="Enter"||w.key===" ")&&(w.preventDefault(),y())};return h.jsx("div",{className:"fixed bottom-3 right-3 z-40",children:h.jsx("div",{className:`text-[10px] leading-tight ${g} ${p?"cursor-pointer underline decoration-dashed hover:text-red-600":""}`,onClick:p?y:void 0,onKeyDown:p?v:void 0,role:p?"button":void 0,tabIndex:p?0:void 0,children:c})})}function c1(){fw();const[r,n]=N.useState("story"),s=N.useRef(null);return h.jsx(hh,{defaultTheme:"light",storageKey:"kawaii-game-ui-theme",children:h.jsx(j0,{children:h.jsxs(P0,{children:[h.jsx(o1,{targetRef:s}),h.jsx(a1,{activeTab:r,setActiveTab:n,bgRef:s}),h.jsx(l1,{})]})})})}function u1(){return h.jsx(i1,{hideSelectors:["#form_sheld",".ch_name.flex-container.justifySpaceBetween",".mesAvatarWrapper"],extraCSS:"",enterLabel:"EE,children:h.jsx(c1,{})})}await gp;function d1(){const r=document.getElementById("app")||document.getElementById("root");if(r)return r;const n=document.createElement("div");return n.id="app",(document.body||document.documentElement).appendChild(n),n}const f1=d1();Pg.createRoot(f1).render(h.jsx(hh,{defaultTheme:"light",storageKey:"kawaii-game-ui-theme",children:h.jsx(f0,{children:h.jsx(u1,{})})}));const p1=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));await gp;await wg(()=>Promise.resolve().then(()=>p1),void 0,import.meta.url);</script>
  <style rel="stylesheet" crossorigin>@import"https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=ZCOOL+QingKe+HuangYou&display=swap";.display-settings-overlay{position:fixed;inset:0;z-index:60;display:flex;align-items:center;justify-content:center;padding:16px}.display-settings-overlay__backdrop{position:absolute;inset:0;background-color:#2a26334d}.display-settings-card{position:relative;z-index:1;width:min(520px,calc(100vw - 32px));max-height:min(720px,calc(100vh - 48px));height:min(680px,calc(100vh - 64px));padding:18px;border:3px solid #A8D5BA;border-radius:18px;background-color:#fefefe;color:#4a4a4a;box-sizing:border-box;overflow:hidden;display:flex}.display-settings-card:before{content:"";position:absolute;inset:8px;border:2px dashed #F8BBD9;border-radius:12px;pointer-events:none}.display-settings-card__inner{position:relative;display:flex;flex-direction:column;gap:12px;width:100%;height:100%}.display-settings-card__header{display:flex;align-items:center;justify-content:space-between}.display-settings-card__eyebrow{font-size:12px;font-weight:700;color:#6ba888;letter-spacing:.04em}.display-settings-card__title{font-family:NaikaiFont-SemiBold,sans-serif;font-size:20px;color:#2d2d2d;letter-spacing:.01em}.display-settings-card__close{width:34px;height:34px;border-radius:10px;border:2px dashed #B4C6E7;background-color:#f6f8fc;color:#4a4a4a;font-weight:700;transition:background-color .16s ease,border-color .16s ease,transform .16s ease}.display-settings-card__close:hover{background-color:#e6eefb;border-color:#94aedc;transform:translateY(-1px)}.display-settings-card__body{display:flex;flex-direction:column;gap:10px;flex:1;overflow-y:auto;padding-right:6px;padding-bottom:6px;overscroll-behavior:contain}.display-settings-card__section{padding:10px;border:2px dashed #B4C6E7;border-radius:12px;background-color:#f6f8fce6}.display-settings-card__label{font-size:13px;font-weight:700;color:#2d2d2d;margin-bottom:8px;display:inline-flex;align-items:center;gap:8px}.display-settings-card__label:after{content:"";display:inline-block;width:52px;height:0;border-top:2px dashed #F8BBD9;transform:translateY(-1px)}.display-settings-card__choices{display:flex;flex-wrap:wrap;gap:8px}.display-settings-card__choice-btn{padding:8px 10px;border:2px solid #A8D5BA;background-color:#fffcf8f0;border-radius:10px;font-size:13px;color:#4a4a4a;transition:transform .14s ease,border-color .14s ease,background-color .14s ease}.display-settings-card__choice-btn.is-active{background-color:#a8d5ba;color:#2d2d2d;border-color:#6ba888}.display-settings-card__choice-btn:hover{transform:translateY(-2px) rotate(-1deg)}.display-settings-card__row{display:flex;align-items:center;justify-content:space-between;gap:10px}.display-settings-card__toggle{display:inline-flex;align-items:center;gap:8px;font-size:13px;font-weight:700;color:#2d2d2d}.display-settings-card__toggle input{width:18px;height:18px;accent-color:#A8D5BA;border:1px solid #6BA888;border-radius:4px}.display-settings-card__toggle-label{display:inline-block}.display-settings-card__hint{font-size:12px;color:#6b6862}.display-settings-card__segmented{display:inline-flex;align-items:stretch;border:2px solid #F8BBD9;border-radius:12px;overflow:hidden;background-color:#fffcf8e6;width:100%}.display-settings-card__segment-btn{padding:8px 10px;min-width:0;border:none;border-left:1px solid #E8EEF7;background:transparent;font-size:12px;font-weight:700;color:#2d2d2d;transition:transform .14s ease,border-color .14s ease,background-color .14s ease,color .14s ease;flex:1}.display-settings-card__segment-btn.is-active{background-color:#f8bbd9;color:#2d2d2d}.display-settings-card__segment-btn:first-child{border-left:none}.display-settings-card__segment-btn:hover{background-color:#fce8f0}.display-settings-card__gallery{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:10px}.display-settings-card__wallpaper{display:flex;flex-direction:column;gap:8px;align-items:center;padding:8px;border:2px solid #A8D5BA;border-radius:12px;background-color:#fffcf8eb;color:#2d2d2d;transition:transform .14s ease,background-color .14s ease,border-color .14s ease;cursor:pointer}.display-settings-card__wallpaper.is-active{background-color:#a8d5ba;border-color:#6ba888;color:#2d2d2d}.display-settings-card__wallpaper:hover{transform:translateY(-2px) rotate(-1deg);background-color:#f0faf4}.display-settings-card__wallpaper-thumb{width:100%;aspect-ratio:4 / 3;border:1px dashed #B4C6E7;border-radius:10px;overflow:hidden;background-color:#f6f8fc;position:relative}.display-settings-card__wallpaper-thumb img{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;display:block}.display-settings-card__wallpaper-pattern{width:100%;height:100%;background-color:#fefefe;background-image:linear-gradient(45deg,#f0f8ff 12%,transparent 0,transparent 88%,#f0f8ff 0),linear-gradient(135deg,transparent 37%,#e1f0ff 0,#e1f0ff 63%,transparent 0),linear-gradient(45deg,transparent 37%,#f0f8ff 0,#f0f8ff 63%,transparent 0);background-size:20px 20px;background-repeat:repeat}.display-settings-card__wallpaper-label{font-size:12px;font-weight:700;letter-spacing:.02em}.display-settings-card__preview{margin-top:8px;display:flex;justify-content:flex-end}.display-settings-card__preview-btn{padding:8px 12px;border:2px dashed #B4C6E7;border-radius:12px;background-color:#f6f8fc;color:#2d2d2d;font-size:13px;font-weight:800;letter-spacing:.02em;transition:background-color .14s ease,border-color .14s ease,transform .14s ease}.display-settings-card__preview-btn:hover{background-color:#e6eefb;border-color:#94aedc;transform:translateY(-2px)}.display-settings-card__preview-btn:active{background-color:#d4e1f8}.display-settings-card__external-separator{margin:14px 0 8px;border-top:2px dashed #B4C6E7;position:relative}.display-settings-card__external-separator:after{position:absolute;top:-10px;left:16px;padding:2px 8px;border-radius:10px;background-color:#fefefe;border:1px solid #E6EEFB;color:#6b6862;font-size:11px;font-weight:800;letter-spacing:.02em}.external-wallpaper{display:flex;flex-direction:column;gap:10px}.external-wallpaper__toggle{width:100%;display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border:2px dashed #A8D5BA;border-radius:12px;background-color:#fffcf8eb;color:#2d2d2d;text-align:left;transition:transform .14s ease,border-color .14s ease,background-color .14s ease}.external-wallpaper__toggle:hover{border-color:#6ba888;background-color:#f0faf4}.external-wallpaper__toggle-text{display:flex;flex-direction:column;gap:2px}.external-wallpaper__eyebrow{font-size:11px;font-weight:800;color:#6ba888;letter-spacing:.04em}.external-wallpaper__title{font-size:14px;font-weight:800;color:#2d2d2d}.external-wallpaper__link{color:#1d4ed8;text-decoration:none;border-bottom:1px dashed #1d4ed8}.external-wallpaper__meta{display:flex;align-items:center;gap:10px;font-size:12px;color:#6b6862}.external-wallpaper__counter{padding:4px 8px;border:2px solid #B4C6E7;border-radius:10px;background-color:#f6f8fce6;font-weight:700}.external-wallpaper__chevron{display:inline-block;transition:transform .14s ease}.external-wallpaper__chevron.is-open{transform:rotate(180deg)}.external-wallpaper__grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:10px}.external-wallpaper-card{border:2px dashed #B4C6E7;border-radius:12px;background-color:#f6f8fceb;padding:8px;display:flex;flex-direction:column;gap:8px;transition:transform .14s ease,border-color .14s ease,background-color .14s ease}.external-wallpaper-card.is-active{border-color:#f8bbd9;background-color:#f8bbd924}.external-wallpaper-card:hover{transform:translateY(-2px)}.external-wallpaper-card__thumb{position:relative;width:100%;aspect-ratio:4 / 3;border-radius:10px;overflow:hidden;border:2px solid #A8D5BA;background-color:#fefefe;display:flex;align-items:center;justify-content:center}.external-wallpaper-card__thumb img{width:100%;height:100%;-o-object-fit:cover;object-fit:cover}.external-wallpaper-card__placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:4px;padding:10px;text-align:center;color:#6b6862;font-size:12px}.external-wallpaper-card__placeholder-main{font-weight:800;color:#2d2d2d}.external-wallpaper-card__placeholder-sub{font-size:11px}.external-wallpaper-card__status{position:absolute;top:8px;left:8px;padding:4px 8px;border-radius:999px;border:2px dashed #B4C6E7;background-color:#fefefef2;font-size:11px;font-weight:800;color:#4a4a4a}.external-wallpaper-card__status.is-success{border-color:#a8d5ba;color:#2d2d2d}.external-wallpaper-card__status.is-loading{border-color:#f8bbd9;color:#c34a86}.external-wallpaper-card__status.is-error{border-color:#f19ca3;color:#c9485b}.external-wallpaper-card__info{display:flex;flex-direction:column;gap:6px}.external-wallpaper-card__title{font-size:13px;font-weight:800;color:#2d2d2d;display:flex;align-items:center;gap:6px}.external-wallpaper-card__active-flag{padding:2px 6px;border:2px solid #F8BBD9;border-radius:8px;background-color:#fff6fa;color:#c34a86;font-size:11px;font-weight:800}.external-wallpaper-card__error{font-size:12px;color:#c9485b;background-color:#f19ca31a;border:1px dashed #F19CA3;border-radius:8px;padding:6px}.external-wallpaper-card__actions{display:flex;flex-wrap:wrap;gap:6px}.external-wallpaper-card__primary{flex:1;min-width:0;padding:8px 10px;border:2px dashed #A8D5BA;border-radius:10px;background-color:#f0faf4;color:#2d2d2d;font-weight:800;font-size:12px;transition:transform .12s ease,background-color .12s ease,border-color .12s ease}.external-wallpaper-card__primary:hover:not(:disabled){transform:translateY(-2px);background-color:#e2f5e9}.external-wallpaper-card__primary:disabled{opacity:.7;cursor:not-allowed}.external-wallpaper-card__secondary{padding:8px 10px;border:2px dashed #B4C6E7;border-radius:10px;background-color:#f6f8fc;color:#4a4a4a;font-weight:700;font-size:12px;transition:transform .12s ease,background-color .12s ease,border-color .12s ease}.external-wallpaper-card__secondary:hover{transform:translateY(-2px);background-color:#e6eefb}.external-wallpaper-card__secondary:disabled{opacity:.7;cursor:not-allowed}.background-preview-overlay{position:fixed;inset:0;z-index:80;background-color:#2a2633;cursor:pointer;display:flex;align-items:center;justify-content:center}.background-preview-overlay__canvas{position:absolute;inset:0;background-size:cover;background-position:center;background-repeat:no-repeat;background-color:#fefefe;pointer-events:none}.background-preview-overlay__canvas--image{background-color:#2a2633}.background-preview-overlay__hint{position:absolute;bottom:24px;left:50%;transform:translate(-50%);padding:10px 16px;border:2px dashed #F8BBD9;border-radius:12px;background-color:#fefefeeb;color:#2d2d2d;font-weight:700;font-size:13px;letter-spacing:.02em;pointer-events:none}@media(max-width:640px){.display-settings-card{padding:14px}.display-settings-card__title{font-size:18px}.display-settings-card__section{padding:8px}}.shino-modal__overlay{position:fixed;inset:0;z-index:30;display:flex;align-items:center;justify-content:center;background-color:#0000001a;backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px)}.shino-modal__container{width:100%;max-width:28rem;border-radius:1.5rem;background-color:#fff;padding:1rem;box-shadow:0 25px 50px -12px #00000040}.portrait-selector-scroll{position:relative;overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;scrollbar-width:none;-ms-overflow-style:none}.portrait-selector-scroll::-webkit-scrollbar{display:none}.portrait-selector-track{background-color:#e6f4ed;overflow:hidden}.portrait-selector-thumb{background-color:#88c4a4}.portrait-collapse{transition:max-height .26s ease,opacity .22s ease,transform .22s ease;overflow:hidden}.portrait-collapse--open{max-height:1200px;opacity:1;transform:translateY(0);pointer-events:auto}.portrait-collapse--closed{max-height:0;opacity:0;transform:translateY(-6px);pointer-events:none}.main-text-actions{display:inline-flex;align-items:center;gap:10px}.main-text-action-button{width:36px;height:36px;border-radius:9999px;border:2px solid hsl(var(--primary));background-color:hsl(var(--background));color:hsl(var(--foreground));display:inline-flex;align-items:center;justify-content:center;padding:0;transition:transform .12s ease,background-color .12s ease,border-color .12s ease,color .12s ease}.main-text-action-button:hover:not(:disabled){background-color:hsl(var(--primary) / .18);border-color:hsl(var(--primary));cursor:pointer}.main-text-action-button:active:not(:disabled){transform:translateY(0)}.main-text-action-button:disabled{opacity:.55;cursor:not-allowed}.main-text-action-button:focus-visible{outline:2px solid hsl(var(--accent));outline-offset:2px}.main-text-action-button--regen{border-color:hsl(var(--accent))}.main-text-action-button--regen:hover:not(:disabled){background-color:hsl(var(--accent) / .18);border-color:hsl(var(--accent))}.main-text-action-button--regen[data-active=true]{background-color:hsl(var(--accent) / .28);color:hsl(var(--foreground))}.main-text-action-button--regen[data-active=true] .main-text-action-icon{animation:main-text-action-spin 1s linear infinite}.main-text-action-button--edit{border-color:hsl(var(--secondary))}.main-text-action-button--edit:hover:not(:disabled){background-color:hsl(var(--secondary) / .18);border-color:hsl(var(--secondary))}.main-text-action-button--edit[data-active=true]{background-color:hsl(var(--secondary) / .26);color:hsl(var(--foreground));transform:translateY(-1px) scale(1.02)}.main-text-action-button--edit[data-active=true] .main-text-action-icon{transform:rotate(15deg)}.main-text-action-icon{width:16px;height:16px;stroke:currentColor;transition:transform .12s ease}@keyframes main-text-action-spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.option-stage{width:min(960px,100%);margin:0 auto;padding:4px 0}.option-layout{display:flex;flex-direction:column;align-items:stretch;width:100%;padding:12px 6px 8px}.option-bubble-stack{position:relative;display:flex;flex-direction:column;gap:10px;align-items:center;margin:0 auto;max-width:min(360px,80vw);--halo-size: calc(100% + 36px) }.option-bubble-stack:before{content:"";position:absolute;width:var(--halo-size);aspect-ratio:1 / 1;inset:50% auto auto 50%;transform:translate(-50%,-50%) rotate(-2deg);border-radius:9999px;border:2px solid rgba(180,198,231,.6);background-color:#fff9;opacity:.75;pointer-events:none}.option-bubble-stack--active:before{border-color:#f8bbd9;border-style:dashed;animation:option-bubble-stack-spin .9s linear infinite;box-shadow:0 0 0 4px #f8bbd91f,0 0 12px #f8bbd947}.option-bubble-lines{display:flex;flex-direction:column;gap:8px}.option-bubble-line{width:100%}.option-bubble{position:relative;min-height:80px;padding:22px 28px;border:2px dashed #B4C6E7;background-color:rgb(var(--surface-rgb) / .93);color:#4a4a4a;transition:transform .18s ease;display:inline-flex;align-items:center;justify-content:center;width:auto;max-width:min(360px,80vw);box-sizing:border-box;border-radius:40px 52px 44px 9999px;border-radius:40px 52px 44px 36px;overflow:hidden;--bubble-path: path("M10% 46% C8% 26% 22% 10% 38% 12% C52% 6% 66% 10% 74% 20% C88% 18% 96% 32% 94% 50% C96% 68% 86% 84% 70% 88% C54% 94% 32% 92% 22% 84% C10% 78% 8% 64% 10% 46% Z");clip-path:var(--bubble-path)}.option-bubble--active{border-color:#f8bbd9;border-style:solid}.option-bubble--active:after{border-color:#fde1ee;border-style:solid}.option-bubble--1{transform:rotate(-2.5deg) translate(-6px)}.option-bubble--2{transform:rotate(1.2deg)}.option-bubble--3{transform:rotate(-1deg) translate(4px)}.option-bubble--floating{transform:translateY(-3px) rotate(-.5deg)}.option-bubble--locked{cursor:default}.option-bubble:after{content:"";position:absolute;inset:8px 12px 10px 10px;border:1px dashed #FCE8F0;pointer-events:none;transform:rotate(.8deg);opacity:.9;clip-path:var(--bubble-path)}.option-bubble__progress{position:absolute;inset:-2px;border-radius:inherit;clip-path:var(--bubble-path);overflow:hidden;pointer-events:none}.option-bubble__progress-fill{position:absolute;inset:0;width:0;height:100%;background-color:#f8bbd96b;transition-property:width;transition-timing-function:linear;transition-duration:.22s}.option-bubble__content{position:relative;z-index:1;width:100%;display:flex;align-items:center;justify-content:center;text-align:center}.option-bubble--editing{cursor:default;width:min(360px,80vw);max-width:min(360px,80vw)}.option-bubble--editing .option-bubble__content{width:100%}.option-bubble__input{width:100%;min-height:80px;padding:10px 12px;border:1px dashed #A8D5BA;border-radius:14px;background-color:#ffffffe6;resize:none;outline:none;font-size:16px;line-height:1.5;color:#4a4a4a;text-align:center}.option-bubble__input:focus{border-color:#7bbf9f}.option-bubble:not(.option-bubble--locked):hover{transform:translateY(-3px) rotate(-.5deg)}.option-bubble__trail{position:absolute;bottom:-26px;left:60%;transform:translate(-50%) rotate(22deg);display:flex;align-items:center;gap:4px;pointer-events:none;transition:all .3s ease}.option-bubble__trail--vertical{left:50%;bottom:-36px;transform:translate(-50%) rotate(90deg);gap:6px}@keyframes option-bubble-stack-spin{0%{transform:translate(-50%,-50%) rotate(-2deg)}to{transform:translate(-50%,-50%) rotate(-362deg)}}.option-bubble__trail-dot{width:18px;height:18px;border-radius:9999px;border:2px dashed #F8BBD9;background-color:rgb(var(--surface-rgb) / .9)}.option-bubble__trail-dot--small{width:12px;height:12px;opacity:.7}.option-bubble__trail-dot--tiny{width:7px;height:7px;opacity:.5}.option-character{display:flex;justify-content:flex-end;align-items:flex-end;margin-top:8px}.option-character__wrap{position:relative;width:min(540px,100%);-webkit-user-select:none;-moz-user-select:none;user-select:none}.option-character__tape{position:absolute;top:0;width:90px;height:18px;background-color:#fce8f0;border:2px dashed #F8BBD9;border-radius:6px;opacity:.9}.option-character__tape--left{left:12%;transform:rotate(-12deg)}.option-character__tape--right{right:10%;transform:rotate(10deg)}.option-character__img{display:block;width:100%;max-width:460px;margin:0 auto;-o-object-fit:contain;object-fit:contain;-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-user-drag:none;pointer-events:none}.option-character__underline{width:76%;height:0;border-top:3px dashed #F8BBD9;margin:10px auto 0;transform:rotate(-2deg)}.plot-bias-modal__overlay.shino-modal__overlay{background-color:#0000002e;backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px)}.plot-bias-modal.shino-modal__container{background-color:transparent;box-shadow:none;padding:0;width:min(420px,92vw)}.plot-bias-modal__panel{position:relative;width:100%;display:flex;flex-direction:column;gap:12px}.plot-bias-modal__image-wrap{position:relative;border-radius:18px;overflow:hidden;background-color:#fff}.plot-bias-modal__image{display:block;width:100%;height:auto}.plot-bias-modal__dialog{position:absolute;left:12px;right:12px;bottom:12px;padding:12px 16px 14px;background-color:#0a0a0a94;border:2px solid #F8BBD9;border-radius:14px}.plot-bias-modal__dialog-name{display:inline-flex;align-items:center;gap:6px;padding:0;color:#fde1ee;font-weight:700;font-size:16px;margin-bottom:4px}.plot-bias-modal__dialog-text{font-size:18px;color:#fff;line-height:1.6}@media(max-width:767px){.option-layout{padding:8px 4px 6px}.option-bubble-stack{max-width:calc(100% - 32px)}.option-character{justify-content:center}}@media(min-width:1024px){.option-character__wrap{margin-left:auto}}.detail-panel{position:absolute;inset:0;background-color:#05030a;border-radius:12px;overflow:hidden}.detail-panel__canvas{display:block;width:100%;height:100%;position:absolute;top:0;left:0}.detail-panel__empty{display:flex;align-items:center;justify-content:center;width:100%;height:100%;color:#f5f5ff;font-size:.9rem}.detail-panel__node-panel{position:absolute;background-color:#11081c;border:2px solid #bba8f0;border-radius:8px;padding:14px;min-width:520px;z-index:10;opacity:1;transition:opacity .12s ease-out}.detail-panel__node-panel:before{content:"";position:absolute;top:50%;width:0;height:0;border-style:solid}.detail-panel__node-panel--left{right:calc(100% + 8px);top:50%;transform:translateY(-50%)}.detail-panel__node-panel--left:before{right:-8px;border-width:8px 0 8px 8px;border-color:transparent transparent transparent #bba8f0}.detail-panel__node-panel--right{left:calc(100% + 8px);top:50%;transform:translateY(-50%)}.detail-panel__node-panel--right:before{left:-8px;border-width:8px 8px 8px 0;border-color:transparent #bba8f0 transparent transparent}.detail-panel__node-title{margin:0 0 4px;font-size:.85rem;font-weight:600;color:#f5f5ff}.detail-panel__node-stat{display:flex;align-items:center;margin:2px 0;font-size:.75rem;color:#cbc7ff}.detail-panel__node-stat-label{margin-right:8px;font-weight:500}.detail-panel__node-stat-value{color:#d7c7ff;font-weight:600}.detail-panel__node-panel-body{display:flex;gap:12px}.detail-panel__node-figure{width:240px;height:240px;border-radius:16px;background-color:#1b0f2b;border:1px dashed #d7c7ff;display:flex;align-items:center;justify-content:center;overflow:hidden}.detail-panel__node-figure-img{width:100%;height:100%;-o-object-fit:cover;object-fit:cover}.detail-panel__node-figure-initial{font-size:1.75rem;font-weight:600;color:#f5f5ff}.detail-panel__node-info{width:240px;height:240px;border-radius:16px;background-color:#180c27;border:1px dashed #bba8f0;padding:10px 12px;box-sizing:border-box;display:flex;flex-direction:column;justify-content:space-between;min-height:0}.detail-panel__node-info-title{font-size:1rem;font-weight:600;color:#f5f5ff;margin-bottom:6px}.detail-panel__node-info-desc{font-size:.85rem;line-height:1.5;color:#d7c7ff;flex:1;min-height:0;overflow-y:auto;display:block;word-break:break-word;scrollbar-width:thin;scrollbar-color:#bba8f0 #140a21}.detail-panel__node-info-desc::-webkit-scrollbar{width:6px}.detail-panel__node-info-desc::-webkit-scrollbar-track{background:#140a21;border-radius:6px}.detail-panel__node-info-desc::-webkit-scrollbar-thumb{background:#bba8f0;border-radius:6px}.detail-panel__node-info-desc::-webkit-scrollbar-thumb:hover{background:#d7c7ff}.diary-notebook{--paper-top: #fefcea;--paper-bottom: #dbeDEF;--border-outer: #aacfe0;--border-strong: #679197;--line-color: #a2c6cd;--binding-plate: #e1f0f7;--binding-inner: #c7dfef;--ring-fill: #fdfbf2;--ring-border: #8fbad4;--icon-blue: #9fcae5;--icon-blue-deep: #7baed4;position:relative;width:100%;max-width:640px;height:100%;max-height:480px;display:flex;align-items:center;justify-content:center}.diary-stack{position:relative;width:100%;height:100%}.diary-page-layer{position:absolute;inset:18px 26px 22px 22px;border-radius:0;border:1px solid rgba(170,207,224,.8);background:#f7fafc}.diary-page-layer--back{transform:translate(8px,8px);background:#edf2f7}.diary-page-layer--mid{transform:translate(4px,4px)}.diary-page{position:relative;position:absolute;inset:14px 22px 18px 18px;border-radius:0;border:1px solid var(--border-outer);background:#fefcea;overflow:hidden}.diary-page-inner{position:relative;width:100%;height:100%;padding:32px 48px 40px 72px}.diary-writing-area{position:absolute;inset:90px 44px 82px 60px;overflow:hidden}.diary-text{position:absolute;inset:0;padding:6px 4px 0 0;font-size:14px;line-height:1.9;color:#4a4a4a;white-space:pre-wrap}.diary-text:before{content:"";position:absolute;inset:0;pointer-events:none;background-image:linear-gradient(to bottom,transparent calc(1.9em - 1px),var(--line-color) calc(1.9em - 1px));background-size:100% 1.9em;background-repeat:repeat-y;-webkit-mask-image:repeating-linear-gradient(to right,#000 0,#000 6px,transparent 6px,transparent 12px);mask-image:repeating-linear-gradient(to right,#000 0,#000 6px,transparent 6px,transparent 12px)}.diary-pagination{position:absolute;left:0;right:0;bottom:36px;display:flex;align-items:center;justify-content:center;gap:12px;font-size:12px;color:#4a4a4a}.diary-page-arrow{width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:9999px;border:2px solid var(--border-strong);background:#ffffffd9;padding:0;font-size:14px;line-height:1;cursor:pointer}.diary-page-arrow:disabled{border-color:#67919766;color:#67919766;cursor:default;background:#fff9}.diary-page-arrow:not(:disabled):hover{background:#eef6fa}.diary-page-indicator{padding:2px 10px;border-radius:9999px;border:2px dashed var(--border-strong);background:#ffffffe6}.diary-binding{position:absolute;top:70px;bottom:80px;left:26px;width:92px}.diary-binding-plate{position:absolute;inset:10px 26px 10px 0;border-radius:26px;background:#f8fbff;box-shadow:inset -6px 0 #bbd4e2b3}.diary-binding-inner{position:absolute;inset:0 12px 0 26px;border-radius:26px;background:linear-gradient(to bottom,var(--binding-inner),#b9d5eb);border:4px solid var(--border-outer)}.diary-rings{position:absolute;inset:26px 8px;display:flex;flex-direction:column;align-items:center;justify-content:space-between}.diary-ring{position:relative;width:38px;height:38px;border-radius:9999px;border:4px solid var(--ring-border);background:var(--ring-fill);box-shadow:0 2px #ffffffb3}.diary-ring:before{content:"";position:absolute;left:-10px;top:9px;bottom:9px;width:22px;border-radius:20px 0 0 20px;background:transparent;box-shadow:10px 0 0 var(--ring-fill)}.diary-ring:after{content:"";position:absolute;right:5px;top:6px;bottom:6px;width:4px;border-radius:9999px;background:#ffffffb3}.diary-line{width:100%;border-bottom:2px dashed var(--line-color);opacity:.95}.diary-icon-windchime{position:absolute;top:8px;left:12px;display:flex;flex-direction:column;align-items:center;gap:3px}.diary-wc-top{position:relative;width:34px;height:22px;border-radius:18px 18px 10px 10px;border:2px solid var(--icon-blue);background:#fdfdfd;box-sizing:border-box;transform:rotate(-2deg)}.diary-wc-top:before{content:"";position:absolute;inset:5px 6px 7px;border-radius:9999px 9999px 8px 8px;border:1px dashed rgba(159,202,229,.8)}.diary-wc-top:after{content:"";position:absolute;left:50%;top:-4px;width:6px;height:6px;border-radius:9999px;border:2px solid var(--icon-blue);background:#fff;transform:translate(-50%)}.diary-wc-string{position:relative;width:2px;height:26px;background:var(--icon-blue);transform:translateY(-2px)}.diary-wc-string:before{content:"";position:absolute;left:-4px;top:7px;width:8px;height:8px;border-radius:9999px;border:2px solid var(--icon-blue);background:#fefefe}.diary-wc-tag{position:relative;width:18px;height:32px;border-radius:4px;border:2px solid #cfdfe9;background:#fff7e6;box-sizing:border-box;transform:rotate(2deg)}.diary-wc-tag:before{content:"";position:absolute;left:50%;top:4px;width:4px;height:4px;border-radius:9999px;border:2px solid #e1c8a3;background:#fff7e6;transform:translate(-50%)}.diary-wc-tag:after{content:"";position:absolute;left:4px;right:4px;bottom:4px;height:2px;border-radius:9999px;background:#d1b68ab3}.diary-icon-icepop{position:absolute;top:6px;right:28px;display:flex;flex-direction:column;align-items:center;gap:3px}.diary-ice-body{position:relative;width:30px;height:58px;border-radius:12px;border:2px solid var(--icon-blue-deep);background:#e8f3fb;box-sizing:border-box;overflow:hidden}.diary-ice-stick{width:8px;height:16px;border-radius:4px;background:#f1d09b}.diary-ice-body:before{content:"";position:absolute;inset:10px 4px;border-radius:8px;border:2px dashed rgba(123,174,212,.7)}.diary-ice-body:after{content:"";position:absolute;right:-6px;top:-4px;width:18px;height:18px;border-radius:9999px;background:var(--paper-top)}.diary-icon-crab{position:absolute;left:36px;bottom:16px;width:42px;height:20px}.diary-crab-body{position:absolute;left:6px;right:6px;bottom:0;height:14px;border-radius:14px 14px 10px 10px;background:var(--icon-blue);box-shadow:0 1px #ffffff80}.diary-crab-body:before,.diary-crab-body:after{content:"";position:absolute;top:-6px;width:12px;height:12px;border-radius:12px 12px 2px 2px;border:2px solid var(--icon-blue);border-bottom:none;background:var(--paper-bottom)}.diary-crab-body:before{left:-4px;transform:rotate(-18deg)}.diary-crab-body:after{right:-4px;transform:rotate(18deg)}.diary-icon-fishes{position:absolute;right:36px;bottom:20px;display:flex;gap:10px}.diary-fish{position:relative;display:inline-block;width:24px;height:10px;border-radius:9999px;background:var(--icon-blue)}.diary-fish:after{content:"";position:absolute;right:-8px;top:2px;width:10px;height:6px;background:var(--icon-blue);clip-path:polygon(0 50%,100% 0,100% 100%)}.diary-fish-sm{transform:scale(.9);opacity:.9}.diary-fish-xs{transform:scale(.8);opacity:.85}.sticky-note-root{--sticky-border: #f3c78c;--sticky-bg-top: #fff9e9;--sticky-bg-bottom: #ffe2ae;--sticky-shadow-soft: rgba(196, 156, 103, .55);--sticky-shadow-hard: rgba(0, 0, 0, .18);--sticky-tape: #f8f1da;--sticky-tape-edge: #e0d2ae;--sticky-bg-main: var(--sticky-bg-top);--sticky-bg-layer: var(--sticky-bg-bottom);--sticky-tilt: -1.5deg;--sticky-breeze-delay: 2s;--sticky-breeze-duration: 7s}.sticky-note-root:nth-child(2){--sticky-tilt: -.2deg;--sticky-breeze-delay: 1s}.sticky-note--sakura{--sticky-border: #f5b9d2;--sticky-bg-top: #fff6fb;--sticky-bg-bottom: #ffdfe9;--sticky-shadow-soft: rgba(236, 180, 203, .55);--sticky-bg-main: var(--sticky-bg-top);--sticky-bg-layer: var(--sticky-bg-bottom)}.sticky-note--matcha{--sticky-border: #b7dba9;--sticky-bg-top: #f7fff4;--sticky-bg-bottom: #d8f3c8;--sticky-shadow-soft: rgba(171, 201, 150, .5);--sticky-bg-main: var(--sticky-bg-top);--sticky-bg-layer: var(--sticky-bg-bottom)}.sticky-note--mist{--sticky-border: #aecde8;--sticky-bg-top: #f6fbff;--sticky-bg-bottom: #d8e7f7;--sticky-shadow-soft: rgba(151, 182, 211, .5);--sticky-bg-main: var(--sticky-bg-top);--sticky-bg-layer: var(--sticky-bg-bottom)}.sticky-note--lavender{--sticky-border: #c7b4eb;--sticky-bg-top: #faf6ff;--sticky-bg-bottom: #e1d5ff;--sticky-shadow-soft: rgba(180, 159, 221, .5);--sticky-bg-main: var(--sticky-bg-top);--sticky-bg-layer: var(--sticky-bg-bottom)}.sticky-note-container{position:relative;width:260px;height:260px;perspective:1200px}.sticky-note-layer{position:absolute;inset:0;background:var(--sticky-bg-layer);border-radius:0;z-index:0}.sticky-note-layer--back{transform:translateY(10px) scale(.97);opacity:.9}.sticky-note-layer--mid{transform:translateY(5px) scale(.985);opacity:.96;z-index:0}.sticky-note-paper{position:absolute;inset:0;border-radius:0;border:none;background:transparent;transform-origin:center center;transform:rotate(var(--sticky-tilt));z-index:1;overflow:visible;box-shadow:0 8px 16px var(--sticky-shadow-soft),0 2px 0 var(--sticky-shadow-hard)}.sticky-note-sheet{position:absolute;inset:0;border-radius:0;background:var(--sticky-bg-main);transform-origin:top center;transform-style:preserve-3d;transition:transform .45s ease-out,filter .45s ease-out,opacity .45s ease-out}.sticky-note-sheet--depth-0{z-index:5;transform:rotateX(8deg) translateY(0);filter:brightness(1)}.sticky-note-sheet--depth-1{z-index:4;transform:rotateX(6deg) translateY(4px);filter:brightness(.97)}.sticky-note-sheet--depth-2{z-index:3;transform:rotateX(5deg) translateY(8px);filter:brightness(.94)}.sticky-note-sheet--depth-3{z-index:2;transform:rotateX(4deg) translateY(12px);filter:brightness(.92)}.sticky-note-sheet--depth-4{z-index:1;transform:rotateX(3deg) translateY(16px);filter:brightness(.9)}.sticky-note-sheet--top-idle{cursor:pointer;animation:sticky-note-breeze var(--sticky-breeze-duration) ease-in-out infinite;animation-delay:var(--sticky-breeze-delay)}.sticky-note-sheet--top-final{cursor:default}.sticky-note-sheet--tearing{animation:sticky-note-tear .6s ease-out forwards;pointer-events:none}.sticky-note-sheet--tearing .sticky-note-curl{opacity:.98;animation:sticky-note-tear-curl .6s ease-out forwards}.sticky-note-curl{position:absolute;left:0;right:0;bottom:-10px;height:24px;background:var(--sticky-bg-main);clip-path:polygon(0 0,100% 0,100% 60%,50% 100%,0 60%);opacity:0;pointer-events:none;transform-origin:center top;transition:transform .45s ease-out,opacity .45s ease-out}.sticky-note-sheet--depth-0 .sticky-note-curl{transform:translateY(-2px) scaleY(1.12)}.sticky-note-sheet--depth-1 .sticky-note-curl{transform:translateY(-1px) scaleY(1.08)}.sticky-note-sheet--depth-2 .sticky-note-curl{transform:translateY(0) scaleY(1.05)}.sticky-note-sheet--depth-3 .sticky-note-curl{transform:translateY(1px) scaleY(1.03)}.sticky-note-sheet--depth-4 .sticky-note-curl{transform:translateY(2px) scaleY(1.01)}.sticky-note-sheet--top-idle .sticky-note-curl,.sticky-note-sheet--top-final .sticky-note-curl{opacity:.98}.sticky-note-sheet--next-reveal .sticky-note-curl{opacity:.96}.sticky-note-curl:after{content:"";position:absolute;left:10%;right:10%;bottom:-8px;height:18px;border-radius:999px;background:#0003;opacity:.22;filter:blur(6px)}@keyframes sticky-note-breeze{0%{transform:rotateX(8deg) translateY(0)}30%{transform:rotateX(16deg) translateY(-3px)}60%{transform:rotateX(10deg) translateY(-1px)}to{transform:rotateX(8deg) translateY(0)}}@keyframes sticky-note-tear{0%{transform:rotateX(8deg) translateY(0);opacity:1}40%{transform:rotateX(26deg) translateY(4px);opacity:1}to{transform:rotateX(82deg) translateY(56px);opacity:0}}@keyframes sticky-note-tear-curl{0%{transform:translateY(-2px) scaleY(1.12)}40%{transform:translateY(-6px) scaleY(1.18)}to{transform:translateY(10px) scaleY(.9)}}.sticky-note-inner{position:relative;width:100%;height:100%}.sticky-note-inner.paper-noise:before{opacity:.22;background-image:var(--paper-texture),radial-gradient(circle at 12px 8px,rgba(0,0,0,.06) 1px,transparent 1px),linear-gradient(to bottom,#fff6,#00000008),linear-gradient(120deg,rgba(255,255,255,.25) 0%,transparent 40%,rgba(0,0,0,.04) 100%)!important;background-size:auto,14px 14px,100% 100%,100% 100%;mix-blend-mode:multiply}.sticky-note-tape{position:absolute;top:-14px;width:68px;height:28px;background:var(--sticky-tape);border-radius:6px;opacity:.95;z-index:2}.sticky-note-tape:before,.sticky-note-tape:after{content:"";position:absolute;left:0;right:0;bottom:-3px;height:3px;background-image:repeating-linear-gradient(90deg,transparent 0,transparent 4px,var(--sticky-tape-edge) 4px,var(--sticky-tape-edge) 6px)}.sticky-note-tape-left{left:54px;transform:rotate(-5deg)}.sticky-note-tape-right{right:54px;transform:rotate(4deg)}.sticky-note-title{letter-spacing:.08em}.sticky-note-content{text-align:left}.top-panel-overlay{position:fixed;inset:0;z-index:60;display:flex;align-items:center;justify-content:center;background-color:transparent;opacity:0;pointer-events:none;transition:background-color .18s ease-out,opacity .18s ease-out}.top-panel-overlay--visible{background-color:#0000003d;opacity:1;pointer-events:auto}.top-panel{position:relative;border-radius:16px;border:3px solid #f8bbd9;background-color:#fefefe;transform:translateY(8px) scale(.96);opacity:0;transition:transform .22s ease-out,opacity .22s ease-out;display:flex;flex-direction:column;overflow:hidden}.top-panel:before{content:"";position:absolute;inset:6px;border-radius:12px;border:1px dashed #fce8f0;pointer-events:none}.top-panel--visible{transform:translateY(0) scale(1);opacity:1}.top-panel--desktop{width:min(880px,calc(100vw - 96px));height:min(60vh,640px)}.top-panel--mobile{width:calc(100vw - 16px);height:80vh}.top-panel--sakura{border-color:#f8bbd9}.top-panel--matcha{border-color:#a8d5ba}.top-panel--mist{border-color:#b4c6e7}.top-panel--lavender{border-color:#c4b5fd}.top-panel__content{position:relative;z-index:1;width:100%;height:100%;box-sizing:border-box;overflow-y:auto}.top-panel__title{margin:0 0 12px;font-family:var(--font-title, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif);font-size:1.25rem;color:#4a4a4a}.top-panel__description{margin:0;font-size:.9rem;line-height:1.6;color:#696969}.save-panel-layout{display:flex;align-items:stretch;gap:24px;height:100%}.save-panel-main{flex:1 1 0;min-width:0;display:flex}.save-panel-main>*{flex:1 1 auto}.save-panel-notes{flex:0 0 30%;min-width:200px;max-width:320px;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:24px;padding:0 12px 24px}.save-panel-income-note{position:relative;display:inline-block}.save-panel-income-note-svg{position:absolute;inset:0;width:100%;height:100%;z-index:1;pointer-events:none}@media(max-width:768px){.save-panel-layout{flex-direction:column}.save-panel-notes{flex:0 0 auto;flex-direction:row;justify-content:center;align-items:flex-start;gap:16px}}.society-panel{display:flex;flex-direction:column;height:100%}.society-panel__header{margin-bottom:16px}.society-panel__map-shell{flex:1;display:flex;align-items:stretch;justify-content:center;overflow:hidden}.society-panel__map-frame{position:relative;width:100%;height:100%;border-radius:14px;box-sizing:border-box;overflow:hidden}.society-panel__map-frame:before{content:"";position:absolute;inset:6px;border-radius:10px;border:1px dashed #fce8f0;pointer-events:none}.society-panel__canvas{position:relative;z-index:0;width:100%;height:100%;display:block;border-radius:10px;background-color:#f7ebdc}.society-panel__active-region{display:inline-flex;align-items:center;margin-left:8px;padding:2px 10px;border-radius:999px;border:1px dashed #a8d5ba;background-color:#fefefe;color:#4a4a4a;font-size:.8rem}.society-panel__region-popup{position:absolute;z-index:2;min-width:240px;max-width:320px}.society-panel__region-popup-svg{position:absolute;inset:0;width:100%;height:100%;pointer-events:none}.society-panel__region-popup-inner{position:relative;z-index:1;box-sizing:border-box;padding:12px 14px 14px}.society-panel__region-popup-header{display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:8px}.society-panel__region-popup-title{display:inline-flex;align-items:center;gap:6px;font-weight:600;font-size:.95rem;color:#4a4a4a}.society-panel__region-popup-icon{font-size:1.1rem}.society-panel__region-popup-name{letter-spacing:.08em}.society-panel__region-popup-close{border:1px dashed #f4a6a6;border-radius:999px;background-color:#fff5f7;color:#4a4a4a;font-size:.8rem;padding:2px 8px}.society-panel__region-popup-close:hover{background-color:#f8bbd9}.society-panel__region-popup-section{margin-bottom:8px}.society-panel__region-popup-label{font-size:.75rem;color:#888;margin-bottom:2px}.society-panel__region-popup-text{font-size:.8rem;line-height:1.5;color:#4a4a4a}.society-panel__region-popup-metrics{display:flex;align-items:center;justify-content:flex-start;gap:8px;margin-bottom:8px}.society-panel__region-popup-metric{display:inline-flex;align-items:center;gap:4px;padding:2px 8px;border-radius:999px;border:1px dashed #b4c6e7;background-color:#f7fbff;white-space:nowrap}.society-panel__region-popup-stars{display:inline-block;width:80px;height:18px}.society-panel__region-popup-star-svg{display:block;width:100%;height:100%}.society-panel__region-popup-star{color:#e5e5e5}.society-panel__region-popup-star--filled{color:#f8bbd9}.society-panel__region-popup-comments{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:4px}.society-panel__region-popup-comment{position:relative;padding-left:12px;font-size:.78rem;line-height:1.4;color:#4a4a4a}.society-panel__region-popup-comment:before{content:"";position:absolute;left:2px;top:0}@media(max-width:768px){.society-panel__map-frame{max-width:100%}}.timeline-panel__canvas{position:relative;overflow:hidden;padding:16px 16px 32px;width:100%;height:100%;box-sizing:border-box;border-radius:14px;border:2px solid #f8bbd9;background-color:#fefefe;cursor:grab;touch-action:none;overscroll-behavior:contain}.timeline-panel__canvas:before{content:"";position:absolute;inset:6px;border-radius:10px;border:1px dashed #fce8f0;pointer-events:none}.timeline-panel__canvas[data-panning=true]{cursor:grabbing}.timeline-panel__hint{position:sticky;top:4px;left:4px;align-self:flex-start;padding:4px 10px;font-size:11px;color:#888;background-color:#fff7fb;border-radius:999px;border:1px dashed #f8bbd9;width:-moz-max-content;width:max-content;max-width:60ch;z-index:10}.timeline-plane{position:relative;min-width:200%;min-height:200%;background-color:#fff;background-image:linear-gradient(rgba(0,0,0,.02) 1px,transparent 1px),linear-gradient(90deg,rgba(0,0,0,.02) 1px,transparent 1px),linear-gradient(rgba(0,0,0,.05) 2px,transparent 2px),linear-gradient(90deg,rgba(0,0,0,.02) 2px,transparent 2px);background-size:20px 20px,20px 20px,100px 100px,100px 100px}.timeline-edges{position:absolute;inset:0;pointer-events:none;width:100%;height:100%;z-index:1}.timeline-edge{fill:none;stroke-linecap:round}.timeline-edge--shadow{stroke:#fce4f2;stroke-width:4px;opacity:.8}.timeline-edge--main{stroke:#f8bbd9;stroke-width:2px}.timeline-node{position:absolute;min-width:180px;max-width:240px;min-height:80px;padding:28px 24px 14px 14px;border-radius:12px;border:2px solid #f8bbd9;background-color:#fff7fb;color:#4a4a4a;box-sizing:border-box;cursor:pointer;transition:transform .12s ease-out,background-color .12s ease-out,border-color .12s ease-out}.timeline-node[data-selected=true]{transform:translateY(-2px);border-color:#b4c6e7;background-color:#f7f9ff}.timeline-node[data-current=true]:after{content:"";position:absolute;bottom:-8px;right:10px;padding:0 6px;font-size:10px;letter-spacing:.08em;color:#b4587b;background-color:#ffeaf3;border-radius:999px;border:1px solid #f8bbd9}.timeline-node[data-current=true]{border-color:#f8bbd9;background-color:#fffbfe}.timeline-node[data-locked=true]{opacity:.6;background-color:#f7f7f7}.timeline-node__id{position:absolute;top:6px;left:6px;padding:2px 6px;font-size:11px;font-weight:600;color:#888;background-color:#fffefe;border-radius:999px;border:1px dashed #e5e5e5}.timeline-node__menu-group{position:absolute;top:4px;right:4px;display:flex;align-items:center;gap:4px;padding:2px;border-radius:999px;background-color:transparent}.timeline-node__menu-group[data-open=true]{background-color:#fff3f8;border-radius:999px}.timeline-node__menu-btn,.timeline-node__menu-action{width:24px;height:24px;display:grid;place-items:center;border-radius:999px;border:1px dashed transparent;background-color:transparent;padding:0;font-size:14px;line-height:1;color:#888}.timeline-node__menu-btn:hover,.timeline-node__menu-action:hover:not(:disabled){border-color:#f8bbd9;background-color:#ffeaf3}.timeline-node__menu-action:disabled{opacity:.5}.timeline-node__title{display:flex;align-items:center;justify-content:center;text-align:center;height:100%;width:100%;box-sizing:border-box;padding:2px 8px 8px}.timeline-node__title-text{white-space:normal;word-break:break-word;line-height:1.2;font-weight:600;font-size:14px;color:#4a4a4a}.timeline-dialog-backdrop{position:fixed;inset:0;z-index:80;display:flex;align-items:center;justify-content:center;background-color:#fff9}.timeline-dialog{width:min(320px,90vw);border-radius:18px;border:2px solid #f8bbd9;background-color:#fefefe;padding:12px 14px 10px}.timeline-dialog__header{display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:6px}.timeline-dialog__tag{padding:2px 8px;border-radius:999px;border:1px dashed #f8bbd9;font-size:11px;color:#b4587b;background-color:#fff3f8}.timeline-dialog__title{font-size:.9rem;font-weight:600;color:#4a4a4a}.timeline-dialog__body{font-size:.8rem;line-height:1.5;color:#696969;padding:6px 2px 8px}.timeline-dialog__footer{display:flex;justify-content:flex-end;gap:8px;margin-top:4px}.timeline-dialog__btn{min-width:72px;padding:4px 10px;border-radius:999px;border:1px dashed transparent;font-size:.8rem}.timeline-dialog__btn--ghost{border-color:#e5e5e5;background-color:#fff;color:#696969}.timeline-dialog__btn--ghost:hover{border-color:#b4c6e7;background-color:#f7fbff}.timeline-dialog__btn--primary{border-color:#f8bbd9;background-color:#f8bbd9;color:#4a4a4a}.timeline-dialog__btn--primary:hover{background-color:#f59ec8;border-color:#f59ec8}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: ""}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:Source Code Pro,Consolas,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}:root{--surface-rgb: 255 255 255;--surface-opacity: .7}.dark{--surface-rgb: 0 0 0;--surface-opacity: .7}:root{--radius: .5rem;--background: 0 0% 99.6%;--foreground: 0 0% 29%;--card: 0 0% 99.6%;--card-foreground: 0 0% 29%;--popover: 0 0% 99.6%;--popover-foreground: 0 0% 29%;--primary: 320 45% 88%;--primary-foreground: 0 0% 18%;--secondary: 145 32% 77%;--secondary-foreground: 0 0% 18%;--muted: 30 20% 95%;--muted-foreground: 30 10% 60%;--accent: 200 32% 83%;--accent-foreground: 0 0% 18%;--destructive: 0 84% 75%;--destructive-foreground: 0 0% 98%;--border: 30 8% 83%;--input: 30 8% 83%;--ring: 320 45% 88%;--paper-texture: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='4' viewBox='0 0 4 4'%3E%3Cpath fill='%23D4D2CE' fill-opacity='0.12' d='M1 3h1v1H1V3zm2-2h1v1H3V1z'%3E%3C/path%3E%3C/svg%3E");--dashed-outer: 3px dashed #F8BBD9;--dashed-inner: 1px dashed #FCE8F0;--solid-accent: 2px solid #A8D5BA}.dark{--background: 30 10% 16%;--foreground: 30 15% 95%;--card: 30 10% 20%;--card-foreground: 30 15% 95%;--popover: 30 10% 20%;--popover-foreground: 30 15% 95%;--primary: 320 45% 75%;--primary-foreground: 0 0% 18%;--secondary: 145 32% 70%;--secondary-foreground: 0 0% 18%;--muted: 30 5% 25%;--muted-foreground: 30 5% 70%;--accent: 200 32% 75%;--accent-foreground: 0 0% 18%;--destructive: 0 84% 60%;--destructive-foreground: 0 0% 98%;--border: 30 5% 25%;--input: 30 5% 25%;--ring: 320 45% 75%;--paper-texture: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='4' viewBox='0 0 4 4'%3E%3Cpath fill='%23D4D2CE' fill-opacity='0.08' d='M1 3h1v1H1V3zm2-2h1v1H3V1z'%3E%3C/path%3E%3C/svg%3E");--dashed-outer: 3px dashed #BBA8F0;--dashed-inner: 1px dashed #BBA8F0;--solid-accent: 2px solid #8BC9B4}html,body{height:100%;overscroll-behavior-x:none;overscroll-behavior-y:none}*{border-color:hsl(var(--border))}body{--tw-bg-opacity: 1;background-color:rgb(254 254 254 / var(--tw-bg-opacity, 1));font-family:NaikaiFont-SemiBold,Source Han Sans CN,Noto Sans CJK SC,PingFang SC,sans-serif;--tw-text-opacity: 1;color:rgb(74 74 74 / var(--tw-text-opacity, 1));background-image:var(--paper-texture);background-attachment:fixed;min-height:100vh}*::-webkit-scrollbar{width:8px;height:8px}*::-webkit-scrollbar-button{display:none;width:0;height:0}*::-webkit-scrollbar-track{background:transparent;border-radius:999px}*::-webkit-scrollbar-corner{background:transparent}*::-webkit-scrollbar-thumb{background-color:#f49ac2;border-radius:999px;border:2px solid transparent;background-clip:padding-box}*::-webkit-scrollbar-thumb:hover{background-color:#e8739d}*::-webkit-scrollbar-thumb:active{background-color:#c8517d}.\!container{width:100%!important;margin-right:auto!important;margin-left:auto!important;padding-right:2rem!important;padding-left:2rem!important}.container{width:100%;margin-right:auto;margin-left:auto;padding-right:2rem;padding-left:2rem}@media(min-width:1400px){.\!container{max-width:1400px!important}.container{max-width:1400px}}.paper-texture{background-image:var(--paper-texture);background-attachment:fixed}.paper-noise{position:relative}.paper-noise:before{content:"";position:absolute;inset:0;pointer-events:none;opacity:.18;background-image:var(--paper-texture),radial-gradient(circle at 12px 8px,rgba(0,0,0,.06) 1px,transparent 1px)!important;background-size:auto,14px 14px;mix-blend-mode:multiply}.tab-sakura.active{--tw-bg-opacity: 1;background-color:rgb(254 246 249 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(232 115 157 / var(--tw-text-opacity, 1));border-width:3px;border-style:solid;border-color:#f49ac2;transform:translateY(-4px)}.tab-matcha.active{--tw-bg-opacity: 1;background-color:rgb(245 250 247 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(107 168 136 / var(--tw-text-opacity, 1));border-width:3px;border-style:solid;border-color:#88c4a4;transform:translateY(-4px)}.tab-mist.active{--tw-bg-opacity: 1;background-color:rgb(246 248 252 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(114 149 196 / var(--tw-text-opacity, 1));border-width:3px;border-style:solid;border-color:#93aed9;transform:translateY(-4px)}.tab-lavender.active{--tw-bg-opacity: 1;background-color:rgb(249 247 253 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(158 135 217 / var(--tw-text-opacity, 1));border-width:3px;border-style:solid;border-color:#bba8f0;transform:translateY(-4px)}.wooden-sign{--tw-text-opacity: 1;color:rgb(74 74 74 / var(--tw-text-opacity, 1));border-radius:20px;width:180px;height:auto;min-height:64px;position:relative;background-image:var(--paper-texture);background-attachment:fixed}.wooden-sign:before{content:"";position:absolute;top:12px;left:12px;right:12px;height:6px;background:#6ba888;border-radius:3px}.wooden-sign:after{content:"";position:absolute;top:12px;left:12px;right:12px;height:6px;background:#6ba888;border-radius:3px}.traffic-light{width:36px;height:110px;display:flex;flex-direction:column;align-items:center;justify-content:space-between}.traffic-light:before{content:"";width:2px;height:14px;background:#9a9792;border-style:dashed}.traffic-light:after{content:"";width:2px;height:14px;background:#9a9792;border-style:dashed}@keyframes typing{0%{width:0}to{width:100%}}@keyframes blink-caret{0%,to{border-color:transparent}50%{border-color:#4a4a4a}}@keyframes fadeIn{0%{opacity:0;transform:translateY(0)}to{opacity:1;transform:translateY(0)}}.font-handwriting{font-family:Ma Shan Zheng,ZCool QingKe HuangYou,cursive;font-weight:400}.game-layout{min-height:100vh;--left-col: 220px;--right-col: 220px;--center-max: 960px;display:grid;grid-template-areas:"topbar topbar topbar topbar topbar" "gutter-left left center right gutter-right";grid-template-rows:0 auto;grid-template-columns:1fr var(--left-col) minmax(0,var(--center-max)) var(--right-col) 1fr;gap:0}.app-canvas{position:fixed;inset:0;width:100%;height:100%;overflow:hidden}.app-scroll{position:relative;width:100%;height:100%;overflow:auto;overscroll-behavior:none;-ms-scroll-chaining:none;-webkit-overflow-scrolling:auto;scrollbar-width:none;-ms-overflow-style:none}.app-scroll::-webkit-scrollbar{display:none}.bg-pattern{background:linear-gradient(45deg,#f0f8ff 12%,transparent 0,transparent 88%,#f0f8ff 0),linear-gradient(135deg,transparent 37%,#e1f0ff 0,#e1f0ff 63%,transparent 0),linear-gradient(45deg,transparent 37%,#f0f8ff 0,#f0f8ff 63%,transparent 0);background-size:25px 25px;background-repeat:repeat;background-attachment:scroll;background-position:0 0}.bg-image{--global-bg-image: none;background-image:var(--global-bg-image);background-repeat:no-repeat;background-position:center center;background-size:cover;background-attachment:fixed;background-color:hsl(var(--background))}.topbar{grid-area:topbar;background-color:transparent;display:flex;justify-content:center;align-items:flex-start;position:fixed;top:0;left:0;right:0;z-index:40;will-change:transform;transition:transform .18s ease}.topbar.topbar--collapsed{transform:translateY(-100%)}.left-panel{grid-area:left;padding:1rem;will-change:transform;backface-visibility:hidden;contain:layout paint;isolation:isolate;transform:translateZ(0);--panel-vh-gap: 24px;height:calc(100vh - var(--panel-vh-gap));max-height:calc(100vh - var(--panel-vh-gap))}.center-area{grid-area:center;padding:3rem 1rem}.right-panel{grid-area:right;padding:1rem;will-change:transform;backface-visibility:hidden;contain:layout paint;isolation:isolate;transform:translateZ(0);--panel-vh-gap: 24px;height:calc(100vh - var(--panel-vh-gap));max-height:calc(100vh - var(--panel-vh-gap))}.smooth-follow{will-change:transform;backface-visibility:hidden;transform-style:preserve-3d}.character-frame{background-color:rgb(var(--surface-rgb) / var(--surface-opacity));border:2px solid #F8BBD9;border-radius:16px;background-image:var(--paper-texture);background-attachment:fixed}.main-text-box{border:3px solid #F8BBD9;border-radius:16px;background-color:rgb(var(--surface-rgb) / var(--surface-opacity));width:100%;position:relative;margin-left:auto;margin-right:auto}.main-text-box-content{position:absolute;border:1px solid #FCE8F0;border-radius:12px;background-color:rgb(var(--surface-rgb) / var(--surface-opacity));position:relative;inset:auto;display:block;width:auto;margin:8px;padding:40px 48px}.washi-tape{position:absolute;width:110px;height:26px;z-index:5}.washi-tape:before{content:"";position:absolute;inset:0;border-radius:4px;opacity:.88;background-image:repeating-linear-gradient(45deg,#5bcefa66 0 5px,#f7a8b866 5px 10px,#ffffff80 10px 15px),linear-gradient(#fff9f9,#fff9f9)!important;box-shadow:1px 2px 5px #0000001f}.washi-tape--lt{top:-12px;left:18px;transform:rotate(-12deg)}.washi-tape--rt{top:-8px;right:24px;transform:rotate(10deg);width:70px;height:20px}.washi-tape--center{top:-10px;left:50%;transform:translate(-50%) rotate(-6deg);width:90px;height:22px}.corner-sticker{position:absolute;width:26px;height:26px;border-radius:9999px;border:2px dashed #F8BBD9;background-color:rgb(var(--surface-rgb) / var(--surface-opacity));z-index:6}.corner-sticker:after{content:"";position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:12px;color:#f49ac2}.corner-sticker--rb{right:10px;bottom:10px;transform:rotate(-8deg)}.doodle-floating{position:absolute;font-size:18px;opacity:.35;z-index:4;pointer-events:none}.doodle-floating--lt{top:12px;left:12px;transform:rotate(-10deg)}.doodle-floating--lb{bottom:14px;left:16px;transform:rotate(8deg)}.doodle-floating--rt{top:14px;right:14px;transform:rotate(6deg)}.doodle-floating--rb{bottom:12px;right:16px;transform:rotate(-12deg)}.sticker-card{position:relative;background-color:rgb(var(--surface-rgb) / var(--surface-opacity))}.sticker-card:after{content:"";position:absolute;z-index:-1;inset:6px -6px -6px 6px;height:auto;border-radius:16px;background:#d7d4d059;transform:rotate(.5deg)}.gauge-flip-outer{perspective:800px;display:inline-block}.gauge-flip-inner{position:relative;width:var(--gauge-flip-size, 88px);height:var(--gauge-flip-size, 88px);transform-style:preserve-3d;transition:transform .5s cubic-bezier(.4,0,.2,1);will-change:transform}.gauge-flip:hover .gauge-flip-inner,.gauge-flip:focus-within .gauge-flip-inner{transform:rotateY(180deg)}.gauge-flip--flipped .gauge-flip-inner{transform:rotateY(180deg)}.gauge-flip--mobile.gauge-flip:hover .gauge-flip-inner,.gauge-flip--mobile.gauge-flip:focus-within .gauge-flip-inner{transform:rotateY(0)}.gauge-flip--mobile.gauge-flip--flipped .gauge-flip-inner{transform:rotateY(180deg)}.gauge-face{position:absolute;inset:0;backface-visibility:hidden}.gauge-face--back{transform:rotateY(180deg)}.slot-cell:hover .item-bounce{transform:translateY(-2px) rotate(4deg) scale(1.08)}.item-bounce{transition:transform .22s cubic-bezier(.22,1,.36,1);will-change:transform;display:inline-block}.pointer-events-none{pointer-events:none}.pointer-events-auto{pointer-events:auto}.visible{visibility:visible}.static{position:static}.absolute{position:absolute}.relative{position:relative}.inset-0{inset:0}.inset-1{inset:.25rem}.inset-2{inset:.5rem}.inset-y-0{top:0;bottom:0}.-left-1{left:-.25rem}.-left-10{left:-2.5rem}.-right-1{right:-.25rem}.-right-10{right:-2.5rem}.-top-0\.5{top:-.125rem}.-top-1{top:-.25rem}.-top-10{top:-2.5rem}.bottom-0{bottom:0}.bottom-2{bottom:.5rem}.bottom-3{bottom:.75rem}.bottom-full{bottom:100%}.left-0{left:0}.left-1\/2{left:50%}.left-2{left:.5rem}.left-3{left:.75rem}.left-6{left:1.5rem}.right-0{right:0}.right-2{right:.5rem}.right-3{right:.75rem}.right-6{right:1.5rem}.top-0{top:0}.top-1\/2{top:50%}.top-2{top:.5rem}.top-3{top:.75rem}.top-full{top:100%}.z-10{z-index:10}.z-20{z-index:20}.z-30{z-index:30}.z-40{z-index:40}.z-\[190\]{z-index:190}.z-\[200\]{z-index:200}.z-\[300\]{z-index:300}.z-\[310\]{z-index:310}.col-span-1{grid-column:span 1 / span 1}.col-span-2{grid-column:span 2 / span 2}.m-0{margin:0}.mx-0\.5{margin-left:.125rem;margin-right:.125rem}.mx-auto{margin-left:auto;margin-right:auto}.mb-1{margin-bottom:.25rem}.mb-2{margin-bottom:.5rem}.mb-3{margin-bottom:.75rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.ml-1{margin-left:.25rem}.ml-4{margin-left:1rem}.ml-auto{margin-left:auto}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mt-4{margin-top:1rem}.mt-6{margin-top:1.5rem}.box-content{box-sizing:content-box}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.inline-flex{display:inline-flex}.grid{display:grid}.hidden{display:none}.\!h-\[500px\]{height:500px!important}.\!h-auto{height:auto!important}.h-0\.5{height:.125rem}.h-1{height:.25rem}.h-1\.5{height:.375rem}.h-10{height:2.5rem}.h-12{height:3rem}.h-16{height:4rem}.h-2{height:.5rem}.h-20{height:5rem}.h-28{height:7rem}.h-3{height:.75rem}.h-3\.5{height:.875rem}.h-32{height:8rem}.h-4{height:1rem}.h-40{height:10rem}.h-5{height:1.25rem}.h-6{height:1.5rem}.h-7{height:1.75rem}.h-8{height:2rem}.h-\[420px\]{height:420px}.h-\[5\.5rem\]{height:5.5rem}.h-\[88px\]{height:88px}.h-full{height:100%}.max-h-\[80vh\]{max-height:80vh}.min-h-16{min-height:4rem}.min-h-\[320px\]{min-height:320px}.min-h-\[520px\]{min-height:520px}.\!w-\[80\%\]{width:80%!important}.\!w-full{width:100%!important}.w-0\.5{width:.125rem}.w-1{width:.25rem}.w-1\.5{width:.375rem}.w-11{width:2.75rem}.w-12{width:3rem}.w-2{width:.5rem}.w-20{width:5rem}.w-3{width:.75rem}.w-4{width:1rem}.w-4\/5{width:80%}.w-40{width:10rem}.w-48{width:12rem}.w-5{width:1.25rem}.w-6{width:1.5rem}.w-7{width:1.75rem}.w-8{width:2rem}.w-9{width:2.25rem}.w-\[180px\]{width:180px}.w-\[28px\]{width:28px}.w-\[88px\]{width:88px}.w-\[calc\(100\%-16px\)\]{width:calc(100% - 16px)}.w-auto{width:auto}.w-full{width:100%}.min-w-0{min-width:0px}.min-w-\[350px\]{min-width:350px}.min-w-\[4\.5rem\]{min-width:4.5rem}.min-w-max{min-width:-moz-max-content;min-width:max-content}.\!max-w-none{max-width:none!important}.max-w-4xl{max-width:56rem}.max-w-\[18rem\]{max-width:18rem}.max-w-\[260px\]{max-width:260px}.max-w-\[340px\]{max-width:340px}.max-w-\[360px\]{max-width:360px}.max-w-\[400px\]{max-width:400px}.max-w-\[540px\]{max-width:540px}.max-w-full{max-width:100%}.\!flex-none{flex:none!important}.flex-1{flex:1 1 0%}.flex-shrink-0,.shrink-0{flex-shrink:0}.origin-top-left{transform-origin:top left}.-translate-x-1\/2{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-x-full{--tw-translate-x: -100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\/2{--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-0{--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-full{--tw-translate-x: 100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-y-0{--tw-translate-y: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-y-1{--tw-translate-y: .25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-0{--tw-rotate: 0deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-180{--tw-rotate: 180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes fade-in{0%{opacity:0}to{opacity:1}}.animate-fade-in{animation:fade-in .25s ease-in-out}@keyframes pulse{50%{opacity:.5}}.animate-pulse{animation:pulse 2s cubic-bezier(.4,0,.6,1) infinite}@keyframes scale-in{0%{transform:scale(.95);opacity:0}to{transform:scale(1);opacity:1}}.animate-scale-in{animation:scale-in .3s cubic-bezier(.4,0,.2,1)}.cursor-not-allowed{cursor:not-allowed}.cursor-pointer{cursor:pointer}.select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.resize{resize:both}.appearance-none{-webkit-appearance:none;-moz-appearance:none;appearance:none}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.\!flex-col{flex-direction:column!important}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.flex-nowrap{flex-wrap:nowrap}.items-start{align-items:flex-start}.\!items-center{align-items:center!important}.items-center{align-items:center}.items-stretch{align-items:stretch}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.justify-items-center{justify-items:center}.\!gap-6{gap:1.5rem!important}.gap-1{gap:.25rem}.gap-1\.5{gap:.375rem}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.gap-5{gap:1.25rem}.gap-6{gap:1.5rem}.gap-8{gap:2rem}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.25rem * var(--tw-space-y-reverse))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}.space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.75rem * var(--tw-space-y-reverse))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.overflow-hidden{overflow:hidden}.overflow-visible{overflow:visible}.overflow-y-auto{overflow-y:auto}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.whitespace-normal{white-space:normal}.whitespace-nowrap{white-space:nowrap}.whitespace-pre-line{white-space:pre-line}.whitespace-pre-wrap{white-space:pre-wrap}.break-words{overflow-wrap:break-word}.rounded{border-radius:.25rem}.rounded-2xl{border-radius:1rem}.rounded-\[28px\]{border-radius:28px}.rounded-\[32px\]{border-radius:32px}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:16px}.rounded-md{border-radius:12px}.rounded-none{border-radius:0}.rounded-sm{border-radius:6px}.rounded-xl{border-radius:20px}.rounded-b-md{border-bottom-right-radius:12px;border-bottom-left-radius:12px}.rounded-l-none{border-top-left-radius:0;border-bottom-left-radius:0}.rounded-r-none{border-top-right-radius:0;border-bottom-right-radius:0}.rounded-t-none{border-top-left-radius:0;border-top-right-radius:0}.rounded-bl-md{border-bottom-left-radius:12px}.rounded-br-md{border-bottom-right-radius:12px}.rounded-tl-md{border-top-left-radius:12px}.rounded-tr-md{border-top-right-radius:12px}.border{border-width:1px}.border-0{border-width:0px}.border-2{border-width:2px}.border-b-2{border-bottom-width:2px}.border-b-4{border-bottom-width:4px}.border-l{border-left-width:1px}.border-l-0{border-left-width:0px}.border-l-2{border-left-width:2px}.border-l-4{border-left-width:4px}.border-r-0{border-right-width:0px}.border-r-2{border-right-width:2px}.border-r-4{border-right-width:4px}.border-t-2{border-top-width:2px}.border-t-4{border-top-width:4px}.border-dashed{border-style:dashed}.border-none{border-style:none}.border-charcoal-200{--tw-border-opacity: 1;border-color:rgb(212 210 206 / var(--tw-border-opacity, 1))}.border-charcoal-400{--tw-border-opacity: 1;border-color:rgb(154 151 146 / var(--tw-border-opacity, 1))}.border-charcoal-600{--tw-border-opacity: 1;border-color:rgb(107 104 98 / var(--tw-border-opacity, 1))}.border-lavender-300{--tw-border-opacity: 1;border-color:rgb(212 197 249 / var(--tw-border-opacity, 1))}.border-lavender-500{--tw-border-opacity: 1;border-color:rgb(187 168 240 / var(--tw-border-opacity, 1))}.border-matcha-300{--tw-border-opacity: 1;border-color:rgb(168 213 186 / var(--tw-border-opacity, 1))}.border-matcha-500{--tw-border-opacity: 1;border-color:rgb(136 196 164 / var(--tw-border-opacity, 1))}.border-mist-300{--tw-border-opacity: 1;border-color:rgb(180 198 231 / var(--tw-border-opacity, 1))}.border-mist-500{--tw-border-opacity: 1;border-color:rgb(147 174 217 / var(--tw-border-opacity, 1))}.border-orange-300{--tw-border-opacity: 1;border-color:rgb(253 186 116 / var(--tw-border-opacity, 1))}.border-pink-200{--tw-border-opacity: 1;border-color:rgb(251 207 232 / var(--tw-border-opacity, 1))}.border-pink-400{--tw-border-opacity: 1;border-color:rgb(244 114 182 / var(--tw-border-opacity, 1))}.border-red-300{--tw-border-opacity: 1;border-color:rgb(252 165 165 / var(--tw-border-opacity, 1))}.border-red-500{--tw-border-opacity: 1;border-color:rgb(239 68 68 / var(--tw-border-opacity, 1))}.border-rose-200{--tw-border-opacity: 1;border-color:rgb(254 205 211 / var(--tw-border-opacity, 1))}.border-sakura-100{--tw-border-opacity: 1;border-color:rgb(252 232 240 / var(--tw-border-opacity, 1))}.border-sakura-300{--tw-border-opacity: 1;border-color:rgb(248 187 217 / var(--tw-border-opacity, 1))}.border-sakura-500{--tw-border-opacity: 1;border-color:rgb(244 154 194 / var(--tw-border-opacity, 1))}.border-sky-200{--tw-border-opacity: 1;border-color:rgb(186 230 253 / var(--tw-border-opacity, 1))}.border-transparent{border-color:transparent}.border-white{--tw-border-opacity: 1;border-color:rgb(255 255 255 / var(--tw-border-opacity, 1))}.border-white\/40{border-color:#fff6}.border-white\/80{border-color:#fffc}.border-b-slate-800{--tw-border-opacity: 1;border-bottom-color:rgb(30 41 59 / var(--tw-border-opacity, 1))}.border-t-slate-800{--tw-border-opacity: 1;border-top-color:rgb(30 41 59 / var(--tw-border-opacity, 1))}.bg-amber-50\/60{background-color:#fffbeb99}.bg-black\/35{background-color:#00000059}.bg-black\/45{background-color:#00000073}.bg-blue-50{--tw-bg-opacity: 1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.bg-charcoal-200{--tw-bg-opacity: 1;background-color:rgb(212 210 206 / var(--tw-bg-opacity, 1))}.bg-charcoal-400{--tw-bg-opacity: 1;background-color:rgb(154 151 146 / var(--tw-bg-opacity, 1))}.bg-charcoal-600{--tw-bg-opacity: 1;background-color:rgb(107 104 98 / var(--tw-bg-opacity, 1))}.bg-charcoal-800{--tw-bg-opacity: 1;background-color:rgb(74 74 74 / var(--tw-bg-opacity, 1))}.bg-charcoal-900{--tw-bg-opacity: 1;background-color:rgb(45 45 45 / var(--tw-bg-opacity, 1))}.bg-green-50{--tw-bg-opacity: 1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.bg-lavender-100{--tw-bg-opacity: 1;background-color:rgb(240 235 250 / var(--tw-bg-opacity, 1))}.bg-lavender-300{--tw-bg-opacity: 1;background-color:rgb(212 197 249 / var(--tw-bg-opacity, 1))}.bg-lavender-50{--tw-bg-opacity: 1;background-color:rgb(249 247 253 / var(--tw-bg-opacity, 1))}.bg-matcha-100{--tw-bg-opacity: 1;background-color:rgb(230 244 237 / var(--tw-bg-opacity, 1))}.bg-matcha-300{--tw-bg-opacity: 1;background-color:rgb(168 213 186 / var(--tw-bg-opacity, 1))}.bg-matcha-50{--tw-bg-opacity: 1;background-color:rgb(245 250 247 / var(--tw-bg-opacity, 1))}.bg-matcha-500{--tw-bg-opacity: 1;background-color:rgb(136 196 164 / var(--tw-bg-opacity, 1))}.bg-mist-100{--tw-bg-opacity: 1;background-color:rgb(232 238 247 / var(--tw-bg-opacity, 1))}.bg-mist-300{--tw-bg-opacity: 1;background-color:rgb(180 198 231 / var(--tw-bg-opacity, 1))}.bg-mist-50{--tw-bg-opacity: 1;background-color:rgb(246 248 252 / var(--tw-bg-opacity, 1))}.bg-mist-500{--tw-bg-opacity: 1;background-color:rgb(147 174 217 / var(--tw-bg-opacity, 1))}.bg-orange-50{--tw-bg-opacity: 1;background-color:rgb(255 247 237 / var(--tw-bg-opacity, 1))}.bg-paper-cream{--tw-bg-opacity: 1;background-color:rgb(255 252 248 / var(--tw-bg-opacity, 1))}.bg-paper-cream\/60{background-color:#fffcf899}.bg-paper-white{--tw-bg-opacity: 1;background-color:rgb(254 254 254 / var(--tw-bg-opacity, 1))}.bg-paper-white\/90{background-color:#fefefee6}.bg-pink-100{--tw-bg-opacity: 1;background-color:rgb(252 231 243 / var(--tw-bg-opacity, 1))}.bg-pink-200\/40{background-color:#fbcfe866}.bg-pink-50{--tw-bg-opacity: 1;background-color:rgb(253 242 248 / var(--tw-bg-opacity, 1))}.bg-pink-50\/60{background-color:#fdf2f899}.bg-pink-500{--tw-bg-opacity: 1;background-color:rgb(236 72 153 / var(--tw-bg-opacity, 1))}.bg-purple-50{--tw-bg-opacity: 1;background-color:rgb(250 245 255 / var(--tw-bg-opacity, 1))}.bg-red-50{--tw-bg-opacity: 1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.bg-red-50\/70{background-color:#fef2f2b3}.bg-rose-100\/80{background-color:#ffe4e6cc}.bg-rose-50\/90{background-color:#fff1f2e6}.bg-sakura-100{--tw-bg-opacity: 1;background-color:rgb(252 232 240 / var(--tw-bg-opacity, 1))}.bg-sakura-300{--tw-bg-opacity: 1;background-color:rgb(248 187 217 / var(--tw-bg-opacity, 1))}.bg-sakura-50{--tw-bg-opacity: 1;background-color:rgb(254 246 249 / var(--tw-bg-opacity, 1))}.bg-sakura-500{--tw-bg-opacity: 1;background-color:rgb(244 154 194 / var(--tw-bg-opacity, 1))}.bg-semantic-error{--tw-bg-opacity: 1;background-color:rgb(255 180 196 / var(--tw-bg-opacity, 1))}.bg-semantic-info{--tw-bg-opacity: 1;background-color:rgb(180 212 231 / var(--tw-bg-opacity, 1))}.bg-semantic-success{--tw-bg-opacity: 1;background-color:rgb(159 214 184 / var(--tw-bg-opacity, 1))}.bg-semantic-warning{--tw-bg-opacity: 1;background-color:rgb(255 209 154 / var(--tw-bg-opacity, 1))}.bg-sky-100\/80{background-color:#e0f2fecc}.bg-sky-200\/40{background-color:#bae6fd66}.bg-sky-50\/90{background-color:#f0f9ffe6}.bg-slate-100{--tw-bg-opacity: 1;background-color:rgb(241 245 249 / var(--tw-bg-opacity, 1))}.bg-slate-800{--tw-bg-opacity: 1;background-color:rgb(30 41 59 / var(--tw-bg-opacity, 1))}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-white\/70{background-color:#ffffffb3}.bg-white\/80{background-color:#fffc}.bg-white\/85{background-color:#ffffffd9}.bg-white\/90{background-color:#ffffffe6}.bg-yellow-400{--tw-bg-opacity: 1;background-color:rgb(250 204 21 / var(--tw-bg-opacity, 1))}.bg-yellow-50{--tw-bg-opacity: 1;background-color:rgb(254 252 232 / var(--tw-bg-opacity, 1))}.bg-gradient-to-b{background-image:linear-gradient(to bottom,var(--tw-gradient-stops))}.bg-gradient-to-br{background-image:linear-gradient(to bottom right,var(--tw-gradient-stops))}.bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.from-blue-400{--tw-gradient-from: #60a5fa var(--tw-gradient-from-position);--tw-gradient-to: rgb(96 165 250 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-pink-400{--tw-gradient-from: #f472b6 var(--tw-gradient-from-position);--tw-gradient-to: rgb(244 114 182 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-pink-50{--tw-gradient-from: #fdf2f8 var(--tw-gradient-from-position);--tw-gradient-to: rgb(253 242 248 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-400{--tw-gradient-from: #c084fc var(--tw-gradient-from-position);--tw-gradient-to: rgb(192 132 252 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-red-400{--tw-gradient-from: #f87171 var(--tw-gradient-from-position);--tw-gradient-to: rgb(248 113 113 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-sakura-400{--tw-gradient-from: #F6A7CF var(--tw-gradient-from-position);--tw-gradient-to: rgb(246 167 207 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.to-blue-500{--tw-gradient-to: #3b82f6 var(--tw-gradient-to-position)}.to-matcha-500{--tw-gradient-to: #88C4A4 var(--tw-gradient-to-position)}.to-orange-50{--tw-gradient-to: #fff7ed var(--tw-gradient-to-position)}.to-pink-500{--tw-gradient-to: #ec4899 var(--tw-gradient-to-position)}.to-purple-500{--tw-gradient-to: #a855f7 var(--tw-gradient-to-position)}.to-red-500{--tw-gradient-to: #ef4444 var(--tw-gradient-to-position)}.object-contain{-o-object-fit:contain;object-fit:contain}.p-0{padding:0}.p-2{padding:.5rem}.p-3{padding:.75rem}.p-4{padding:1rem}.\!px-4{padding-left:1rem!important;padding-right:1rem!important}.px-0{padding-left:0;padding-right:0}.px-1{padding-left:.25rem;padding-right:.25rem}.px-1\.5{padding-left:.375rem;padding-right:.375rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-2\.5{padding-left:.625rem;padding-right:.625rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-0\.5{padding-top:.125rem;padding-bottom:.125rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.py-5{padding-top:1.25rem;padding-bottom:1.25rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.py-\[2px\]{padding-top:2px;padding-bottom:2px}.pb-1{padding-bottom:.25rem}.pb-3{padding-bottom:.75rem}.pb-5{padding-bottom:1.25rem}.pb-8{padding-bottom:2rem}.pt-1{padding-top:.25rem}.pt-2{padding-top:.5rem}.pt-8{padding-top:2rem}.text-left{text-align:left}.text-center{text-align:center}.align-middle{vertical-align:middle}.font-cpTitle{font-family:NaikaiFont-SemiBold,sans-serif}.font-fzyousong{font-family:FZYouSongJ,serif}.font-mono{font-family:Source Code Pro,Consolas,monospace}.font-naikai{font-family:NaikaiFont-SemiBold,sans-serif}.font-primary{font-family:NaikaiFont-SemiBold,Source Han Sans CN,Noto Sans CJK SC,PingFang SC,sans-serif}.font-sans{font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji"}.text-2xl{font-size:1.5rem}.text-\[10px\]{font-size:10px}.text-\[11px\]{font-size:11px}.text-\[12px\]{font-size:12px}.text-\[13px\]{font-size:13px}.text-\[7px\]{font-size:7px}.text-base{font-size:1rem}.text-lg{font-size:1.125rem}.text-sm{font-size:.875rem}.text-xl{font-size:1.25rem}.text-xs{font-size:.75rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.italic{font-style:italic}.tabular-nums{--tw-numeric-spacing: tabular-nums;font-variant-numeric:var(--tw-ordinal) var(--tw-slashed-zero) var(--tw-numeric-figure) var(--tw-numeric-spacing) var(--tw-numeric-fraction)}.leading-none{line-height:1}.leading-relaxed{line-height:1.8}.leading-snug{line-height:1.4}.leading-tight{line-height:1.2}.tracking-\[0\.08em\]{letter-spacing:.08em}.tracking-wide{letter-spacing:.025em}.text-amber-600{--tw-text-opacity: 1;color:rgb(217 119 6 / var(--tw-text-opacity, 1))}.text-blue-500{--tw-text-opacity: 1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.text-charcoal-200{--tw-text-opacity: 1;color:rgb(212 210 206 / var(--tw-text-opacity, 1))}.text-charcoal-400{--tw-text-opacity: 1;color:rgb(154 151 146 / var(--tw-text-opacity, 1))}.text-charcoal-600{--tw-text-opacity: 1;color:rgb(107 104 98 / var(--tw-text-opacity, 1))}.text-charcoal-800{--tw-text-opacity: 1;color:rgb(74 74 74 / var(--tw-text-opacity, 1))}.text-charcoal-900{--tw-text-opacity: 1;color:rgb(45 45 45 / var(--tw-text-opacity, 1))}.text-foreground{color:hsl(var(--foreground))}.text-gray-400{--tw-text-opacity: 1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-green-500{--tw-text-opacity: 1;color:rgb(34 197 94 / var(--tw-text-opacity, 1))}.text-lavender-300{--tw-text-opacity: 1;color:rgb(212 197 249 / var(--tw-text-opacity, 1))}.text-lavender-500{--tw-text-opacity: 1;color:rgb(187 168 240 / var(--tw-text-opacity, 1))}.text-lavender-700{--tw-text-opacity: 1;color:rgb(158 135 217 / var(--tw-text-opacity, 1))}.text-lavender-700\/80{color:#9e87d9cc}.text-matcha-300{--tw-text-opacity: 1;color:rgb(168 213 186 / var(--tw-text-opacity, 1))}.text-matcha-50{--tw-text-opacity: 1;color:rgb(245 250 247 / var(--tw-text-opacity, 1))}.text-matcha-500{--tw-text-opacity: 1;color:rgb(136 196 164 / var(--tw-text-opacity, 1))}.text-matcha-700{--tw-text-opacity: 1;color:rgb(107 168 136 / var(--tw-text-opacity, 1))}.text-matcha-700\/80{color:#6ba888cc}.text-mist-300{--tw-text-opacity: 1;color:rgb(180 198 231 / var(--tw-text-opacity, 1))}.text-mist-500{--tw-text-opacity: 1;color:rgb(147 174 217 / var(--tw-text-opacity, 1))}.text-mist-700{--tw-text-opacity: 1;color:rgb(114 149 196 / var(--tw-text-opacity, 1))}.text-mist-700\/80{color:#7295c4cc}.text-orange-500{--tw-text-opacity: 1;color:rgb(249 115 22 / var(--tw-text-opacity, 1))}.text-pink-500{--tw-text-opacity: 1;color:rgb(236 72 153 / var(--tw-text-opacity, 1))}.text-pink-600{--tw-text-opacity: 1;color:rgb(219 39 119 / var(--tw-text-opacity, 1))}.text-pink-700{--tw-text-opacity: 1;color:rgb(190 24 93 / var(--tw-text-opacity, 1))}.text-purple-500{--tw-text-opacity: 1;color:rgb(168 85 247 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-rose-300{--tw-text-opacity: 1;color:rgb(253 164 175 / var(--tw-text-opacity, 1))}.text-rose-600{--tw-text-opacity: 1;color:rgb(225 29 72 / var(--tw-text-opacity, 1))}.text-rose-700{--tw-text-opacity: 1;color:rgb(190 18 60 / var(--tw-text-opacity, 1))}.text-sakura-300{--tw-text-opacity: 1;color:rgb(248 187 217 / var(--tw-text-opacity, 1))}.text-sakura-500{--tw-text-opacity: 1;color:rgb(244 154 194 / var(--tw-text-opacity, 1))}.text-sakura-700{--tw-text-opacity: 1;color:rgb(232 115 157 / var(--tw-text-opacity, 1))}.text-sakura-700\/80{color:#e8739dcc}.text-sky-300{--tw-text-opacity: 1;color:rgb(125 211 252 / var(--tw-text-opacity, 1))}.text-sky-600{--tw-text-opacity: 1;color:rgb(2 132 199 / var(--tw-text-opacity, 1))}.text-sky-700{--tw-text-opacity: 1;color:rgb(3 105 161 / var(--tw-text-opacity, 1))}.text-slate-300{--tw-text-opacity: 1;color:rgb(203 213 225 / var(--tw-text-opacity, 1))}.text-slate-400{--tw-text-opacity: 1;color:rgb(148 163 184 / var(--tw-text-opacity, 1))}.text-slate-500{--tw-text-opacity: 1;color:rgb(100 116 139 / var(--tw-text-opacity, 1))}.text-slate-600{--tw-text-opacity: 1;color:rgb(71 85 105 / var(--tw-text-opacity, 1))}.text-slate-700{--tw-text-opacity: 1;color:rgb(51 65 85 / var(--tw-text-opacity, 1))}.text-slate-700\/90{color:#334155e6}.text-slate-800{--tw-text-opacity: 1;color:rgb(30 41 59 / var(--tw-text-opacity, 1))}.text-transparent{color:transparent}.text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-yellow-500{--tw-text-opacity: 1;color:rgb(234 179 8 / var(--tw-text-opacity, 1))}.underline{text-decoration-line:underline}.decoration-dashed{text-decoration-style:dashed}.underline-offset-4{text-underline-offset:4px}.accent-matcha-500{accent-color:#88C4A4}.opacity-0{opacity:0}.opacity-100{opacity:1}.opacity-30{opacity:.3}.opacity-50{opacity:.5}.opacity-60{opacity:.6}.opacity-80{opacity:.8}.shadow-lg{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-none{--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-sm{--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.outline-none{outline:2px solid transparent;outline-offset:2px}.ring-1{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-2{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-orange-200\/50{--tw-ring-color: rgb(254 215 170 / .5)}.ring-pink-400{--tw-ring-opacity: 1;--tw-ring-color: rgb(244 114 182 / var(--tw-ring-opacity, 1))}.ring-rose-100{--tw-ring-opacity: 1;--tw-ring-color: rgb(255 228 230 / var(--tw-ring-opacity, 1))}.ring-offset-2{--tw-ring-offset-width: 2px}.ring-offset-transparent{--tw-ring-offset-color: transparent}.blur{--tw-blur: blur(8px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.blur-2xl{--tw-blur: blur(40px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow{--tw-drop-shadow: drop-shadow(0 1px 2px rgb(0 0 0 / .1)) drop-shadow(0 1px 1px rgb(0 0 0 / .06));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur-sm{--tw-backdrop-blur: blur(4px);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.duration-150{transition-duration:.15s}.duration-200{transition-duration:.2s}.duration-300{transition-duration:.3s}.duration-500{transition-duration:.5s}.duration-700{transition-duration:.7s}.ease-out{transition-timing-function:cubic-bezier(0,0,.2,1)}@keyframes enter{0%{opacity:var(--tw-enter-opacity, 1);transform:translate3d(var(--tw-enter-translate-x, 0),var(--tw-enter-translate-y, 0),0) scale3d(var(--tw-enter-scale, 1),var(--tw-enter-scale, 1),var(--tw-enter-scale, 1)) rotate(var(--tw-enter-rotate, 0))}}@keyframes exit{to{opacity:var(--tw-exit-opacity, 1);transform:translate3d(var(--tw-exit-translate-x, 0),var(--tw-exit-translate-y, 0),0) scale3d(var(--tw-exit-scale, 1),var(--tw-exit-scale, 1),var(--tw-exit-scale, 1)) rotate(var(--tw-exit-rotate, 0))}}.duration-150{animation-duration:.15s}.duration-200{animation-duration:.2s}.duration-300{animation-duration:.3s}.duration-500{animation-duration:.5s}.duration-700{animation-duration:.7s}.ease-out{animation-timing-function:cubic-bezier(0,0,.2,1)}.bg-surface{background-color:rgb(var(--surface-rgb) / var(--surface-opacity))}@media print{*{background:#fff!important;color:#000!important;box-shadow:none!important;text-shadow:none!important}}@media(prefers-reduced-motion:reduce){*{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important;scroll-behavior:auto!important}}@media(max-width:1439px){.game-layout{--left-col: 180px;--right-col: 180px}.center-area{padding:2rem 1rem}.main-text-box-content{padding:2rem}}@media(max-width:1023px){.game-layout{grid-template-areas:"topbar" "center";grid-template-columns:1fr;grid-template-rows:60px 1fr}.left-panel,.right-panel{display:none}.center-area{padding:1rem}.main-text-box{width:calc(100vw - 32px)}}@media(max-width:767px){.center-area{padding:.5rem}.main-text-box-content{padding:1rem}.draggable-frame{height:20rem;width:18rem}.main-text-box{width:calc(100vw - 16px)}}img{-o-object-position:top;object-position:top}.fixed{position:fixed}.hover\:-translate-y-0\.5:hover{--tw-translate-y: -.125rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:translate-y-0:hover{--tw-translate-y: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:translate-y-\[-2px\]:hover{--tw-translate-y: -2px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:scale-105:hover{--tw-scale-x: 1.05;--tw-scale-y: 1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:scale-110:hover{--tw-scale-x: 1.1;--tw-scale-y: 1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:transform:hover{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:border-white:hover{--tw-border-opacity: 1;border-color:rgb(255 255 255 / var(--tw-border-opacity, 1))}.hover\:bg-lavender-100:hover{--tw-bg-opacity: 1;background-color:rgb(240 235 250 / var(--tw-bg-opacity, 1))}.hover\:bg-lavender-300:hover{--tw-bg-opacity: 1;background-color:rgb(212 197 249 / var(--tw-bg-opacity, 1))}.hover\:bg-matcha-100:hover{--tw-bg-opacity: 1;background-color:rgb(230 244 237 / var(--tw-bg-opacity, 1))}.hover\:bg-matcha-300:hover{--tw-bg-opacity: 1;background-color:rgb(168 213 186 / var(--tw-bg-opacity, 1))}.hover\:bg-matcha-50:hover{--tw-bg-opacity: 1;background-color:rgb(245 250 247 / var(--tw-bg-opacity, 1))}.hover\:bg-mist-100:hover{--tw-bg-opacity: 1;background-color:rgb(232 238 247 / var(--tw-bg-opacity, 1))}.hover\:bg-mist-300:hover{--tw-bg-opacity: 1;background-color:rgb(180 198 231 / var(--tw-bg-opacity, 1))}.hover\:bg-mist-50:hover{--tw-bg-opacity: 1;background-color:rgb(246 248 252 / var(--tw-bg-opacity, 1))}.hover\:bg-pink-50:hover{--tw-bg-opacity: 1;background-color:rgb(253 242 248 / var(--tw-bg-opacity, 1))}.hover\:bg-pink-600:hover{--tw-bg-opacity: 1;background-color:rgb(219 39 119 / var(--tw-bg-opacity, 1))}.hover\:bg-rose-100\/90:hover{background-color:#ffe4e6e6}.hover\:bg-sakura-100:hover{--tw-bg-opacity: 1;background-color:rgb(252 232 240 / var(--tw-bg-opacity, 1))}.hover\:bg-sakura-300:hover{--tw-bg-opacity: 1;background-color:rgb(248 187 217 / var(--tw-bg-opacity, 1))}.hover\:bg-sakura-50:hover{--tw-bg-opacity: 1;background-color:rgb(254 246 249 / var(--tw-bg-opacity, 1))}.hover\:bg-sky-100\/90:hover{background-color:#e0f2fee6}.hover\:bg-slate-200:hover{--tw-bg-opacity: 1;background-color:rgb(226 232 240 / var(--tw-bg-opacity, 1))}.hover\:bg-white:hover{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.hover\:text-black:hover{--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity, 1))}.hover\:text-red-600:hover{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.hover\:text-white:hover{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:ring-2:focus{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus\:ring-matcha-300:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(168 213 186 / var(--tw-ring-opacity, 1))}.focus\:ring-offset-2:focus{--tw-ring-offset-width: 2px}.focus-visible\:outline:focus-visible{outline-style:solid}.focus-visible\:outline-2:focus-visible{outline-width:2px}.focus-visible\:outline-offset-2:focus-visible{outline-offset:2px}.active\:translate-y-\[1px\]:active{--tw-translate-y: 1px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.active\:scale-95:active{--tw-scale-x: .95;--tw-scale-y: .95;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.active\:border-white:active{--tw-border-opacity: 1;border-color:rgb(255 255 255 / var(--tw-border-opacity, 1))}.active\:bg-lavender-300:active{--tw-bg-opacity: 1;background-color:rgb(212 197 249 / var(--tw-bg-opacity, 1))}.active\:bg-matcha-300:active{--tw-bg-opacity: 1;background-color:rgb(168 213 186 / var(--tw-bg-opacity, 1))}.active\:bg-mist-300:active{--tw-bg-opacity: 1;background-color:rgb(180 198 231 / var(--tw-bg-opacity, 1))}.active\:bg-sakura-300:active{--tw-bg-opacity: 1;background-color:rgb(248 187 217 / var(--tw-bg-opacity, 1))}.active\:text-white:active{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.disabled\:opacity-50:disabled{opacity:.5}.disabled\:opacity-60:disabled{opacity:.6}.dark\:bg-charcoal-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(45 45 45 / var(--tw-bg-opacity, 1))}@media(min-width:640px){.sm\:col-span-1{grid-column:span 1 / span 1}.sm\:min-w-\[5\.5rem\]{min-width:5.5rem}.sm\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.sm\:gap-3{gap:.75rem}.sm\:gap-6{gap:1.5rem}.sm\:px-3{padding-left:.75rem;padding-right:.75rem}}</style>
</head>

<body>
  <div id="root"></div>
</body>

</html>
